(()=>{"use strict";class t{createToDoForm=t=>{const e=this.createForm(),r=this.createLabels(["*Title:","*Description:","*Due Date:","*Priority:"]),o=this.createToDoInputs(["todo-title","todo-description"]);let s=this.joinLists(this.appendInputsToLabels(r,o),this.appendButtons(t,"to-do"));return this.appendElementsToForm(e,s)};createForm(){let t=document.createElement("form");return this.assignAttribute(t,"method","post"),t}assignAttribute(t,e,r=""){t.setAttribute(e,r)}createLabels(t){let e=[];for(const r of t)e.push(this.createLabel(r));return e}createLabel(t){const e=document.createElement("label");return e.textContent=t,e}createToDoInputs(t){const e=this.createTextInputs(t),r=this.createDistinctInputs();return this.joinLists(e,r)}createTextInputs(t){let e=[];for(const r of t)e.push(this.createInput(r));return e}createInput(t,e=""){const r=document.createElement("input");let o=["name","required"],s=[t,""];return e&&(o.push("type"),s.push(e)),this.assignAttributes(r,o,s),r}assignAttributes(t,e,r){for(let o=0;o<e.length;o++)this.assignAttribute(t,e[o],r[o])}createDistinctInputs(){return[this.createDatetimeLocalInput("todo-dueDate"),this.createNumberInput("todo-priority")]}createDatetimeLocalInput(t){const e=this.createInput(t,"datetime-local");return this.assignAttribute(e,"value",this.getCurrentDate()),e}getCurrentDate(){return(new Date).toJSON().slice(0,19)}createNumberInput(t){const e=this.createInput(t,"number");return this.assignAttributes(e,["min","max","placeholder"],["1","3","1"]),e}appendInputsToLabels(t,e){let r=this.deepCloneNodes(t);const o=this.deepCloneNodes(e);for(let e=0;e<t.length;e++)r[e].appendChild(o[e]);return r}joinLists(t,e){return t.concat(e)}deepCloneNodes(t){let e=[];for(const r of t)e.push(r.cloneNode(!0));return e}appendButtons(t,e){return[t,this.createSubmitButton(e)]}createSubmitButton(t){const e=document.createElement("input");let r=["submit",`Create ${t}`];return this.assignAttributes(e,["type","value"],r),e}appendElementsToForm(t,e){const r=this.deepCloneNodes(e);for(const e of r)t.appendChild(e);return t}createProjectForm=t=>{const e=this.createForm(),r=this.createLabels(["*Name:"]),o=this.createTextInputs(["project-name"]);let s=this.joinLists(this.appendInputsToLabels(r,o),this.appendButtons(t,"project"));return this.appendElementsToForm(e,s)}}class e{constructor(e=t){this.script=document.querySelector("script"),this.formCreator=new e}get script(){return this._script}set script(t){this._script=t}get formCreator(){return this._formCreator}set formCreator(t){this._formCreator=t}loadPage(){this.createHeader(),this.createSidebar(),this.createMain(),this.createFooter()}createHeader(){let t=document.createElement("header"),e=document.createElement("nav"),r=this.createNavbar();t.appendChild(e),e.appendChild(r),this.script.parentNode.insertBefore(t,this.script)}createNavbar(){let t=this.createUl("navbar"),e=[this.createButton("New to-do",{className:"new-to-do"}),this.createButton("New project",{className:"new-project"})];return this.appendListElements(t,e),t}createUl(t=""){const e=document.createElement("ul");return t&&e.classList.add(t),e}appendListElements(t,e){for(let r of e)t.appendChild(r)}loadForm=t=>{if(null===this.getElement("form")){let e=this.getElement("main");const r=t(this.createButton("Cancel",{type:"button"}));e.appendChild(r)}};getElement(t){return document.querySelector(t)}createButton(t,e={}){let r=document.createElement("button");return r.textContent=t,e.type&&r.setAttribute("type",e.type),e.className&&r.classList.add(e.className),r}removeForm(){const t=this.getElement("form");this.removeElement(t)}removeElement(t){t.remove()}addProjectToSidebar(t){let e=this.getElement(".projects-list");const r=this.createButton(t,{className:"project-button"});e.appendChild(this.createLi(r))}createHeading(t,e){let r=document.createElement(e);return r.textContent=t,r}createLi(t){let e=document.createElement("li");return e.appendChild(t),e}createSidebar(){let t=document.createElement("nav"),e=[this.createHeading("Projects","h1"),this.createProjectsList()];this.appendListElements(t,e),this.script.parentNode.insertBefore(t,this.script)}createProjectsList(){let t=this.createUl("projects-list"),e=this.createButton("default",{className:"project-button"});return t.appendChild(this.createLi(e)),t}createMain(){const t=document.createElement("main");let e=this.createDiv("content");const r=this.createProjectContainer("default-container");e.appendChild(r),t.appendChild(e),this.script.parentNode.insertBefore(t,this.script)}createProjectContainer(t,e={}){let r=t.replace("-container",""),o=this.createDiv(t),s=this.createHeading(r,"h1"),i=this.loadTodos(r,e);return this.appendListElements(o,[s,i]),o}createDiv(t){let e=document.createElement("div");return e.classList.add(t),e}loadTodos(t,e){let r=this.createUl("todo-list");if(e.pm){let o=e.pm.searchProject(t),s=this.createTodos(o.todos);this.appendListElements(r,s)}return r}createTodos(t){let e=[];for(let r of t)e.push(this.createTodo(r.title,r.description));return e}createFooter(){const t=document.createElement("footer");this.script.parentNode.insertBefore(t,this.script)}loadProject(t){this.replaceProjectContainer(`${t}-container`),this.addProjectToSidebar(t),this.removeForm()}removeProjectContainer(){const t=this.getCurrentProjectContainer();this.removeElement(t)}getCurrentProjectContainer(){return this.getElement(".content > div")}replaceProjectContainer(t,e={}){let r=this.getElement(".content"),o=this.createProjectContainer(t,e);this.removeProjectContainer(),r.appendChild(o)}getCurrentProjectName(){return this.getCurrentProjectContainer().className.split("-")[0]}createTodo(t,e){let r=this.createButton("Mark complete"),o=this.createButton("Delete",{className:"delete"}),s=this.createParagraph(`Title: ${t}, Description: ${e}`),i=this.createLi(r);return this.appendListElements(i,[o,s]),i}createParagraph(t){let e=document.createElement("p");return e.textContent=t,e}loadTodo(t){this.getElement(".todo-list").appendChild(t)}obtainTodoTitle(t){let e=t.querySelector("p").textContent.split(",");return e=e[0].split(": "),e[1]}updateTodo(t,e){let r=this.createParagraph(`Due date: ${e.dueDate}, priority: ${e.priority}`);t.appendChild(r)}getAttributeFrom(t,e){return t[e]}}class r{addNavbarListener(t,e){e.dco.getElement(".navbar").addEventListener("click",(r=>t(r,e)))}addFormListener(t,e){e.dco.getElement("form").addEventListener("click",(r=>e.handleFunction(r,t,e)))}addElementListener(t,e){t.addEventListener("click",(t=>e(t)))}}class o{constructor(t){this.name=t,this.todos=[]}addTodo(t){this.todos.push(t)}get name(){return this._name}set name(t){this._name=t}get todos(){return this._todos}set todos(t){this._todos=t}searchTodo(t){return this.todos.find((e=>e.title===t))}removeTodo(t){let e=this.getTodoIndex(t);this.todos=this.todos.slice(0,e).concat(this.todos.slice(e+1))}getTodoIndex(t){return this.todos.findIndex((e=>JSON.stringify(e)===JSON.stringify(t)))}}class s{constructor(t=o){this.projectList=[],this.addProject(new t("default"))}handleProjectCreation=(t,e)=>{t.preventDefault();const r=this.gatherProjectFormData(e.dco);this.validateProjectForm(r)?this.displayErrorModal():this.createProject(r,e)};gatherProjectFormData(t){return t.getElement("[name='project-name']").value}validateProjectForm=t=>""===t;displayErrorModal(){console.log("Couldn't create Project")}createProject(t,e,r=o){const s=t.toLowerCase();let i=new r(s);this.addProject(i),e.dco.loadProject(s),e.listenerFunction()}addProject(t){this.projectList.push(t)}searchProject(t){return this.projectList.find((e=>this.projectNameCoincides(e,t)))}projectNameCoincides(t,e){return t.name===e}get projectList(){return this._projectList}set projectList(t){this._projectList=t}}class i{constructor(t){this.title=t.title,this.description=t.description,this.dueDate=t.dueDate,this.priority=t.priority}}class n{validateTodoForm=(t,e)=>{let r=this.gatherTodoFormData(t,e.dco);this.validateFormData(r)?console.log("Couldn't create To-do"):this.addTodoToProject(r,e)};gatherTodoFormData=(t,e)=>(t.preventDefault(),{title:e.getElement("[name='todo-title']").value,description:e.getElement("[name='todo-description']").value,dueDate:e.getElement("[name='todo-dueDate']").value,priority:e.getElement("[name='todo-priority']").value});validateFormData(t){return Object.values(t).some((t=>""===t))}addTodoToProject(t,e){let r=e.pm,o=e.dco,s=this.createTodo(t),i=o.getCurrentProjectName();r.searchProject(i).addTodo(s),o.loadTodo(o.createTodo(s.title,s.description)),o.removeForm()}createTodo(t){return new i({title:t.title,description:t.description,dueDate:t.dueDate,priority:t.priority})}}(new class{constructor(){this.myDCO=new e,this.myELA=new r,this.myPM=new s,this.myTM=new n}loadPage(){this.createFC(),this.myDCO.loadPage(),this.myELA.addNavbarListener(this.handleNavbarButtons,this.getNavBarArguments()),this.myELA.addElementListener(this.myDCO.getElement(".projects-list"),this.handleProjectButtons),this.addTodoListListener()}createFC(){this.myFC=this.myDCO.formCreator}handleNavbarButtons=(t,e)=>{let r=this.myDCO.getAttributeFrom(t.target,"className"),o=this.selectFormFunctions(r,e.validateFunctions);this.myDCO.loadForm(o.formFunction),this.myELA.addFormListener(o.validateFunction,e)};selectFormFunctions(t,e){switch(t){case"new-to-do":return{validateFunction:e[0],formFunction:this.myFC.createToDoForm};case"new-project":return{validateFunction:e[1],formFunction:this.myFC.createProjectForm}}}getNavBarArguments(){return{dco:this.myDCO,pm:this.myPM,validateFunctions:this.getValidateFunctions(),handleFunction:this.handleFormButtons,listenerFunction:this.addTodoListListener}}getValidateFunctions(){return[this.myTM.validateTodoForm,this.myPM.handleProjectCreation]}handleFormButtons=(t,e,r)=>{let o=this.myDCO.getAttributeFrom(t.target,"type");"button"===o&&this.myDCO.removeForm(),"submit"===o&&e(t,r)};addTodoListListener=()=>{this.myELA.addElementListener(this.myDCO.getElement(".todo-list"),this.handleTodosLi)};handleTodosLi=t=>{let e=this.myDCO.getAttributeFrom(t.target,"nodeName"),r=this.getProjectObject();"BUTTON"!==e?this.handleTodo(t.target,r):"delete"===t.target.className&&this.removeTodo(t.target.parentElement,r)};getProjectObject(){let t=this.myDCO.getCurrentProjectName();return this.myPM.searchProject(t)}handleTodo(t,e){let r=this.getTodoObject(t,e),o=t.children.length;3==o?this.expandTodo(t,r):o>3&&this.collapseTodo(t)}getTodoObject(t,e){let r=this.myDCO.obtainTodoTitle(t);return e.searchTodo(r)}expandTodo(t,e){let r={dueDate:e.dueDate,priority:e.priority};this.myDCO.updateTodo(t,r)}collapseTodo(t){let e=t.lastChild;this.myDCO.removeElement(e)}removeTodo(t,e){let r=this.getTodoObject(t,e);e.removeTodo(r),this.myDCO.removeElement(t)}handleProjectButtons=t=>{if("project-button"===this.myDCO.getAttributeFrom(t.target,"className")){let e=this.myDCO.getAttributeFrom(t.target,"innerText");this.myDCO.replaceProjectContainer(e,{pm:this.myPM}),this.addTodoListListener()}}}).loadPage()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cEUsV0FBV3RKLEVBQVN5RyxHQUNsQixJQUFJOEMsRUFBYXJLLEtBQUtrTyxjQUFjcE4sRUFBU3lHLEdBQzdDQSxFQUFjNkMsV0FBV0MsR0FFekJySyxLQUFLd00sTUFBTXhHLGNBQWNsRixFQUMzQixDQUVBaU0scUJBQXdCckQsSUFFdEIsR0FBa0IsbUJBREYxSixLQUFLd00sTUFBTW5ELGlCQUFpQkssRUFBTXlELE9BQVEsYUFDdEIsQ0FDbEMsSUFBSWhILEVBQWNuRyxLQUFLd00sTUFBTW5ELGlCQUFpQkssRUFBTXlELE9BQVEsYUFDNURuTixLQUFLd00sTUFBTXJFLHdCQUF3QmhDLEVBQWEsQ0FBRW1HLEdBQUl0TSxLQUFLME0sT0FDM0QxTSxLQUFLZ04scUJBQ1AsS0Q5SGE1SSxVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2Zvcm0tY3JlYXRvci5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvZG9tLWNyZWF0b3IuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2V2ZW50LWxpc3RlbmVyLWFncmVnYXRvci5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvcHJvamVjdC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvcHJvamVjdC1tYW5hZ2VyLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy90b2RvLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy90b2RvLW1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9wYWdlLWNvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybUNyZWF0b3Ige1xuICBjcmVhdGVUb0RvRm9ybSA9IChidXR0b24pID0+IHtcbiAgICBjb25zdCBmb3JtID0gdGhpcy5jcmVhdGVGb3JtKCk7XG4gICAgY29uc3QgbGFiZWxDb250ZW50cyA9IFsnKlRpdGxlOicsICcqRGVzY3JpcHRpb246JywgJypEdWUgRGF0ZTonLCAnKlByaW9yaXR5OiddO1xuICAgIGNvbnN0IHRleHRJbnB1dE5hbWVzID0gWyd0b2RvLXRpdGxlJywgJ3RvZG8tZGVzY3JpcHRpb24nXTtcbiAgICBjb25zdCBsYWJlbHMgPSB0aGlzLmNyZWF0ZUxhYmVscyhsYWJlbENvbnRlbnRzKTtcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLmNyZWF0ZVRvRG9JbnB1dHModGV4dElucHV0TmFtZXMpO1xuICAgIGxldCBlbGVtZW50cyA9IHRoaXMuam9pbkxpc3RzKFxuICAgICAgdGhpcy5hcHBlbmRJbnB1dHNUb0xhYmVscyhsYWJlbHMsIGlucHV0cyksXG4gICAgICB0aGlzLmFwcGVuZEJ1dHRvbnMoYnV0dG9uLCAndG8tZG8nKSk7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kRWxlbWVudHNUb0Zvcm0oZm9ybSwgZWxlbWVudHMpO1xuICB9XG5cbiAgY3JlYXRlRm9ybSgpIHtcbiAgICBsZXQgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTtcbiAgICB0aGlzLmFzc2lnbkF0dHJpYnV0ZShmb3JtLCAnbWV0aG9kJywgJ3Bvc3QnKTtcbiAgICByZXR1cm4gZm9ybTtcbiAgfVxuXG4gIGFzc2lnbkF0dHJpYnV0ZShlbGVtZW50ICxhdHRyaWJ1dGUsIHZhbHVlPScnKSB7XG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLCB2YWx1ZSk7XG4gIH1cblxuICBjcmVhdGVMYWJlbHMobGFiZWxDb250ZW50cykge1xuICAgIGxldCBsYWJlbHMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IGNvbnRlbnQgb2YgbGFiZWxDb250ZW50cylcbiAgICAgIGxhYmVscy5wdXNoKHRoaXMuY3JlYXRlTGFiZWwoY29udGVudCkpO1xuICAgIHJldHVybiBsYWJlbHM7XG4gIH1cblxuICBjcmVhdGVMYWJlbChjb250ZW50KSB7XG4gICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICAgIGxhYmVsLnRleHRDb250ZW50ID0gY29udGVudDtcbiAgICByZXR1cm4gbGFiZWw7XG4gIH1cblxuICBjcmVhdGVUb0RvSW5wdXRzKHRleHRJbnB1dE5hbWVzKSB7XG4gICAgY29uc3QgdGV4dElucHV0cyA9IHRoaXMuY3JlYXRlVGV4dElucHV0cyh0ZXh0SW5wdXROYW1lcyk7XG4gICAgY29uc3QgZGlzdGluY3RJbnB1dHMgPSB0aGlzLmNyZWF0ZURpc3RpbmN0SW5wdXRzKCk7XG4gICAgcmV0dXJuIHRoaXMuam9pbkxpc3RzKHRleHRJbnB1dHMsIGRpc3RpbmN0SW5wdXRzKTtcbiAgfVxuXG4gIGNyZWF0ZVRleHRJbnB1dHMoaW5wdXROYW1lcykge1xuICAgIGxldCBpbnB1dHMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IG5hbWUgb2YgaW5wdXROYW1lcylcbiAgICAgIGlucHV0cy5wdXNoKHRoaXMuY3JlYXRlSW5wdXQobmFtZSkpO1xuICAgIHJldHVybiBpbnB1dHM7XG4gIH1cblxuICBjcmVhdGVJbnB1dChuYW1lLCB0eXBlPScnKSB7XG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGxldCBhdHRyaWJ1dGVzID0gWyduYW1lJywgJ3JlcXVpcmVkJ107XG4gICAgbGV0IHZhbHVlcyA9IFtuYW1lLCAnJ107XG4gICAgaWYgKHR5cGUpIHtcbiAgICAgIGF0dHJpYnV0ZXMucHVzaCgndHlwZScpO1xuICAgICAgdmFsdWVzLnB1c2godHlwZSk7XG4gICAgfVxuICAgIHRoaXMuYXNzaWduQXR0cmlidXRlcyhpbnB1dCwgYXR0cmlidXRlcywgdmFsdWVzKTtcbiAgICByZXR1cm4gaW5wdXQ7XG4gIH1cblxuICBhc3NpZ25BdHRyaWJ1dGVzKGVsZW1lbnQsIGF0dHJpYnV0ZXMsIHZhbHVlcykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cmlidXRlcy5sZW5ndGg7IGkrKylcbiAgICAgIHRoaXMuYXNzaWduQXR0cmlidXRlKGVsZW1lbnQsIGF0dHJpYnV0ZXNbaV0sIHZhbHVlc1tpXSk7XG4gIH1cblxuICBjcmVhdGVEaXN0aW5jdElucHV0cygpIHtcbiAgICAvLyBUaGVzZSBpbnB1dHMgYXJlIHVzZWQgaW4gdGhlIHRvLWRvIGZvcm1cbiAgICBjb25zdCBkYXRlUGlja2VyID0gdGhpcy5jcmVhdGVEYXRldGltZUxvY2FsSW5wdXQoJ3RvZG8tZHVlRGF0ZScpO1xuICAgIGNvbnN0IG51bWJlcklucHV0ID0gdGhpcy5jcmVhdGVOdW1iZXJJbnB1dCgndG9kby1wcmlvcml0eScpO1xuICAgIHJldHVybiBbZGF0ZVBpY2tlciwgbnVtYmVySW5wdXRdO1xuICB9XG5cbiAgY3JlYXRlRGF0ZXRpbWVMb2NhbElucHV0KG5hbWUpIHtcbiAgICBjb25zdCBpbnB1dCA9IHRoaXMuY3JlYXRlSW5wdXQobmFtZSwgJ2RhdGV0aW1lLWxvY2FsJyk7XG4gICAgdGhpcy5hc3NpZ25BdHRyaWJ1dGUoaW5wdXQsICd2YWx1ZScsIHRoaXMuZ2V0Q3VycmVudERhdGUoKSk7XG4gICAgcmV0dXJuIGlucHV0O1xuICB9XG5cbiAgZ2V0Q3VycmVudERhdGUoKSB7XG4gICAgLy8gUmV0dXJucyBpbiB0aGUgZm9ybWF0IHl5eXktTU0tREQtVGhoOm1tXG4gICAgcmV0dXJuIG5ldyBEYXRlKCkudG9KU09OKCkuc2xpY2UoMCwxOSk7XG4gIH1cblxuICBjcmVhdGVOdW1iZXJJbnB1dChuYW1lKSB7XG4gICAgLy8gRm9yIHRoZSBtb21lbnQgaXQncyBvbmx5IHVzZWQgZm9yIGEgcHJpb3JpdHkgaW5wdXRcbiAgICBjb25zdCBpbnB1dCA9IHRoaXMuY3JlYXRlSW5wdXQobmFtZSwgJ251bWJlcicpO1xuICAgIGxldCBtaW5WYWx1ZSA9ICcxJztcbiAgICBsZXQgbWF4VmFsdWUgPSAnMyc7XG4gICAgbGV0IGF0dHJpYnV0ZXMgPSBbJ21pbicsICdtYXgnLCAncGxhY2Vob2xkZXInXTtcbiAgICBsZXQgdmFsdWVzID0gW21pblZhbHVlLCBtYXhWYWx1ZSwgbWluVmFsdWVdO1xuICAgIHRoaXMuYXNzaWduQXR0cmlidXRlcyhpbnB1dCwgYXR0cmlidXRlcywgdmFsdWVzKTtcbiAgICByZXR1cm4gaW5wdXQ7XG4gIH1cblxuICBhcHBlbmRJbnB1dHNUb0xhYmVscyhsYWJlbHMsIGlucHV0cykge1xuICAgIGxldCBsYWJlbHNEZWVwQ29weSA9IHRoaXMuZGVlcENsb25lTm9kZXMobGFiZWxzKTtcbiAgICBjb25zdCBpbnB1dHNEZWVwQ29weSA9IHRoaXMuZGVlcENsb25lTm9kZXMoaW5wdXRzKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxhYmVscy5sZW5ndGg7IGkrKylcbiAgICAgIGxhYmVsc0RlZXBDb3B5W2ldLmFwcGVuZENoaWxkKGlucHV0c0RlZXBDb3B5W2ldKTtcbiAgICByZXR1cm4gbGFiZWxzRGVlcENvcHk7XG4gIH1cblxuICBqb2luTGlzdHMoZmlyc3RMaXN0LCBzZWNvbmRMaXN0KSB7XG4gICAgcmV0dXJuIGZpcnN0TGlzdC5jb25jYXQoc2Vjb25kTGlzdCk7XG4gIH1cblxuICBkZWVwQ2xvbmVOb2Rlcyhub2Rlcykge1xuICAgIGxldCBkZWVwQ2xvbmVkTm9kZXMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpXG4gICAgICBkZWVwQ2xvbmVkTm9kZXMucHVzaChub2RlLmNsb25lTm9kZSh0cnVlKSk7XG4gICAgcmV0dXJuIGRlZXBDbG9uZWROb2RlcztcbiAgfVxuXG4gIGFwcGVuZEJ1dHRvbnMoYnV0dG9uLCB2YWx1ZSkge1xuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHRoaXMuY3JlYXRlU3VibWl0QnV0dG9uKHZhbHVlKTtcbiAgICByZXR1cm4gW2J1dHRvbiwgc3VibWl0QnV0dG9uXTtcbiAgfVxuXG4gIGNyZWF0ZVN1Ym1pdEJ1dHRvbih2YWx1ZSkge1xuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgbGV0IGF0dHJpYnV0ZXMgPSBbJ3R5cGUnLCAndmFsdWUnXTtcbiAgICBsZXQgdmFsdWVzID0gWydzdWJtaXQnLCBgQ3JlYXRlICR7dmFsdWV9YF07XG4gICAgdGhpcy5hc3NpZ25BdHRyaWJ1dGVzKHN1Ym1pdEJ1dHRvbiwgYXR0cmlidXRlcywgdmFsdWVzKTtcbiAgICByZXR1cm4gc3VibWl0QnV0dG9uO1xuICB9XG5cbiAgYXBwZW5kRWxlbWVudHNUb0Zvcm0oZm9ybSwgZWxlbWVudHMpIHtcbiAgICBjb25zdCBlbGVtZW50c0RlZXBDb3B5ID0gdGhpcy5kZWVwQ2xvbmVOb2RlcyhlbGVtZW50cyk7XG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGVsZW1lbnRzRGVlcENvcHkpXG4gICAgICBmb3JtLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIHJldHVybiBmb3JtO1xuICB9XG5cbiAgY3JlYXRlUHJvamVjdEZvcm0gPSAoYnV0dG9uKSA9PiB7XG4gICAgY29uc3QgZm9ybSA9IHRoaXMuY3JlYXRlRm9ybSgpO1xuICAgIGNvbnN0IGxhYmVsID0gdGhpcy5jcmVhdGVMYWJlbHMoWycqTmFtZTonXSk7XG4gICAgY29uc3QgaW5wdXQgPSB0aGlzLmNyZWF0ZVRleHRJbnB1dHMoWydwcm9qZWN0LW5hbWUnXSk7XG4gICAgbGV0IGVsZW1lbnRzID0gdGhpcy5qb2luTGlzdHMoXG4gICAgICB0aGlzLmFwcGVuZElucHV0c1RvTGFiZWxzKGxhYmVsLCBpbnB1dCksXG4gICAgICB0aGlzLmFwcGVuZEJ1dHRvbnMoYnV0dG9uLCAncHJvamVjdCcpKTtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmRFbGVtZW50c1RvRm9ybShmb3JtLCBlbGVtZW50cyk7XG4gIH1cbn1cbiIsImltcG9ydCBGb3JtQ3JlYXRvciBmcm9tIFwiLi9mb3JtLWNyZWF0b3IuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRE9NQ3JlYXRvciB7XG4gIGNvbnN0cnVjdG9yKGZvcm1DcmVhdG9yT2JqZWN0PUZvcm1DcmVhdG9yKSB7XG4gICAgdGhpcy5zY3JpcHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzY3JpcHQnKTtcbiAgICB0aGlzLmZvcm1DcmVhdG9yID0gbmV3IGZvcm1DcmVhdG9yT2JqZWN0KCk7XG4gIH1cblxuICBnZXQgc2NyaXB0KCkge1xuICAgIHJldHVybiB0aGlzLl9zY3JpcHQ7XG4gIH1cblxuICBzZXQgc2NyaXB0KHZhbHVlKSB7XG4gICAgdGhpcy5fc2NyaXB0ID0gdmFsdWU7XG4gIH1cblxuICBnZXQgZm9ybUNyZWF0b3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1DcmVhdG9yO1xuICB9XG5cbiAgc2V0IGZvcm1DcmVhdG9yKHZhbHVlKSB7XG4gICAgdGhpcy5fZm9ybUNyZWF0b3IgPSB2YWx1ZTtcbiAgfVxuXG4gIGxvYWRQYWdlKCkge1xuICAgIHRoaXMuY3JlYXRlSGVhZGVyKCk7XG4gICAgdGhpcy5jcmVhdGVTaWRlYmFyKCk7XG4gICAgdGhpcy5jcmVhdGVNYWluKCk7XG4gICAgdGhpcy5jcmVhdGVGb290ZXIoKTtcbiAgfVxuXG4gIGNyZWF0ZUhlYWRlcigpIHtcbiAgICBsZXQgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaGVhZGVyJyk7XG4gICAgbGV0IG5hdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ25hdicpO1xuICAgIGxldCBuYXZiYXIgPSB0aGlzLmNyZWF0ZU5hdmJhcigpO1xuICAgIGhlYWRlci5hcHBlbmRDaGlsZChuYXYpO1xuICAgIG5hdi5hcHBlbmRDaGlsZChuYXZiYXIpO1xuICAgIHRoaXMuc2NyaXB0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGhlYWRlciwgdGhpcy5zY3JpcHQpO1xuICB9XG5cbiAgY3JlYXRlTmF2YmFyKCkge1xuICAgIC8vIENvbnNpZGVyIGFkZGluZyBtb3JlIGVsZW1lbnRzXG4gICAgbGV0IHVsID0gdGhpcy5jcmVhdGVVbCgnbmF2YmFyJyk7XG4gICAgbGV0IHRvZG9CdXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbignTmV3IHRvLWRvJywge2NsYXNzTmFtZTogJ25ldy10by1kbyd9KTtcbiAgICBsZXQgcHJvamVjdEJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKCdOZXcgcHJvamVjdCcsXG4gICAgICB7Y2xhc3NOYW1lOiAnbmV3LXByb2plY3QnfSk7XG4gICAgbGV0IGxpc3RFbGVtZW50cyA9IFt0b2RvQnV0dG9uLCBwcm9qZWN0QnV0dG9uXTtcbiAgICB0aGlzLmFwcGVuZExpc3RFbGVtZW50cyh1bCwgbGlzdEVsZW1lbnRzKTtcbiAgICByZXR1cm4gdWw7XG4gIH1cblxuICBjcmVhdGVVbChjbGFzc05hbWU9JycpIHtcbiAgICBjb25zdCB1bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgaWYgKGNsYXNzTmFtZSlcbiAgICAgIHVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICByZXR1cm4gdWw7XG4gIH1cblxuICBhcHBlbmRMaXN0RWxlbWVudHMobGlzdCwgZWxlbWVudHMpIHtcbiAgICBmb3IgKGxldCBlbGVtZW50IG9mIGVsZW1lbnRzKVxuICAgICAgbGlzdC5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgfVxuXG4gIGxvYWRGb3JtID0gKGNyZWF0ZUZvcm1GdW5jdGlvbikgPT4ge1xuICAgIGlmICh0aGlzLmdldEVsZW1lbnQoJ2Zvcm0nKSA9PT0gbnVsbCkge1xuICAgICAgbGV0IG1haW4gPSB0aGlzLmdldEVsZW1lbnQoJ21haW4nKTtcbiAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKCdDYW5jZWwnLCB7dHlwZTogJ2J1dHRvbid9KTtcbiAgICAgIGNvbnN0IGZvcm0gPSBjcmVhdGVGb3JtRnVuY3Rpb24oY2FuY2VsQnV0dG9uKTtcbiAgICAgIG1haW4uYXBwZW5kQ2hpbGQoZm9ybSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0RWxlbWVudChxdWVyeSkge1xuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHF1ZXJ5KTtcbiAgfVxuXG4gIGNyZWF0ZUJ1dHRvbihjb250ZW50LCBhcmdzPXt9KSB7XG4gICAgbGV0IG5ld0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIG5ld0J1dHRvbi50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgaWYgKGFyZ3NbJ3R5cGUnXSlcbiAgICAgIG5ld0J1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCBhcmdzWyd0eXBlJ10pO1xuICAgIGlmIChhcmdzWydjbGFzc05hbWUnXSlcbiAgICAgIG5ld0J1dHRvbi5jbGFzc0xpc3QuYWRkKGFyZ3NbJ2NsYXNzTmFtZSddKTtcbiAgICByZXR1cm4gbmV3QnV0dG9uO1xuICB9XG5cbiAgcmVtb3ZlRm9ybSgpIHtcbiAgICBjb25zdCBmb3JtID0gdGhpcy5nZXRFbGVtZW50KCdmb3JtJyk7XG4gICAgdGhpcy5yZW1vdmVFbGVtZW50KGZvcm0pO1xuICB9XG5cbiAgcmVtb3ZlRWxlbWVudChlbGVtZW50KSB7XG4gICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIGFkZFByb2plY3RUb1NpZGViYXIocHJvamVjdE5hbWUpIHtcbiAgICBsZXQgcHJvamVjdHNMaXN0ID0gdGhpcy5nZXRFbGVtZW50KCcucHJvamVjdHMtbGlzdCcpO1xuICAgIGNvbnN0IG5ld1Byb2plY3QgPSB0aGlzLmNyZWF0ZUJ1dHRvbihcbiAgICAgIHByb2plY3ROYW1lLCB7IGNsYXNzTmFtZTogJ3Byb2plY3QtYnV0dG9uJyB9KTtcbiAgICBwcm9qZWN0c0xpc3QuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVMaShuZXdQcm9qZWN0KSk7XG4gIH1cblxuICBjcmVhdGVIZWFkaW5nKGNvbnRlbnQsIGhlYWRpbmcpIHtcbiAgICBsZXQgaGVhZGluZ0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGhlYWRpbmcpO1xuICAgIGhlYWRpbmdFbGVtZW50LnRleHRDb250ZW50ID0gY29udGVudDtcbiAgICByZXR1cm4gaGVhZGluZ0VsZW1lbnQ7XG4gIH1cblxuICBjcmVhdGVMaShlbGVtZW50KSB7XG4gICAgbGV0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICBsaS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICByZXR1cm4gbGk7XG4gIH1cblxuICBjcmVhdGVTaWRlYmFyKCkge1xuICAgIGxldCBuYXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCduYXYnKTtcbiAgICBjb25zdCBwcm9qZWN0c0gxID0gdGhpcy5jcmVhdGVIZWFkaW5nKCdQcm9qZWN0cycsICdoMScpO1xuICAgIGxldCBwcm9qZWN0c0xpc3QgPSB0aGlzLmNyZWF0ZVByb2plY3RzTGlzdCgpO1xuICAgIGxldCBsaXN0RWxlbWVudHMgPSBbcHJvamVjdHNIMSwgcHJvamVjdHNMaXN0XTtcbiAgICB0aGlzLmFwcGVuZExpc3RFbGVtZW50cyhuYXYsIGxpc3RFbGVtZW50cyk7XG4gICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobmF2LCB0aGlzLnNjcmlwdCk7XG4gIH1cblxuICBjcmVhdGVQcm9qZWN0c0xpc3QoKSB7XG4gICAgbGV0IHByb2plY3RzTGlzdCA9IHRoaXMuY3JlYXRlVWwoJ3Byb2plY3RzLWxpc3QnKTtcbiAgICBsZXQgZGVmYXVsdEJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgJ2RlZmF1bHQnLCB7IGNsYXNzTmFtZTogJ3Byb2plY3QtYnV0dG9uJyB9KTtcbiAgICBwcm9qZWN0c0xpc3QuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVMaShkZWZhdWx0QnV0dG9uKSk7XG4gICAgcmV0dXJuIHByb2plY3RzTGlzdDtcbiAgfVxuXG4gIGNyZWF0ZU1haW4oKSB7XG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ21haW4nKTtcbiAgICBsZXQgY29udGVudCA9IHRoaXMuY3JlYXRlRGl2KCdjb250ZW50Jyk7XG4gICAgY29uc3QgZGVmYXVsdENvbnRhaW5lciA9IHRoaXMuY3JlYXRlUHJvamVjdENvbnRhaW5lcignZGVmYXVsdC1jb250YWluZXInKVxuICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQoZGVmYXVsdENvbnRhaW5lcik7XG4gICAgbWFpbi5hcHBlbmRDaGlsZChjb250ZW50KTtcbiAgICB0aGlzLnNjcmlwdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShtYWluLCB0aGlzLnNjcmlwdCk7XG4gIH1cblxuICBjcmVhdGVQcm9qZWN0Q29udGFpbmVyKHByb2plY3RDbGFzc05hbWUsIGFyZ3M9e30pIHtcbiAgICAvLyBDb25zaWRlciBhIG1ldGhvZCBpbiBhbm90aGVyIG1vZHVsZSB0byBjaGFuZ2UgdGhpcyBsaW5lXG4gICAgbGV0IHByb2plY3ROYW1lID0gcHJvamVjdENsYXNzTmFtZS5yZXBsYWNlKCctY29udGFpbmVyJywgJycpO1xuICAgIGxldCBwcm9qZWN0Q29udGFpbmVyID0gdGhpcy5jcmVhdGVEaXYocHJvamVjdENsYXNzTmFtZSk7XG4gICAgbGV0IHByb2plY3RIZWFkaW5nID0gdGhpcy5jcmVhdGVIZWFkaW5nKHByb2plY3ROYW1lLCAnaDEnKTtcbiAgICBsZXQgdG9kb0xpc3QgPSB0aGlzLmxvYWRUb2Rvcyhwcm9qZWN0TmFtZSwgYXJncyk7XG4gICAgdGhpcy5hcHBlbmRMaXN0RWxlbWVudHMocHJvamVjdENvbnRhaW5lciwgW3Byb2plY3RIZWFkaW5nLCB0b2RvTGlzdF0pO1xuICAgIHJldHVybiBwcm9qZWN0Q29udGFpbmVyO1xuICB9XG5cbiAgY3JlYXRlRGl2KGNsYXNzTmFtZSkge1xuICAgIGxldCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXYuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICAgIHJldHVybiBkaXY7XG4gIH1cbiAgXG4gIGxvYWRUb2Rvcyhwcm9qZWN0TmFtZSwgYXJncykge1xuICAgIGxldCB0b2RvTGlzdCA9IHRoaXMuY3JlYXRlVWwoJ3RvZG8tbGlzdCcpO1xuICAgIGlmIChhcmdzWydwbSddKSB7XG4gICAgICBsZXQgcHJvamVjdE9iamVjdCA9IGFyZ3NbJ3BtJ10uc2VhcmNoUHJvamVjdChwcm9qZWN0TmFtZSk7XG4gICAgICBsZXQgdG9kb3MgPSB0aGlzLmNyZWF0ZVRvZG9zKHByb2plY3RPYmplY3QudG9kb3MpO1xuICAgICAgdGhpcy5hcHBlbmRMaXN0RWxlbWVudHModG9kb0xpc3QsIHRvZG9zKTtcbiAgICB9XG4gICAgcmV0dXJuIHRvZG9MaXN0O1xuICB9XG5cbiAgY3JlYXRlVG9kb3ModG9kb3MpIHtcbiAgICBsZXQgbGlUb2RvcyA9IFtdO1xuICAgIGZvciAobGV0IHRvZG8gb2YgdG9kb3MpXG4gICAgICBsaVRvZG9zLnB1c2godGhpcy5jcmVhdGVUb2RvKHRvZG8udGl0bGUsIHRvZG8uZGVzY3JpcHRpb24pKTtcbiAgICByZXR1cm4gbGlUb2RvcztcbiAgfVxuXG4gIGNyZWF0ZUZvb3RlcigpIHtcbiAgICBjb25zdCBmb290ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb290ZXInKTtcbiAgICB0aGlzLnNjcmlwdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShmb290ZXIsIHRoaXMuc2NyaXB0KTtcbiAgfVxuXG4gIGxvYWRQcm9qZWN0KGZvcm1EYXRhKSB7XG4gICAgdGhpcy5yZXBsYWNlUHJvamVjdENvbnRhaW5lcihgJHtmb3JtRGF0YX0tY29udGFpbmVyYCk7XG4gICAgdGhpcy5hZGRQcm9qZWN0VG9TaWRlYmFyKGZvcm1EYXRhKTtcbiAgICB0aGlzLnJlbW92ZUZvcm0oKTtcbiAgfVxuXG4gIHJlbW92ZVByb2plY3RDb250YWluZXIoKSB7XG4gICAgY29uc3QgcHJvamVjdENvbnRhaW5lciA9IHRoaXMuZ2V0Q3VycmVudFByb2plY3RDb250YWluZXIoKTtcbiAgICB0aGlzLnJlbW92ZUVsZW1lbnQocHJvamVjdENvbnRhaW5lcik7XG4gIH1cblxuICBnZXRDdXJyZW50UHJvamVjdENvbnRhaW5lcigpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRFbGVtZW50KCcuY29udGVudCA+IGRpdicpO1xuICB9XG5cbiAgcmVwbGFjZVByb2plY3RDb250YWluZXIocHJvamVjdENsYXNzTmFtZSwgYXJncz17fSkge1xuICAgIGxldCBjb250ZW50ID0gdGhpcy5nZXRFbGVtZW50KCcuY29udGVudCcpO1xuICAgIGxldCBuZXdQcm9qZWN0Q29udGFpbmVyID0gdGhpcy5jcmVhdGVQcm9qZWN0Q29udGFpbmVyKFxuICAgICAgcHJvamVjdENsYXNzTmFtZSwgYXJncyk7XG4gICAgdGhpcy5yZW1vdmVQcm9qZWN0Q29udGFpbmVyKCk7XG4gICAgY29udGVudC5hcHBlbmRDaGlsZChuZXdQcm9qZWN0Q29udGFpbmVyKTtcbiAgfVxuXG4gIGdldEN1cnJlbnRQcm9qZWN0TmFtZSgpIHtcbiAgICBjb25zdCBwcm9qZWN0Q29udGFpbmVyID0gdGhpcy5nZXRDdXJyZW50UHJvamVjdENvbnRhaW5lcigpO1xuICAgIGxldCBwcm9qZWN0Q2xhc3NOYW1lID0gcHJvamVjdENvbnRhaW5lci5jbGFzc05hbWU7XG4gICAgcmV0dXJuIHByb2plY3RDbGFzc05hbWUuc3BsaXQoJy0nKVswXTtcbiAgfVxuXG4gIGNyZWF0ZVRvZG8odGl0bGUsIGRlc2NyaXB0aW9uKSB7XG4gICAgbGV0IGNyZWF0ZUJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKCdNYXJrIGNvbXBsZXRlJyk7XG4gICAgbGV0IGRlbGV0ZUJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKCdEZWxldGUnLCB7Y2xhc3NOYW1lOiAnZGVsZXRlJ30pO1xuICAgIGxldCB0b2RvSW5mbyA9IHRoaXMuY3JlYXRlUGFyYWdyYXBoKFxuICAgICAgYFRpdGxlOiAke3RpdGxlfSwgRGVzY3JpcHRpb246ICR7ZGVzY3JpcHRpb259YCk7XG4gICAgbGV0IGxpID0gdGhpcy5jcmVhdGVMaShjcmVhdGVCdXR0b24pO1xuICAgIHRoaXMuYXBwZW5kTGlzdEVsZW1lbnRzKGxpLCBbZGVsZXRlQnV0dG9uLCB0b2RvSW5mb10pO1xuICAgIHJldHVybiBsaTtcbiAgfVxuXG4gIGNyZWF0ZVBhcmFncmFwaChjb250ZW50KSB7XG4gICAgbGV0IHBhcmFncmFwaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBwYXJhZ3JhcGgudGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgIHJldHVybiBwYXJhZ3JhcGg7XG4gIH1cblxuICBsb2FkVG9kbyh0b2RvKSB7XG4gICAgbGV0IHRvZG9MaXN0ID0gdGhpcy5nZXRFbGVtZW50KCcudG9kby1saXN0Jyk7XG4gICAgdG9kb0xpc3QuYXBwZW5kQ2hpbGQodG9kbyk7XG4gIH1cblxuICBvYnRhaW5Ub2RvVGl0bGUobGlFbGVtZW50KSB7XG4gICAgbGV0IHRvZG9JbmZvID0gbGlFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKTtcbiAgICBsZXQgdG9kb1RpdGxlID0gdG9kb0luZm8udGV4dENvbnRlbnQuc3BsaXQoJywnKTtcbiAgICB0b2RvVGl0bGUgPSB0b2RvVGl0bGVbMF0uc3BsaXQoJzogJyk7XG4gICAgcmV0dXJuIHRvZG9UaXRsZVsxXTtcbiAgfVxuXG4gIHVwZGF0ZVRvZG8odG9kb0VsZW1lbnQsIHRvZG9EYXRhKSB7XG4gICAgbGV0IHAgPSB0aGlzLmNyZWF0ZVBhcmFncmFwaChcbiAgICAgIGBEdWUgZGF0ZTogJHt0b2RvRGF0YVsnZHVlRGF0ZSddfSwgcHJpb3JpdHk6ICR7dG9kb0RhdGFbJ3ByaW9yaXR5J119YCk7XG4gICAgdG9kb0VsZW1lbnQuYXBwZW5kQ2hpbGQocCk7XG4gIH1cblxuICBnZXRBdHRyaWJ1dGVGcm9tKGVsZW1lbnQsIGF0dHJpYnV0ZSkge1xuICAgIHJldHVybiBlbGVtZW50W2F0dHJpYnV0ZV07XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEV2ZW50TGlzdGVuZXJBZ3JlZ2F0b3Ige1xuICBhZGROYXZiYXJMaXN0ZW5lcihoYW5kbGVGdW5jdGlvbiwgYXJncykge1xuICAgIGxldCBuYXZiYXIgPSBhcmdzWydkY28nXS5nZXRFbGVtZW50KCcubmF2YmFyJyk7XG4gICAgbmF2YmFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxcbiAgICAgIChldmVudCkgPT4gaGFuZGxlRnVuY3Rpb24oZXZlbnQsIGFyZ3MpKTtcbiAgfVxuXG4gIGFkZEZvcm1MaXN0ZW5lcih2YWxpZGF0ZUZ1bmN0aW9uLCBhcmdzKSB7XG4gICAgbGV0IGZvcm0gPSBhcmdzWydkY28nXS5nZXRFbGVtZW50KCdmb3JtJyk7XG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsXG4gICAgICAoZXZlbnQpID0+IGFyZ3NbJ2hhbmRsZUZ1bmN0aW9uJ10oZXZlbnQsIHZhbGlkYXRlRnVuY3Rpb24sIGFyZ3MpKTtcbiAgfVxuXG4gIGFkZEVsZW1lbnRMaXN0ZW5lcihlbGVtZW50LCBoYW5kbGVGdW5jdGlvbikge1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IGhhbmRsZUZ1bmN0aW9uKGV2ZW50KSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2plY3QgeyAgXG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMudG9kb3MgPSBbXTtcbiAgfVxuXG4gIGFkZFRvZG8odG9kbykge1xuICAgIHRoaXMudG9kb3MucHVzaCh0b2RvKTtcbiAgfVxuXG4gIGdldCBuYW1lKCkge1xuICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICB9XG5cbiAgc2V0IG5hbWUodmFsdWUpIHtcbiAgICB0aGlzLl9uYW1lID0gdmFsdWU7XG4gIH1cblxuICBnZXQgdG9kb3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RvZG9zO1xuICB9XG5cbiAgc2V0IHRvZG9zKHZhbHVlKSB7XG4gICAgdGhpcy5fdG9kb3MgPSB2YWx1ZTtcbiAgfVxuXG4gIHNlYXJjaFRvZG8odG9kb1RpdGxlKSB7XG4gICAgcmV0dXJuIHRoaXMudG9kb3MuZmluZCh0b2RvID0+IHRvZG8udGl0bGUgPT09IHRvZG9UaXRsZSk7XG4gIH1cblxuICByZW1vdmVUb2RvKHRvZG9PYmplY3QpIHtcbiAgICBsZXQgdG9kb0luZGV4ID0gdGhpcy5nZXRUb2RvSW5kZXgodG9kb09iamVjdCk7XG4gICAgdGhpcy50b2RvcyA9IHRoaXMudG9kb3Muc2xpY2UoMCwgdG9kb0luZGV4KS5cbiAgICAgIGNvbmNhdCh0aGlzLnRvZG9zLnNsaWNlKHRvZG9JbmRleCArIDEpKTtcbiAgfVxuXG4gIGdldFRvZG9JbmRleCh0b2RvT2JqZWN0KSB7XG4gICAgcmV0dXJuIHRoaXMudG9kb3MuZmluZEluZGV4KHRvZG8gPT5cbiAgICAgIEpTT04uc3RyaW5naWZ5KHRvZG8pID09PSBKU09OLnN0cmluZ2lmeSh0b2RvT2JqZWN0KSk7XG4gIH1cbn1cbiIsImltcG9ydCBQcm9qZWN0IGZyb20gJy4vcHJvamVjdC5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2plY3RNYW5hZ2VyIHtcbiAgY29uc3RydWN0b3IocHJvamVjdE9iamVjdD1Qcm9qZWN0KSB7XG4gICAgdGhpcy5wcm9qZWN0TGlzdCA9IFtdO1xuICAgIHRoaXMuYWRkUHJvamVjdChuZXcgcHJvamVjdE9iamVjdCgnZGVmYXVsdCcpKTtcbiAgfVxuXG4gIGhhbmRsZVByb2plY3RDcmVhdGlvbiA9IChldmVudCwgYXJncykgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgZm9ybURhdGEgPSB0aGlzLmdhdGhlclByb2plY3RGb3JtRGF0YShhcmdzWydkY28nXSk7XG4gICAgbGV0IHJlc3VsdCA9IHRoaXMudmFsaWRhdGVQcm9qZWN0Rm9ybShmb3JtRGF0YSk7XG4gICAgaWYgKHJlc3VsdClcbiAgICAgIHRoaXMuZGlzcGxheUVycm9yTW9kYWwoKTtcbiAgICBlbHNlXG4gICAgICB0aGlzLmNyZWF0ZVByb2plY3QoZm9ybURhdGEsIGFyZ3MpO1xuICB9XG5cbiAgZ2F0aGVyUHJvamVjdEZvcm1EYXRhKGRjbykge1xuICAgIGNvbnN0IHByb2plY3ROYW1lID0gZGNvLmdldEVsZW1lbnQoXCJbbmFtZT0ncHJvamVjdC1uYW1lJ11cIikudmFsdWU7XG4gICAgcmV0dXJuIHByb2plY3ROYW1lO1xuICB9XG5cbiAgdmFsaWRhdGVQcm9qZWN0Rm9ybSA9IChmb3JtRGF0YSkgPT4ge1xuICAgIHJldHVybiBmb3JtRGF0YSA9PT0gJyc7XG4gIH1cblxuICBkaXNwbGF5RXJyb3JNb2RhbCgpIHtcbiAgICBjb25zb2xlLmxvZyhcIkNvdWxkbid0IGNyZWF0ZSBQcm9qZWN0XCIpO1xuICB9XG5cbiAgY3JlYXRlUHJvamVjdChmb3JtRGF0YSwgYXJncywgcHJvamVjdE9iamVjdD1Qcm9qZWN0KSB7XG4gICAgY29uc3QgZm9ybURhdGFMb3dlcmNhc2UgPSBmb3JtRGF0YS50b0xvd2VyQ2FzZSgpO1xuICAgIGxldCBuZXdQcm9qZWN0ID0gbmV3IHByb2plY3RPYmplY3QoZm9ybURhdGFMb3dlcmNhc2UpO1xuICAgIHRoaXMuYWRkUHJvamVjdChuZXdQcm9qZWN0KTtcbiAgICBhcmdzWydkY28nXS5sb2FkUHJvamVjdChmb3JtRGF0YUxvd2VyY2FzZSk7XG4gICAgLy8gQWRkIGxpc3RlbmVyIHRvIHRvZG8gbGlzdFxuICAgIGFyZ3NbJ2xpc3RlbmVyRnVuY3Rpb24nXSgpO1xuICB9XG5cbiAgYWRkUHJvamVjdChwcm9qZWN0KSB7XG4gICAgdGhpcy5wcm9qZWN0TGlzdC5wdXNoKHByb2plY3QpO1xuICB9XG5cbiAgc2VhcmNoUHJvamVjdChwcm9qZWN0TmFtZSkge1xuICAgIHJldHVybiB0aGlzLnByb2plY3RMaXN0LmZpbmQocHJvamVjdCA9PlxuICAgICAgdGhpcy5wcm9qZWN0TmFtZUNvaW5jaWRlcyhwcm9qZWN0LCBwcm9qZWN0TmFtZSkpO1xuICB9XG5cbiAgcHJvamVjdE5hbWVDb2luY2lkZXMocHJvamVjdCwgcHJvamVjdE5hbWUpIHtcbiAgICByZXR1cm4gcHJvamVjdC5uYW1lID09PSBwcm9qZWN0TmFtZTtcbiAgfVxuXG4gIGdldCBwcm9qZWN0TGlzdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fcHJvamVjdExpc3Q7XG4gIH1cblxuICBzZXQgcHJvamVjdExpc3QodmFsdWUpIHtcbiAgICB0aGlzLl9wcm9qZWN0TGlzdCA9IHZhbHVlO1xuICB9XG5cbiAgLy8gRnVuY3Rpb24gdG8gcmVtb3ZlIHByb2plY3Rcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvZG8ge1xuICBjb25zdHJ1Y3RvcihhcmdzKSB7XG4gICAgdGhpcy50aXRsZSA9IGFyZ3NbJ3RpdGxlJ107XG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGFyZ3NbJ2Rlc2NyaXB0aW9uJ107XG4gICAgdGhpcy5kdWVEYXRlID0gYXJnc1snZHVlRGF0ZSddO1xuICAgIHRoaXMucHJpb3JpdHkgPSBhcmdzWydwcmlvcml0eSddO1xuICB9XG59XG4iLCJpbXBvcnQgVG9kbyBmcm9tICcuL3RvZG8uanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUb2RvTWFuYWdlciB7XG4gIHZhbGlkYXRlVG9kb0Zvcm0gPSAoZXZlbnQsIGFyZ3MpID0+IHtcbiAgICBsZXQgZm9ybURhdGEgPSB0aGlzLmdhdGhlclRvZG9Gb3JtRGF0YShldmVudCwgYXJnc1snZGNvJ10pO1xuICAgIGxldCByZXN1bHQgPSB0aGlzLnZhbGlkYXRlRm9ybURhdGEoZm9ybURhdGEpO1xuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgIC8vIEFkZCBzb21ldGhpbmcgdG8gbm90aWZ5IGVycm9yIHRvIHVzZXIgKG1heWJlIHVzZSBhIG1vZGFsKVxuICAgICAgY29uc29sZS5sb2coXCJDb3VsZG4ndCBjcmVhdGUgVG8tZG9cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuYWRkVG9kb1RvUHJvamVjdChmb3JtRGF0YSwgYXJncyk7XG4gIH1cblxuICBnYXRoZXJUb2RvRm9ybURhdGEgPSAoZXZlbnQsIGRjbykgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdG9kb1RpdGxlID0gZGNvLmdldEVsZW1lbnQoXCJbbmFtZT0ndG9kby10aXRsZSddXCIpLnZhbHVlO1xuICAgIGNvbnN0IHRvZG9EZXNjcmlwdGlvbiA9IGRjby5nZXRFbGVtZW50KFwiW25hbWU9J3RvZG8tZGVzY3JpcHRpb24nXVwiKS52YWx1ZTtcbiAgICBjb25zdCB0b2RvRHVlRGF0ZSA9IGRjby5nZXRFbGVtZW50KFwiW25hbWU9J3RvZG8tZHVlRGF0ZSddXCIpLnZhbHVlO1xuICAgIGNvbnN0IHRvZG9Qcmlvcml0eSA9IGRjby5nZXRFbGVtZW50KFwiW25hbWU9J3RvZG8tcHJpb3JpdHknXVwiKS52YWx1ZTtcbiAgICByZXR1cm4geyB0aXRsZTogdG9kb1RpdGxlLCBcbiAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdG9kb0Rlc2NyaXB0aW9uLFxuICAgICAgICAgICAgIGR1ZURhdGU6IHRvZG9EdWVEYXRlLFxuICAgICAgICAgICAgIHByaW9yaXR5OiB0b2RvUHJpb3JpdHkgfTtcbiAgfVxuXG4gIHZhbGlkYXRlRm9ybURhdGEoZm9ybURhdGEpIHtcbiAgICBsZXQgdmFsdWVzID0gT2JqZWN0LnZhbHVlcyhmb3JtRGF0YSk7XG4gICAgcmV0dXJuIHZhbHVlcy5zb21lKHZhbHVlID0+IHZhbHVlID09PSAnJyk7XG4gIH1cblxuICBhZGRUb2RvVG9Qcm9qZWN0KGZvcm1EYXRhLCBhcmdzKSB7XG4gICAgbGV0IHBtID0gYXJnc1sncG0nXTtcbiAgICBsZXQgZGNvID0gYXJnc1snZGNvJ107XG4gICAgbGV0IG5ld1RvZG8gPSB0aGlzLmNyZWF0ZVRvZG8oZm9ybURhdGEpO1xuICAgIGxldCBwcm9qZWN0TmFtZSA9IGRjby5nZXRDdXJyZW50UHJvamVjdE5hbWUoKTtcbiAgICBsZXQgcHJvamVjdE9iamVjdCA9IHBtLnNlYXJjaFByb2plY3QocHJvamVjdE5hbWUpO1xuICAgIHByb2plY3RPYmplY3QuYWRkVG9kbyhuZXdUb2RvKTtcbiAgICBkY28ubG9hZFRvZG8oZGNvLmNyZWF0ZVRvZG8obmV3VG9kby50aXRsZSwgbmV3VG9kby5kZXNjcmlwdGlvbikpO1xuICAgIGRjby5yZW1vdmVGb3JtKCk7XG4gIH1cblxuICBjcmVhdGVUb2RvKGZvcm1EYXRhKSB7XG4gICAgcmV0dXJuIG5ldyBUb2RvKHsgdGl0bGU6IGZvcm1EYXRhWyd0aXRsZSddLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBmb3JtRGF0YVsnZGVzY3JpcHRpb24nXSxcbiAgICAgICAgICAgICAgICAgICAgICBkdWVEYXRlOiBmb3JtRGF0YVsnZHVlRGF0ZSddLFxuICAgICAgICAgICAgICAgICAgICAgIHByaW9yaXR5OiBmb3JtRGF0YVsncHJpb3JpdHknXSB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBhZ2VDb250cm9sbGVyIGZyb20gXCIuL3BhZ2UtY29udHJvbGxlci5qc1wiO1xuXG5jb25zdCBteVBhZ2VDb250cm9sbGVyID0gbmV3IFBhZ2VDb250cm9sbGVyO1xubXlQYWdlQ29udHJvbGxlci5sb2FkUGFnZSgpO1xuIiwiaW1wb3J0IERPTUNyZWF0b3IgZnJvbSAnLi9kb20tY3JlYXRvci5qcyc7XG5pbXBvcnQgRXZlbnRMaXN0ZW5lckFncmVnYXRvciBmcm9tICcuL2V2ZW50LWxpc3RlbmVyLWFncmVnYXRvci5qcyc7XG5pbXBvcnQgUHJvamVjdE1hbmFnZXIgZnJvbSAnLi9wcm9qZWN0LW1hbmFnZXIuanMnO1xuaW1wb3J0IFRvZG9NYW5hZ2VyIGZyb20gJy4vdG9kby1tYW5hZ2VyLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFnZUNvbnRyb2xsZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLm15RENPID0gbmV3IERPTUNyZWF0b3IoKTtcbiAgICB0aGlzLm15RUxBID0gbmV3IEV2ZW50TGlzdGVuZXJBZ3JlZ2F0b3IoKTtcbiAgICB0aGlzLm15UE0gPSBuZXcgUHJvamVjdE1hbmFnZXIoKTtcbiAgICB0aGlzLm15VE0gPSBuZXcgVG9kb01hbmFnZXIoKTtcbiAgfVxuXG4gIGxvYWRQYWdlKCkge1xuICAgIHRoaXMuY3JlYXRlRkMoKTtcbiAgICB0aGlzLm15RENPLmxvYWRQYWdlKCk7XG4gICAgdGhpcy5teUVMQS5hZGROYXZiYXJMaXN0ZW5lcihcbiAgICAgIHRoaXMuaGFuZGxlTmF2YmFyQnV0dG9ucywgdGhpcy5nZXROYXZCYXJBcmd1bWVudHMoKSk7XG4gICAgdGhpcy5teUVMQS5hZGRFbGVtZW50TGlzdGVuZXIoXG4gICAgICB0aGlzLm15RENPLmdldEVsZW1lbnQoJy5wcm9qZWN0cy1saXN0JyksIHRoaXMuaGFuZGxlUHJvamVjdEJ1dHRvbnMpO1xuICAgIHRoaXMuYWRkVG9kb0xpc3RMaXN0ZW5lcigpO1xuICB9XG5cbiAgY3JlYXRlRkMoKSB7XG4gICAgdGhpcy5teUZDID0gdGhpcy5teURDTy5mb3JtQ3JlYXRvcjtcbiAgfVxuXG4gIGhhbmRsZU5hdmJhckJ1dHRvbnMgPSAoZXZlbnQsIGFyZ3MpID0+IHtcbiAgICBsZXQgZm9ybU5hbWUgPSB0aGlzLm15RENPLmdldEF0dHJpYnV0ZUZyb20oXG4gICAgICBldmVudC50YXJnZXQsICdjbGFzc05hbWUnKTtcbiAgICBsZXQgZm9ybUZ1bmN0aW9ucyA9IHRoaXMuc2VsZWN0Rm9ybUZ1bmN0aW9ucyhcbiAgICAgIGZvcm1OYW1lLCBhcmdzWyd2YWxpZGF0ZUZ1bmN0aW9ucyddKTtcbiAgICB0aGlzLm15RENPLmxvYWRGb3JtKGZvcm1GdW5jdGlvbnNbJ2Zvcm1GdW5jdGlvbiddKTtcbiAgICB0aGlzLm15RUxBLmFkZEZvcm1MaXN0ZW5lcihmb3JtRnVuY3Rpb25zWyd2YWxpZGF0ZUZ1bmN0aW9uJ10sIGFyZ3MpO1xuICB9XG5cbiAgc2VsZWN0Rm9ybUZ1bmN0aW9ucyhmb3JtTmFtZSwgZnVuY3Rpb25zKSB7XG4gICAgc3dpdGNoKGZvcm1OYW1lKSB7XG4gICAgICBjYXNlICduZXctdG8tZG8nOlxuICAgICAgICByZXR1cm4geyB2YWxpZGF0ZUZ1bmN0aW9uOiBmdW5jdGlvbnNbMF0sXG4gICAgICAgICAgICAgICAgIGZvcm1GdW5jdGlvbjogdGhpcy5teUZDLmNyZWF0ZVRvRG9Gb3JtIH07XG4gICAgICBjYXNlICduZXctcHJvamVjdCc6XG4gICAgICAgIHJldHVybiB7IHZhbGlkYXRlRnVuY3Rpb246IGZ1bmN0aW9uc1sxXSxcbiAgICAgICAgICAgICAgICAgZm9ybUZ1bmN0aW9uOiB0aGlzLm15RkMuY3JlYXRlUHJvamVjdEZvcm0gfTtcbiAgICB9XG4gIH1cblxuICBnZXROYXZCYXJBcmd1bWVudHMoKSB7XG4gICAgcmV0dXJuIHsgZGNvOiB0aGlzLm15RENPLFxuICAgICAgICAgICAgIHBtOiB0aGlzLm15UE0sXG4gICAgICAgICAgICAgdmFsaWRhdGVGdW5jdGlvbnM6IHRoaXMuZ2V0VmFsaWRhdGVGdW5jdGlvbnMoKSxcbiAgICAgICAgICAgICBoYW5kbGVGdW5jdGlvbjogdGhpcy5oYW5kbGVGb3JtQnV0dG9ucyxcbiAgICAgICAgICAgICBsaXN0ZW5lckZ1bmN0aW9uOiB0aGlzLmFkZFRvZG9MaXN0TGlzdGVuZXIgfTtcbiAgfVxuXG4gIGdldFZhbGlkYXRlRnVuY3Rpb25zKCkge1xuICAgIGxldCBmdW5jdGlvbnMgPSBbdGhpcy5teVRNLnZhbGlkYXRlVG9kb0Zvcm0sXG4gICAgICAgICAgICAgICAgICAgICB0aGlzLm15UE0uaGFuZGxlUHJvamVjdENyZWF0aW9uXTtcbiAgICByZXR1cm4gZnVuY3Rpb25zO1xuICB9XG5cbiAgaGFuZGxlRm9ybUJ1dHRvbnMgPSAoZXZlbnQsIHZhbGlkYXRlRnVuY3Rpb24sIGFyZ3MpID0+IHtcbiAgICBsZXQgYnV0dG9uVHlwZSA9IHRoaXMubXlEQ08uZ2V0QXR0cmlidXRlRnJvbShldmVudC50YXJnZXQsICd0eXBlJyk7XG4gICAgaWYgKGJ1dHRvblR5cGUgPT09ICdidXR0b24nKVxuICAgICAgdGhpcy5teURDTy5yZW1vdmVGb3JtKCk7XG4gICAgaWYgKGJ1dHRvblR5cGUgPT09ICdzdWJtaXQnKVxuICAgICAgdmFsaWRhdGVGdW5jdGlvbihldmVudCwgYXJncyk7XG4gIH1cblxuICBhZGRUb2RvTGlzdExpc3RlbmVyID0gKCkgPT4ge1xuICAgIHRoaXMubXlFTEEuYWRkRWxlbWVudExpc3RlbmVyKFxuICAgICAgdGhpcy5teURDTy5nZXRFbGVtZW50KCcudG9kby1saXN0JyksIHRoaXMuaGFuZGxlVG9kb3NMaSk7XG4gIH1cblxuICBoYW5kbGVUb2Rvc0xpID0gKGV2ZW50KSA9PiB7XG4gICAgbGV0IG5vZGVOYW1lID0gdGhpcy5teURDTy5nZXRBdHRyaWJ1dGVGcm9tKGV2ZW50LnRhcmdldCwgJ25vZGVOYW1lJyk7XG4gICAgbGV0IHByb2plY3RPYmplY3QgPSB0aGlzLmdldFByb2plY3RPYmplY3QoKTtcbiAgICBpZiAobm9kZU5hbWUgIT09ICdCVVRUT04nKVxuICAgICAgdGhpcy5oYW5kbGVUb2RvKGV2ZW50LnRhcmdldCwgcHJvamVjdE9iamVjdCk7XG4gICAgZWxzZSBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTmFtZSA9PT0gJ2RlbGV0ZScpXG4gICAgICB0aGlzLnJlbW92ZVRvZG8oZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQsIHByb2plY3RPYmplY3QpO1xuICB9XG5cbiAgZ2V0UHJvamVjdE9iamVjdCgpIHtcbiAgICBsZXQgcHJvamVjdE5hbWUgPSB0aGlzLm15RENPLmdldEN1cnJlbnRQcm9qZWN0TmFtZSgpO1xuICAgIHJldHVybiB0aGlzLm15UE0uc2VhcmNoUHJvamVjdChwcm9qZWN0TmFtZSk7ICAgIFxuICB9XG5cbiAgaGFuZGxlVG9kbyhlbGVtZW50LCBwcm9qZWN0T2JqZWN0KSB7XG4gICAgbGV0IHRvZG9PYmplY3QgPSB0aGlzLmdldFRvZG9PYmplY3QoZWxlbWVudCwgcHJvamVjdE9iamVjdCk7XG4gICAgbGV0IHRvZG9DaGlsZHJlbiA9IGVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoO1xuICAgIGlmICh0b2RvQ2hpbGRyZW4gPT0gMylcbiAgICAgIHRoaXMuZXhwYW5kVG9kbyhlbGVtZW50LCB0b2RvT2JqZWN0KTtcbiAgICBlbHNlIGlmICh0b2RvQ2hpbGRyZW4gPiAzKVxuICAgICAgdGhpcy5jb2xsYXBzZVRvZG8oZWxlbWVudCk7XG4gIH1cblxuICBnZXRUb2RvT2JqZWN0KGVsZW1lbnQsIHByb2plY3RPYmplY3QpIHtcbiAgICBsZXQgdG9kb1RpdGxlID0gdGhpcy5teURDTy5vYnRhaW5Ub2RvVGl0bGUoZWxlbWVudCk7XG4gICAgcmV0dXJuIHByb2plY3RPYmplY3Quc2VhcmNoVG9kbyh0b2RvVGl0bGUpO1xuICB9XG5cbiAgZXhwYW5kVG9kbyhlbGVtZW50LCB0b2RvT2JqZWN0KSB7XG4gICAgbGV0IHRvZG9SZW1haW5pbmdEYXRhID0ge1xuICAgICAgZHVlRGF0ZTogdG9kb09iamVjdC5kdWVEYXRlLCBwcmlvcml0eTogdG9kb09iamVjdC5wcmlvcml0eX07XG4gICAgLy8gbWF5YmUgYWRkIGEgYnV0dG9uIHRoYXQgYWxsb3dzIHRvIGVkaXQgdGhlIHRvZG8uXG4gICAgdGhpcy5teURDTy51cGRhdGVUb2RvKGVsZW1lbnQsIHRvZG9SZW1haW5pbmdEYXRhKTtcbiAgICAvLyBhZGQgc29tZXRoaW5nIGxhdGVyIHRvIG1hcmsgdGhlIHRvZG8gYXMgY29tcGxldGUgKHRoaW5rIGFib3V0IGFkZGluZ1xuICAgIC8vICAgYSBuZXcgY29tcGxldGVkIHByb3BlcnR5IGluIHRvZG8gb2JqZWN0KVxuICB9XG5cbiAgY29sbGFwc2VUb2RvKGVsZW1lbnQpIHtcbiAgICBsZXQgbGFzdFBhcmFncmFwaCA9IGVsZW1lbnQubGFzdENoaWxkO1xuICAgIHRoaXMubXlEQ08ucmVtb3ZlRWxlbWVudChsYXN0UGFyYWdyYXBoKTtcbiAgfVxuXG4gIHJlbW92ZVRvZG8oZWxlbWVudCwgcHJvamVjdE9iamVjdCkge1xuICAgIGxldCB0b2RvT2JqZWN0ID0gdGhpcy5nZXRUb2RvT2JqZWN0KGVsZW1lbnQsIHByb2plY3RPYmplY3QpO1xuICAgIHByb2plY3RPYmplY3QucmVtb3ZlVG9kbyh0b2RvT2JqZWN0KTtcbiAgICAvLyBtYWtlIHRoaXMgbGluZSBhIG1ldGhvZCB3aGVuIGFkZGluZyBtYXJrIGNvbXBsZXRlIGxvZ2ljXG4gICAgdGhpcy5teURDTy5yZW1vdmVFbGVtZW50KGVsZW1lbnQpO1xuICB9XG5cbiAgaGFuZGxlUHJvamVjdEJ1dHRvbnMgPSAoZXZlbnQpID0+IHtcbiAgICBsZXQgY2xhc3NOYW1lID0gdGhpcy5teURDTy5nZXRBdHRyaWJ1dGVGcm9tKGV2ZW50LnRhcmdldCwgJ2NsYXNzTmFtZScpO1xuICAgIGlmIChjbGFzc05hbWUgPT09ICdwcm9qZWN0LWJ1dHRvbicpIHtcbiAgICAgIGxldCBwcm9qZWN0TmFtZSA9IHRoaXMubXlEQ08uZ2V0QXR0cmlidXRlRnJvbShldmVudC50YXJnZXQsICdpbm5lclRleHQnKTtcbiAgICAgIHRoaXMubXlEQ08ucmVwbGFjZVByb2plY3RDb250YWluZXIocHJvamVjdE5hbWUsIHsgcG06IHRoaXMubXlQTSB9KTtcbiAgICAgIHRoaXMuYWRkVG9kb0xpc3RMaXN0ZW5lcigpO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbIkZvcm1DcmVhdG9yIiwiY3JlYXRlVG9Eb0Zvcm0iLCJidXR0b24iLCJmb3JtIiwidGhpcyIsImNyZWF0ZUZvcm0iLCJsYWJlbHMiLCJjcmVhdGVMYWJlbHMiLCJpbnB1dHMiLCJjcmVhdGVUb0RvSW5wdXRzIiwiZWxlbWVudHMiLCJqb2luTGlzdHMiLCJhcHBlbmRJbnB1dHNUb0xhYmVscyIsImFwcGVuZEJ1dHRvbnMiLCJhcHBlbmRFbGVtZW50c1RvRm9ybSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImFzc2lnbkF0dHJpYnV0ZSIsImVsZW1lbnQiLCJhdHRyaWJ1dGUiLCJ2YWx1ZSIsInNldEF0dHJpYnV0ZSIsImxhYmVsQ29udGVudHMiLCJjb250ZW50IiwicHVzaCIsImNyZWF0ZUxhYmVsIiwibGFiZWwiLCJ0ZXh0Q29udGVudCIsInRleHRJbnB1dE5hbWVzIiwidGV4dElucHV0cyIsImNyZWF0ZVRleHRJbnB1dHMiLCJkaXN0aW5jdElucHV0cyIsImNyZWF0ZURpc3RpbmN0SW5wdXRzIiwiaW5wdXROYW1lcyIsIm5hbWUiLCJjcmVhdGVJbnB1dCIsInR5cGUiLCJpbnB1dCIsImF0dHJpYnV0ZXMiLCJ2YWx1ZXMiLCJhc3NpZ25BdHRyaWJ1dGVzIiwiaSIsImxlbmd0aCIsImNyZWF0ZURhdGV0aW1lTG9jYWxJbnB1dCIsImNyZWF0ZU51bWJlcklucHV0IiwiZ2V0Q3VycmVudERhdGUiLCJEYXRlIiwidG9KU09OIiwic2xpY2UiLCJsYWJlbHNEZWVwQ29weSIsImRlZXBDbG9uZU5vZGVzIiwiaW5wdXRzRGVlcENvcHkiLCJhcHBlbmRDaGlsZCIsImZpcnN0TGlzdCIsInNlY29uZExpc3QiLCJjb25jYXQiLCJub2RlcyIsImRlZXBDbG9uZWROb2RlcyIsIm5vZGUiLCJjbG9uZU5vZGUiLCJjcmVhdGVTdWJtaXRCdXR0b24iLCJzdWJtaXRCdXR0b24iLCJlbGVtZW50c0RlZXBDb3B5IiwiY3JlYXRlUHJvamVjdEZvcm0iLCJET01DcmVhdG9yIiwiY29uc3RydWN0b3IiLCJmb3JtQ3JlYXRvck9iamVjdCIsInNjcmlwdCIsInF1ZXJ5U2VsZWN0b3IiLCJmb3JtQ3JlYXRvciIsIl9zY3JpcHQiLCJfZm9ybUNyZWF0b3IiLCJsb2FkUGFnZSIsImNyZWF0ZUhlYWRlciIsImNyZWF0ZVNpZGViYXIiLCJjcmVhdGVNYWluIiwiY3JlYXRlRm9vdGVyIiwiaGVhZGVyIiwibmF2IiwibmF2YmFyIiwiY3JlYXRlTmF2YmFyIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsInVsIiwiY3JlYXRlVWwiLCJsaXN0RWxlbWVudHMiLCJjcmVhdGVCdXR0b24iLCJjbGFzc05hbWUiLCJhcHBlbmRMaXN0RWxlbWVudHMiLCJjbGFzc0xpc3QiLCJhZGQiLCJsaXN0IiwibG9hZEZvcm0iLCJjcmVhdGVGb3JtRnVuY3Rpb24iLCJnZXRFbGVtZW50IiwibWFpbiIsInF1ZXJ5IiwiYXJncyIsIm5ld0J1dHRvbiIsInJlbW92ZUZvcm0iLCJyZW1vdmVFbGVtZW50IiwicmVtb3ZlIiwiYWRkUHJvamVjdFRvU2lkZWJhciIsInByb2plY3ROYW1lIiwicHJvamVjdHNMaXN0IiwibmV3UHJvamVjdCIsImNyZWF0ZUxpIiwiY3JlYXRlSGVhZGluZyIsImhlYWRpbmciLCJoZWFkaW5nRWxlbWVudCIsImxpIiwiY3JlYXRlUHJvamVjdHNMaXN0IiwiZGVmYXVsdEJ1dHRvbiIsImNyZWF0ZURpdiIsImRlZmF1bHRDb250YWluZXIiLCJjcmVhdGVQcm9qZWN0Q29udGFpbmVyIiwicHJvamVjdENsYXNzTmFtZSIsInJlcGxhY2UiLCJwcm9qZWN0Q29udGFpbmVyIiwicHJvamVjdEhlYWRpbmciLCJ0b2RvTGlzdCIsImxvYWRUb2RvcyIsImRpdiIsInByb2plY3RPYmplY3QiLCJzZWFyY2hQcm9qZWN0IiwidG9kb3MiLCJjcmVhdGVUb2RvcyIsImxpVG9kb3MiLCJ0b2RvIiwiY3JlYXRlVG9kbyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJmb290ZXIiLCJsb2FkUHJvamVjdCIsImZvcm1EYXRhIiwicmVwbGFjZVByb2plY3RDb250YWluZXIiLCJyZW1vdmVQcm9qZWN0Q29udGFpbmVyIiwiZ2V0Q3VycmVudFByb2plY3RDb250YWluZXIiLCJuZXdQcm9qZWN0Q29udGFpbmVyIiwiZ2V0Q3VycmVudFByb2plY3ROYW1lIiwic3BsaXQiLCJkZWxldGVCdXR0b24iLCJ0b2RvSW5mbyIsImNyZWF0ZVBhcmFncmFwaCIsInBhcmFncmFwaCIsImxvYWRUb2RvIiwib2J0YWluVG9kb1RpdGxlIiwibGlFbGVtZW50IiwidG9kb1RpdGxlIiwidXBkYXRlVG9kbyIsInRvZG9FbGVtZW50IiwidG9kb0RhdGEiLCJwIiwiZ2V0QXR0cmlidXRlRnJvbSIsIkV2ZW50TGlzdGVuZXJBZ3JlZ2F0b3IiLCJhZGROYXZiYXJMaXN0ZW5lciIsImhhbmRsZUZ1bmN0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiYWRkRm9ybUxpc3RlbmVyIiwidmFsaWRhdGVGdW5jdGlvbiIsImFkZEVsZW1lbnRMaXN0ZW5lciIsIlByb2plY3QiLCJhZGRUb2RvIiwiX25hbWUiLCJfdG9kb3MiLCJzZWFyY2hUb2RvIiwiZmluZCIsInJlbW92ZVRvZG8iLCJ0b2RvT2JqZWN0IiwidG9kb0luZGV4IiwiZ2V0VG9kb0luZGV4IiwiZmluZEluZGV4IiwiSlNPTiIsInN0cmluZ2lmeSIsIlByb2plY3RNYW5hZ2VyIiwicHJvamVjdExpc3QiLCJhZGRQcm9qZWN0IiwiaGFuZGxlUHJvamVjdENyZWF0aW9uIiwicHJldmVudERlZmF1bHQiLCJnYXRoZXJQcm9qZWN0Rm9ybURhdGEiLCJ2YWxpZGF0ZVByb2plY3RGb3JtIiwiZGlzcGxheUVycm9yTW9kYWwiLCJjcmVhdGVQcm9qZWN0IiwiZGNvIiwiY29uc29sZSIsImxvZyIsImZvcm1EYXRhTG93ZXJjYXNlIiwidG9Mb3dlckNhc2UiLCJwcm9qZWN0IiwicHJvamVjdE5hbWVDb2luY2lkZXMiLCJfcHJvamVjdExpc3QiLCJUb2RvIiwiZHVlRGF0ZSIsInByaW9yaXR5IiwiVG9kb01hbmFnZXIiLCJ2YWxpZGF0ZVRvZG9Gb3JtIiwiZ2F0aGVyVG9kb0Zvcm1EYXRhIiwidmFsaWRhdGVGb3JtRGF0YSIsImFkZFRvZG9Ub1Byb2plY3QiLCJPYmplY3QiLCJzb21lIiwicG0iLCJuZXdUb2RvIiwibXlEQ08iLCJteUVMQSIsIm15UE0iLCJteVRNIiwiY3JlYXRlRkMiLCJoYW5kbGVOYXZiYXJCdXR0b25zIiwiZ2V0TmF2QmFyQXJndW1lbnRzIiwiaGFuZGxlUHJvamVjdEJ1dHRvbnMiLCJhZGRUb2RvTGlzdExpc3RlbmVyIiwibXlGQyIsImZvcm1OYW1lIiwidGFyZ2V0IiwiZm9ybUZ1bmN0aW9ucyIsInNlbGVjdEZvcm1GdW5jdGlvbnMiLCJmdW5jdGlvbnMiLCJmb3JtRnVuY3Rpb24iLCJ2YWxpZGF0ZUZ1bmN0aW9ucyIsImdldFZhbGlkYXRlRnVuY3Rpb25zIiwiaGFuZGxlRm9ybUJ1dHRvbnMiLCJsaXN0ZW5lckZ1bmN0aW9uIiwiYnV0dG9uVHlwZSIsImhhbmRsZVRvZG9zTGkiLCJub2RlTmFtZSIsImdldFByb2plY3RPYmplY3QiLCJoYW5kbGVUb2RvIiwicGFyZW50RWxlbWVudCIsImdldFRvZG9PYmplY3QiLCJ0b2RvQ2hpbGRyZW4iLCJjaGlsZHJlbiIsImV4cGFuZFRvZG8iLCJjb2xsYXBzZVRvZG8iLCJ0b2RvUmVtYWluaW5nRGF0YSIsImxhc3RQYXJhZ3JhcGgiLCJsYXN0Q2hpbGQiXSwic291cmNlUm9vdCI6IiJ9