(()=>{"use strict";class t{createToDoForm=t=>{const e=this.createForm(),r=this.createLabels(["*Title:","*Description:","*Due Date:","*Priority:"]),o=this.createToDoInputs(["todo-title","todo-description"]);let n=this.joinLists(this.appendInputsToLabels(r,o),this.appendButtons(t,"to-do"));return this.appendElementsToForm(e,n)};createForm(){let t=document.createElement("form");return this.assignAttribute(t,"method","post"),t}assignAttribute(t,e,r=""){t.setAttribute(e,r)}createLabels(t){let e=[];for(const r of t)e.push(this.createLabel(r));return e}createLabel(t){const e=document.createElement("label");return e.textContent=t,e}createToDoInputs(t){const e=this.createTextInputs(t),r=this.createDistinctInputs();return this.joinLists(e,r)}createTextInputs(t){let e=[];for(const r of t)e.push(this.createInput(r));return e}createInput(t,e=""){const r=document.createElement("input");let o=["name","required"],n=[t,""];return e&&(o.push("type"),n.push(e)),this.assignAttributes(r,o,n),r}assignAttributes(t,e,r){for(let o=0;o<e.length;o++)this.assignAttribute(t,e[o],r[o])}createDistinctInputs(){return[this.createDatetimeLocalInput("todo-dueDate"),this.createNumberInput("todo-priority")]}createDatetimeLocalInput(t){const e=this.createInput(t,"datetime-local");return this.assignAttribute(e,"value",this.getCurrentDate()),e}getCurrentDate(){return(new Date).toJSON().slice(0,19)}createNumberInput(t){const e=this.createInput(t,"number");return this.assignAttributes(e,["min","max","placeholder"],["1","3","1"]),e}appendInputsToLabels(t,e){let r=this.deepCloneNodes(t);const o=this.deepCloneNodes(e);for(let e=0;e<t.length;e++)r[e].appendChild(o[e]);return r}joinLists(t,e){return t.concat(e)}deepCloneNodes(t){let e=[];for(const r of t)e.push(r.cloneNode(!0));return e}appendButtons(t,e){return[t,this.createSubmitButton(e)]}createSubmitButton(t){const e=document.createElement("input");let r=["submit",`Create ${t}`];return this.assignAttributes(e,["type","value"],r),e}appendElementsToForm(t,e){const r=this.deepCloneNodes(e);for(const e of r)t.appendChild(e);return t}createProjectForm=t=>{const e=this.createForm(),r=this.createLabels(["*Name:"]),o=this.createTextInputs(["project-name"]);let n=this.joinLists(this.appendInputsToLabels(r,o),this.appendButtons(t,"project"));return this.appendElementsToForm(e,n)}}class e{constructor(e=t){this.script=document.querySelector("script"),this.formCreator=new e}loadPage(){this.createHeader(),this.createSidebar(),this.createMain(),this.createFooter()}createHeader(){let t=document.createElement("header"),e=document.createElement("nav"),r=this.createNavbar();t.appendChild(e),e.appendChild(r),this.script.parentNode.insertBefore(t,this.script)}createNavbar(){let t=this.createUl("navbar"),e=[this.createButton("New to-do",{className:"new-to-do"}),this.createButton("New project",{className:"new-project"})];return this.appendListElements(t,e),t}createUl(t=""){const e=document.createElement("ul");return t&&e.classList.add(t),e}appendListElements(t,e){for(let r of e)t.appendChild(r)}loadForm=t=>{if(null===document.querySelector("form")){let e=document.querySelector("main");const r=t(this.createButton("Cancel",{type:"button"}));e.appendChild(r)}};createButton(t,e={}){let r=document.createElement("button");return r.textContent=t,e.type&&r.setAttribute("type",e.type),e.className&&r.classList.add(e.className),r}removeForm(){document.querySelector("form").remove()}addProjectToSidebar(t){let e=document.querySelector(".projects-list");const r=this.createHeading(t,"h2");e.appendChild(this.createLi(r))}createHeading(t,e){let r=document.createElement(e);return r.textContent=t,r}createLi(t){let e=document.createElement("li");return e.appendChild(t),e}createSidebar(){let t=document.createElement("nav"),e=[this.createHeading("Projects","h1"),this.createProjectsList()];this.appendListElements(t,e),this.script.parentNode.insertBefore(t,this.script)}createProjectsList(){let t=this.createUl("projects-list");const e=this.createHeading("default","h2");return t.appendChild(this.createLi(e)),t}createMain(){const t=document.createElement("main");let e=this.createDiv("content");const r=this.createProjectContainer("default-container");e.appendChild(r),t.appendChild(e),this.script.parentNode.insertBefore(t,this.script)}createProjectContainer(t){let e=t.replace("-container",""),r=this.createDiv(t),o=this.createHeading(e,"h1"),n=this.createUl("todo-list");return this.appendListElements(r,[o,n]),r}createDiv(t){let e=document.createElement("div");return e.classList.add(t),e}createFooter(){const t=document.createElement("footer");this.script.parentNode.insertBefore(t,this.script)}loadProject(t){this.replaceProjectContainer(`${t}-container`),this.addProjectToSidebar(t),this.removeForm()}removeProjectContainer(){this.getCurrentProjectContainer().remove()}getCurrentProjectContainer(){return document.querySelector(".content > div")}replaceProjectContainer(t){let e=document.querySelector(".content"),r=this.createProjectContainer(t);this.removeProjectContainer(),e.appendChild(r)}getCurrentProjectName(){return this.getCurrentProjectContainer().className.split("-")[0]}createTodo(t,e){let r=this.createButton(""),o=this.createParagraph(`Title: ${t}, Description: ${e}`),n=this.createLi(r);return n.appendChild(o),n}createParagraph(t){let e=document.createElement("p");return e.textContent=t,e}loadTodo(t){this.getCurrentProjectContainer().appendChild(t)}}class r{addNavbarListener(t){document.querySelector(".navbar").addEventListener("click",(e=>this.handleNavbarButtons(e,t)))}handleNavbarButtons=(t,e)=>{let r=this.obtainDCO(e),o=e.validateFunctions,n=this.getAttributeFrom(t.target,"className"),a=this.getFormFunction(this.getFormCreator(r),n);"new-to-do"===n&&(r.loadForm(a),this.addFormListener(o[0],e)),"new-project"===n&&(r.loadForm(a),this.addFormListener(o[1],e))};obtainDCO(t){return t.dco}getAttributeFrom(t,e){return t[e]}getFormFunction(t,e){return"new-to-do"===e?t.createToDoForm:"new-project"===e?t.createProjectForm:void 0}getFormCreator(t){return t.formCreator}addFormListener(t,e){document.querySelector("form").addEventListener("click",(r=>this.handleFormButtons(r,t,e)))}handleFormButtons=(t,e,r)=>{let o=this.obtainDCO(r),n=this.getAttributeFrom(t.target,"type");"button"===n&&o.removeForm(),"submit"===n&&e(t,r)}}class o{constructor(t){this.name=t,this.todos=[]}addTodo(t){this.todos.push(t)}get name(){return this._name}set name(t){this._name=t}get todos(){return this._todos}set todos(t){this._todos=t}removeTodo(){}}class n{constructor(t=o){this.projectList=[],this.addProject(new t("default"))}addProject(t){this.projectList.push(t)}validateProjectForm=(t,e,r=o)=>{let n=e.dco;const a=this.gatherProjectFormData(t);if(""===a)return void console.log("Couldn't create Project");const s=a.toLowerCase();let i=new r(s);this.addProject(i),n.loadProject(s)};gatherProjectFormData(t){return t.preventDefault(),document.querySelector("[name='project-name']").value}projectNameCoincides(t,e){return t.name===e}searchProject(t){return this.projectList.find((e=>this.projectNameCoincides(e,t)))}get projectList(){return this._projectList}set projectList(t){this._projectList=t}}class a{constructor(t){this.title=t.title,this.description=t.description,this.dueDate=t.dueDate,this.priority=t.priority}}class s{validateTodoForm=(t,e)=>{const r=this.gatherTodoFormData(t);r.includes("")?console.log("Couldn't create To-do"):this.addTodoToProject(r,e)};createTodo(t){return new a({title:t[0],description:t[1],dueDate:t[2],priority:t[3]})}addTodoToProject(t,e){let r=e.pm,o=e.dco,n=this.createTodo(t),a=o.getCurrentProjectName();r.searchProject(a).addTodo(n),o.loadTodo(o.createTodo(n.title,n.description)),o.removeForm()}gatherTodoFormData=t=>(t.preventDefault(),[document.querySelector("[name='todo-title']").value,document.querySelector("[name='todo-description']").value,document.querySelector("[name='todo-dueDate']").value,document.querySelector("[name='todo-priority']").value])}(new class{constructor(){this.myDCO=new e,this.myELA=new r,this.myPM=new n,this.myTM=new s}loadPage(){this.myDCO.loadPage(),this.myELA.addNavbarListener({dco:this.myDCO,pm:this.myPM,validateFunctions:this.getValidateFunctions()})}getValidateFunctions(){return[this.myTM.validateTodoForm,this.myPM.validateProjectForm]}}).loadPage()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFLdkksS0FBS29MLE1BQ1ZGLEdBQUlsTCxLQUFLc0wsS0FDVDdDLGtCQUFtQnpJLEtBQUt3TCx3QkFDN0IsQ0FFQUEsdUJBRUUsTUFEZ0IsQ0FBQ3hMLEtBQUt1TCxLQUFLVCxpQkFBa0I5SyxLQUFLc0wsS0FBS3ZCLG9CQUV6RCxJRHJCZTdGLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvZm9ybS1jcmVhdG9yLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9kb20tY3JlYXRvci5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvZXZlbnQtbGlzdGVuZXItYWdyZWdhdG9yLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9wcm9qZWN0LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9wcm9qZWN0LW1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3RvZG8uanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3RvZG8tbWFuYWdlci5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3BhZ2UtY29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtQ3JlYXRvciB7XG4gIGNyZWF0ZVRvRG9Gb3JtID0gKGJ1dHRvbikgPT4ge1xuICAgIGNvbnN0IGZvcm0gPSB0aGlzLmNyZWF0ZUZvcm0oKTtcbiAgICBjb25zdCBsYWJlbENvbnRlbnRzID0gWycqVGl0bGU6JywgJypEZXNjcmlwdGlvbjonLCAnKkR1ZSBEYXRlOicsICcqUHJpb3JpdHk6J107XG4gICAgY29uc3QgdGV4dElucHV0TmFtZXMgPSBbJ3RvZG8tdGl0bGUnLCAndG9kby1kZXNjcmlwdGlvbiddO1xuICAgIGNvbnN0IGxhYmVscyA9IHRoaXMuY3JlYXRlTGFiZWxzKGxhYmVsQ29udGVudHMpO1xuICAgIGNvbnN0IGlucHV0cyA9IHRoaXMuY3JlYXRlVG9Eb0lucHV0cyh0ZXh0SW5wdXROYW1lcyk7XG4gICAgbGV0IGVsZW1lbnRzID0gdGhpcy5qb2luTGlzdHMoXG4gICAgICB0aGlzLmFwcGVuZElucHV0c1RvTGFiZWxzKGxhYmVscywgaW5wdXRzKSxcbiAgICAgIHRoaXMuYXBwZW5kQnV0dG9ucyhidXR0b24sICd0by1kbycpKTtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmRFbGVtZW50c1RvRm9ybShmb3JtLCBlbGVtZW50cyk7XG4gIH1cblxuICBjcmVhdGVGb3JtKCkge1xuICAgIGxldCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpO1xuICAgIHRoaXMuYXNzaWduQXR0cmlidXRlKGZvcm0sICdtZXRob2QnLCAncG9zdCcpO1xuICAgIHJldHVybiBmb3JtO1xuICB9XG5cbiAgYXNzaWduQXR0cmlidXRlKGVsZW1lbnQgLGF0dHJpYnV0ZSwgdmFsdWU9JycpIHtcbiAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgfVxuXG4gIGNyZWF0ZUxhYmVscyhsYWJlbENvbnRlbnRzKSB7XG4gICAgbGV0IGxhYmVscyA9IFtdO1xuICAgIGZvciAoY29uc3QgY29udGVudCBvZiBsYWJlbENvbnRlbnRzKVxuICAgICAgbGFiZWxzLnB1c2godGhpcy5jcmVhdGVMYWJlbChjb250ZW50KSk7XG4gICAgcmV0dXJuIGxhYmVscztcbiAgfVxuXG4gIGNyZWF0ZUxhYmVsKGNvbnRlbnQpIHtcbiAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gICAgbGFiZWwudGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgIHJldHVybiBsYWJlbDtcbiAgfVxuXG4gIGNyZWF0ZVRvRG9JbnB1dHModGV4dElucHV0TmFtZXMpIHtcbiAgICBjb25zdCB0ZXh0SW5wdXRzID0gdGhpcy5jcmVhdGVUZXh0SW5wdXRzKHRleHRJbnB1dE5hbWVzKTtcbiAgICBjb25zdCBkaXN0aW5jdElucHV0cyA9IHRoaXMuY3JlYXRlRGlzdGluY3RJbnB1dHMoKTtcbiAgICByZXR1cm4gdGhpcy5qb2luTGlzdHModGV4dElucHV0cywgZGlzdGluY3RJbnB1dHMpO1xuICB9XG5cbiAgY3JlYXRlVGV4dElucHV0cyhpbnB1dE5hbWVzKSB7XG4gICAgbGV0IGlucHV0cyA9IFtdO1xuICAgIGZvciAoY29uc3QgbmFtZSBvZiBpbnB1dE5hbWVzKVxuICAgICAgaW5wdXRzLnB1c2godGhpcy5jcmVhdGVJbnB1dChuYW1lKSk7XG4gICAgcmV0dXJuIGlucHV0cztcbiAgfVxuXG4gIGNyZWF0ZUlucHV0KG5hbWUsIHR5cGU9JycpIHtcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgbGV0IGF0dHJpYnV0ZXMgPSBbJ25hbWUnLCAncmVxdWlyZWQnXTtcbiAgICBsZXQgdmFsdWVzID0gW25hbWUsICcnXTtcbiAgICBpZiAodHlwZSkge1xuICAgICAgYXR0cmlidXRlcy5wdXNoKCd0eXBlJyk7XG4gICAgICB2YWx1ZXMucHVzaCh0eXBlKTtcbiAgICB9XG4gICAgdGhpcy5hc3NpZ25BdHRyaWJ1dGVzKGlucHV0LCBhdHRyaWJ1dGVzLCB2YWx1ZXMpO1xuICAgIHJldHVybiBpbnB1dDtcbiAgfVxuXG4gIGFzc2lnbkF0dHJpYnV0ZXMoZWxlbWVudCwgYXR0cmlidXRlcywgdmFsdWVzKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKVxuICAgICAgdGhpcy5hc3NpZ25BdHRyaWJ1dGUoZWxlbWVudCwgYXR0cmlidXRlc1tpXSwgdmFsdWVzW2ldKTtcbiAgfVxuXG4gIGNyZWF0ZURpc3RpbmN0SW5wdXRzKCkge1xuICAgIC8vIFRoZXNlIGlucHV0cyBhcmUgdXNlZCBpbiB0aGUgdG8tZG8gZm9ybVxuICAgIGNvbnN0IGRhdGVQaWNrZXIgPSB0aGlzLmNyZWF0ZURhdGV0aW1lTG9jYWxJbnB1dCgndG9kby1kdWVEYXRlJyk7XG4gICAgY29uc3QgbnVtYmVySW5wdXQgPSB0aGlzLmNyZWF0ZU51bWJlcklucHV0KCd0b2RvLXByaW9yaXR5Jyk7XG4gICAgcmV0dXJuIFtkYXRlUGlja2VyLCBudW1iZXJJbnB1dF07XG4gIH1cblxuICBjcmVhdGVEYXRldGltZUxvY2FsSW5wdXQobmFtZSkge1xuICAgIGNvbnN0IGlucHV0ID0gdGhpcy5jcmVhdGVJbnB1dChuYW1lLCAnZGF0ZXRpbWUtbG9jYWwnKTtcbiAgICB0aGlzLmFzc2lnbkF0dHJpYnV0ZShpbnB1dCwgJ3ZhbHVlJywgdGhpcy5nZXRDdXJyZW50RGF0ZSgpKTtcbiAgICByZXR1cm4gaW5wdXQ7XG4gIH1cblxuICBnZXRDdXJyZW50RGF0ZSgpIHtcbiAgICAvLyBSZXR1cm5zIGluIHRoZSBmb3JtYXQgeXl5eS1NTS1ERC1UaGg6bW1cbiAgICByZXR1cm4gbmV3IERhdGUoKS50b0pTT04oKS5zbGljZSgwLDE5KTtcbiAgfVxuXG4gIGNyZWF0ZU51bWJlcklucHV0KG5hbWUpIHtcbiAgICAvLyBGb3IgdGhlIG1vbWVudCBpdCdzIG9ubHkgdXNlZCBmb3IgYSBwcmlvcml0eSBpbnB1dFxuICAgIGNvbnN0IGlucHV0ID0gdGhpcy5jcmVhdGVJbnB1dChuYW1lLCAnbnVtYmVyJyk7XG4gICAgbGV0IG1pblZhbHVlID0gJzEnO1xuICAgIGxldCBtYXhWYWx1ZSA9ICczJztcbiAgICBsZXQgYXR0cmlidXRlcyA9IFsnbWluJywgJ21heCcsICdwbGFjZWhvbGRlciddO1xuICAgIGxldCB2YWx1ZXMgPSBbbWluVmFsdWUsIG1heFZhbHVlLCBtaW5WYWx1ZV07XG4gICAgdGhpcy5hc3NpZ25BdHRyaWJ1dGVzKGlucHV0LCBhdHRyaWJ1dGVzLCB2YWx1ZXMpO1xuICAgIHJldHVybiBpbnB1dDtcbiAgfVxuXG4gIGFwcGVuZElucHV0c1RvTGFiZWxzKGxhYmVscywgaW5wdXRzKSB7XG4gICAgbGV0IGxhYmVsc0RlZXBDb3B5ID0gdGhpcy5kZWVwQ2xvbmVOb2RlcyhsYWJlbHMpO1xuICAgIGNvbnN0IGlucHV0c0RlZXBDb3B5ID0gdGhpcy5kZWVwQ2xvbmVOb2RlcyhpbnB1dHMpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGFiZWxzLmxlbmd0aDsgaSsrKVxuICAgICAgbGFiZWxzRGVlcENvcHlbaV0uYXBwZW5kQ2hpbGQoaW5wdXRzRGVlcENvcHlbaV0pO1xuICAgIHJldHVybiBsYWJlbHNEZWVwQ29weTtcbiAgfVxuXG4gIGpvaW5MaXN0cyhmaXJzdExpc3QsIHNlY29uZExpc3QpIHtcbiAgICByZXR1cm4gZmlyc3RMaXN0LmNvbmNhdChzZWNvbmRMaXN0KTtcbiAgfVxuXG4gIGRlZXBDbG9uZU5vZGVzKG5vZGVzKSB7XG4gICAgbGV0IGRlZXBDbG9uZWROb2RlcyA9IFtdO1xuICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2RlcylcbiAgICAgIGRlZXBDbG9uZWROb2Rlcy5wdXNoKG5vZGUuY2xvbmVOb2RlKHRydWUpKTtcbiAgICByZXR1cm4gZGVlcENsb25lZE5vZGVzO1xuICB9XG5cbiAgYXBwZW5kQnV0dG9ucyhidXR0b24sIHZhbHVlKSB7XG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gdGhpcy5jcmVhdGVTdWJtaXRCdXR0b24odmFsdWUpO1xuICAgIHJldHVybiBbYnV0dG9uLCBzdWJtaXRCdXR0b25dO1xuICB9XG5cbiAgY3JlYXRlU3VibWl0QnV0dG9uKHZhbHVlKSB7XG4gICAgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICBsZXQgYXR0cmlidXRlcyA9IFsndHlwZScsICd2YWx1ZSddO1xuICAgIGxldCB2YWx1ZXMgPSBbJ3N1Ym1pdCcsIGBDcmVhdGUgJHt2YWx1ZX1gXTtcbiAgICB0aGlzLmFzc2lnbkF0dHJpYnV0ZXMoc3VibWl0QnV0dG9uLCBhdHRyaWJ1dGVzLCB2YWx1ZXMpO1xuICAgIHJldHVybiBzdWJtaXRCdXR0b247XG4gIH1cblxuICBhcHBlbmRFbGVtZW50c1RvRm9ybShmb3JtLCBlbGVtZW50cykge1xuICAgIGNvbnN0IGVsZW1lbnRzRGVlcENvcHkgPSB0aGlzLmRlZXBDbG9uZU5vZGVzKGVsZW1lbnRzKTtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudHNEZWVwQ29weSlcbiAgICAgIGZvcm0uYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gICAgcmV0dXJuIGZvcm07XG4gIH1cblxuICBjcmVhdGVQcm9qZWN0Rm9ybSA9IChidXR0b24pID0+IHtcbiAgICBjb25zdCBmb3JtID0gdGhpcy5jcmVhdGVGb3JtKCk7XG4gICAgY29uc3QgbGFiZWwgPSB0aGlzLmNyZWF0ZUxhYmVscyhbJypOYW1lOiddKTtcbiAgICBjb25zdCBpbnB1dCA9IHRoaXMuY3JlYXRlVGV4dElucHV0cyhbJ3Byb2plY3QtbmFtZSddKTtcbiAgICBsZXQgZWxlbWVudHMgPSB0aGlzLmpvaW5MaXN0cyhcbiAgICAgIHRoaXMuYXBwZW5kSW5wdXRzVG9MYWJlbHMobGFiZWwsIGlucHV0KSxcbiAgICAgIHRoaXMuYXBwZW5kQnV0dG9ucyhidXR0b24sICdwcm9qZWN0JykpO1xuICAgIHJldHVybiB0aGlzLmFwcGVuZEVsZW1lbnRzVG9Gb3JtKGZvcm0sIGVsZW1lbnRzKTtcbiAgfVxufVxuIiwiaW1wb3J0IEZvcm1DcmVhdG9yIGZyb20gXCIuL2Zvcm0tY3JlYXRvci5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBET01DcmVhdG9yIHtcbiAgY29uc3RydWN0b3IoZm9ybUNyZWF0b3JPYmplY3Q9Rm9ybUNyZWF0b3IpIHtcbiAgICB0aGlzLnNjcmlwdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3NjcmlwdCcpO1xuICAgIHRoaXMuZm9ybUNyZWF0b3IgPSBuZXcgZm9ybUNyZWF0b3JPYmplY3QoKTtcbiAgfVxuXG4gIGxvYWRQYWdlKCkge1xuICAgIHRoaXMuY3JlYXRlSGVhZGVyKCk7XG4gICAgdGhpcy5jcmVhdGVTaWRlYmFyKCk7XG4gICAgdGhpcy5jcmVhdGVNYWluKCk7XG4gICAgdGhpcy5jcmVhdGVGb290ZXIoKTtcbiAgfVxuXG4gIGNyZWF0ZUhlYWRlcigpIHtcbiAgICBsZXQgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaGVhZGVyJyk7XG4gICAgbGV0IG5hdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ25hdicpO1xuICAgIGxldCBuYXZiYXIgPSB0aGlzLmNyZWF0ZU5hdmJhcigpO1xuICAgIGhlYWRlci5hcHBlbmRDaGlsZChuYXYpO1xuICAgIG5hdi5hcHBlbmRDaGlsZChuYXZiYXIpO1xuICAgIHRoaXMuc2NyaXB0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGhlYWRlciwgdGhpcy5zY3JpcHQpO1xuICB9XG5cbiAgY3JlYXRlTmF2YmFyKCkge1xuICAgIC8vIENvbnNpZGVyIGFkZGluZyBtb3JlIGVsZW1lbnRzXG4gICAgbGV0IHVsID0gdGhpcy5jcmVhdGVVbCgnbmF2YmFyJyk7XG4gICAgbGV0IHRvZG9CdXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbignTmV3IHRvLWRvJywge2NsYXNzTmFtZTogJ25ldy10by1kbyd9KTtcbiAgICBsZXQgcHJvamVjdEJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKCdOZXcgcHJvamVjdCcsXG4gICAgICB7Y2xhc3NOYW1lOiAnbmV3LXByb2plY3QnfSk7XG4gICAgbGV0IGxpc3RFbGVtZW50cyA9IFt0b2RvQnV0dG9uLCBwcm9qZWN0QnV0dG9uXTtcbiAgICB0aGlzLmFwcGVuZExpc3RFbGVtZW50cyh1bCwgbGlzdEVsZW1lbnRzKTtcbiAgICByZXR1cm4gdWw7XG4gIH1cblxuICBjcmVhdGVVbChjbGFzc05hbWU9JycpIHtcbiAgICBjb25zdCB1bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgaWYgKGNsYXNzTmFtZSlcbiAgICAgIHVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICByZXR1cm4gdWw7XG4gIH1cblxuICBhcHBlbmRMaXN0RWxlbWVudHMobGlzdCwgZWxlbWVudHMpIHtcbiAgICBmb3IgKGxldCBlbGVtZW50IG9mIGVsZW1lbnRzKVxuICAgICAgbGlzdC5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgfVxuXG4gIGxvYWRGb3JtID0gKGNyZWF0ZUZvcm1GdW5jdGlvbikgPT4ge1xuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtJykgPT09IG51bGwpIHtcbiAgICAgIGxldCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWFpbicpO1xuICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gdGhpcy5jcmVhdGVCdXR0b24oJ0NhbmNlbCcsIHt0eXBlOiAnYnV0dG9uJ30pO1xuICAgICAgY29uc3QgZm9ybSA9IGNyZWF0ZUZvcm1GdW5jdGlvbihjYW5jZWxCdXR0b24pO1xuICAgICAgbWFpbi5hcHBlbmRDaGlsZChmb3JtKTtcbiAgICB9XG4gIH1cblxuICBjcmVhdGVCdXR0b24oY29udGVudCwgYXJncz17fSkge1xuICAgIGxldCBuZXdCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBuZXdCdXR0b24udGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgIGlmIChhcmdzWyd0eXBlJ10pXG4gICAgICBuZXdCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgYXJnc1sndHlwZSddKTtcbiAgICBpZiAoYXJnc1snY2xhc3NOYW1lJ10pXG4gICAgICBuZXdCdXR0b24uY2xhc3NMaXN0LmFkZChhcmdzWydjbGFzc05hbWUnXSk7XG4gICAgcmV0dXJuIG5ld0J1dHRvbjtcbiAgfVxuXG4gIHJlbW92ZUZvcm0oKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKTtcbiAgICBmb3JtLnJlbW92ZSgpO1xuICB9XG5cbiAgYWRkUHJvamVjdFRvU2lkZWJhcihwcm9qZWN0TmFtZSkge1xuICAgIGxldCBwcm9qZWN0c0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMtbGlzdCcpO1xuICAgIGNvbnN0IG5ld1Byb2plY3QgPSB0aGlzLmNyZWF0ZUhlYWRpbmcocHJvamVjdE5hbWUsICdoMicpO1xuICAgIHByb2plY3RzTGlzdC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUxpKG5ld1Byb2plY3QpKTtcbiAgfVxuXG4gIGNyZWF0ZUhlYWRpbmcoY29udGVudCwgaGVhZGluZykge1xuICAgIGxldCBoZWFkaW5nRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaGVhZGluZyk7XG4gICAgaGVhZGluZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgIHJldHVybiBoZWFkaW5nRWxlbWVudDtcbiAgfVxuXG4gIGNyZWF0ZUxpKGVsZW1lbnQpIHtcbiAgICBsZXQgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgIGxpLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIHJldHVybiBsaTtcbiAgfVxuXG4gIGNyZWF0ZVNpZGViYXIoKSB7XG4gICAgbGV0IG5hdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ25hdicpO1xuICAgIGNvbnN0IHByb2plY3RzSDEgPSB0aGlzLmNyZWF0ZUhlYWRpbmcoJ1Byb2plY3RzJywgJ2gxJyk7XG4gICAgbGV0IHByb2plY3RzTGlzdCA9IHRoaXMuY3JlYXRlUHJvamVjdHNMaXN0KCk7XG4gICAgbGV0IGxpc3RFbGVtZW50cyA9IFtwcm9qZWN0c0gxLCBwcm9qZWN0c0xpc3RdO1xuICAgIHRoaXMuYXBwZW5kTGlzdEVsZW1lbnRzKG5hdiwgbGlzdEVsZW1lbnRzKTtcbiAgICB0aGlzLnNjcmlwdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShuYXYsIHRoaXMuc2NyaXB0KTtcbiAgfVxuXG4gIGNyZWF0ZVByb2plY3RzTGlzdCgpIHtcbiAgICBsZXQgcHJvamVjdHNMaXN0ID0gdGhpcy5jcmVhdGVVbCgncHJvamVjdHMtbGlzdCcpO1xuICAgIGNvbnN0IGRlZmF1bHRIMiA9IHRoaXMuY3JlYXRlSGVhZGluZygnZGVmYXVsdCcsICdoMicpO1xuICAgIHByb2plY3RzTGlzdC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUxpKGRlZmF1bHRIMikpO1xuICAgIHJldHVybiBwcm9qZWN0c0xpc3Q7XG4gIH1cblxuICBjcmVhdGVNYWluKCkge1xuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdtYWluJyk7XG4gICAgbGV0IGNvbnRlbnQgPSB0aGlzLmNyZWF0ZURpdignY29udGVudCcpO1xuICAgIGNvbnN0IGRlZmF1bHRDb250YWluZXIgPSB0aGlzLmNyZWF0ZVByb2plY3RDb250YWluZXIoJ2RlZmF1bHQtY29udGFpbmVyJylcbiAgICBjb250ZW50LmFwcGVuZENoaWxkKGRlZmF1bHRDb250YWluZXIpO1xuICAgIG1haW4uYXBwZW5kQ2hpbGQoY29udGVudCk7XG4gICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobWFpbiwgdGhpcy5zY3JpcHQpO1xuICB9XG5cbiAgY3JlYXRlUHJvamVjdENvbnRhaW5lcihwcm9qZWN0Q2xhc3NOYW1lKSB7XG4gICAgLy8gQ29uc2lkZXIgYSBtZXRob2QgaW4gYW5vdGhlciBtb2R1bGUgdG8gY2hhbmdlIHRoaXMgbGluZVxuICAgIGxldCBwcm9qZWN0TmFtZSA9IHByb2plY3RDbGFzc05hbWUucmVwbGFjZSgnLWNvbnRhaW5lcicsICcnKTtcbiAgICBsZXQgcHJvamVjdENvbnRhaW5lciA9IHRoaXMuY3JlYXRlRGl2KHByb2plY3RDbGFzc05hbWUpO1xuICAgIGxldCBwcm9qZWN0SGVhZGluZyA9IHRoaXMuY3JlYXRlSGVhZGluZyhwcm9qZWN0TmFtZSwgJ2gxJyk7XG4gICAgbGV0IHRvZG9MaXN0ID0gdGhpcy5jcmVhdGVVbCgndG9kby1saXN0Jyk7XG4gICAgdGhpcy5hcHBlbmRMaXN0RWxlbWVudHMocHJvamVjdENvbnRhaW5lciwgW3Byb2plY3RIZWFkaW5nLCB0b2RvTGlzdF0pO1xuICAgIHJldHVybiBwcm9qZWN0Q29udGFpbmVyO1xuICB9XG5cbiAgY3JlYXRlRGl2KGNsYXNzTmFtZSkge1xuICAgIGxldCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXYuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICAgIHJldHVybiBkaXY7XG4gIH1cblxuICBjcmVhdGVGb290ZXIoKSB7XG4gICAgY29uc3QgZm9vdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9vdGVyJyk7XG4gICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZm9vdGVyLCB0aGlzLnNjcmlwdCk7XG4gIH1cblxuICBsb2FkUHJvamVjdChmb3JtRGF0YSkge1xuICAgIHRoaXMucmVwbGFjZVByb2plY3RDb250YWluZXIoYCR7Zm9ybURhdGF9LWNvbnRhaW5lcmApO1xuICAgIHRoaXMuYWRkUHJvamVjdFRvU2lkZWJhcihmb3JtRGF0YSk7XG4gICAgdGhpcy5yZW1vdmVGb3JtKCk7XG4gIH1cblxuICByZW1vdmVQcm9qZWN0Q29udGFpbmVyKCkge1xuICAgIGNvbnN0IHByb2plY3RDb250YWluZXIgPSB0aGlzLmdldEN1cnJlbnRQcm9qZWN0Q29udGFpbmVyKCk7XG4gICAgcHJvamVjdENvbnRhaW5lci5yZW1vdmUoKTtcbiAgfVxuXG4gIGdldEN1cnJlbnRQcm9qZWN0Q29udGFpbmVyKCkge1xuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCA+IGRpdicpO1xuICB9XG5cbiAgcmVwbGFjZVByb2plY3RDb250YWluZXIocHJvamVjdENsYXNzTmFtZSkge1xuICAgIGxldCBjb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKTtcbiAgICBsZXQgbmV3UHJvamVjdENvbnRhaW5lciA9IHRoaXMuY3JlYXRlUHJvamVjdENvbnRhaW5lcihwcm9qZWN0Q2xhc3NOYW1lKTtcbiAgICB0aGlzLnJlbW92ZVByb2plY3RDb250YWluZXIoKTtcbiAgICBjb250ZW50LmFwcGVuZENoaWxkKG5ld1Byb2plY3RDb250YWluZXIpO1xuICB9XG5cbiAgZ2V0Q3VycmVudFByb2plY3ROYW1lKCkge1xuICAgIGNvbnN0IHByb2plY3RDb250YWluZXIgPSB0aGlzLmdldEN1cnJlbnRQcm9qZWN0Q29udGFpbmVyKCk7XG4gICAgbGV0IHByb2plY3RDbGFzc05hbWUgPSBwcm9qZWN0Q29udGFpbmVyLmNsYXNzTmFtZTtcbiAgICByZXR1cm4gcHJvamVjdENsYXNzTmFtZS5zcGxpdCgnLScpWzBdO1xuICB9XG5cbiAgY3JlYXRlVG9kbyh0aXRsZSwgZGVzY3JpcHRpb24pIHtcbiAgICBsZXQgYnV0dG9uID0gdGhpcy5jcmVhdGVCdXR0b24oJycpO1xuICAgIGxldCB0b2RvSW5mbyA9IHRoaXMuY3JlYXRlUGFyYWdyYXBoKFxuICAgICAgYFRpdGxlOiAke3RpdGxlfSwgRGVzY3JpcHRpb246ICR7ZGVzY3JpcHRpb259YCk7XG4gICAgLy8gTWF5YmUgY2hhbmdlIHRoZSBjcmVhdGUgbGkgdG8gYWNjZXB0IHR3byBvciBtb3JlIGVsZW1lbnRzXG4gICAgbGV0IGxpID0gdGhpcy5jcmVhdGVMaShidXR0b24pO1xuICAgIGxpLmFwcGVuZENoaWxkKHRvZG9JbmZvKTtcbiAgICByZXR1cm4gbGk7XG4gIH1cblxuICBjcmVhdGVQYXJhZ3JhcGgoY29udGVudCkge1xuICAgIGxldCBwYXJhZ3JhcGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgcGFyYWdyYXBoLnRleHRDb250ZW50ID0gY29udGVudDtcbiAgICByZXR1cm4gcGFyYWdyYXBoO1xuICB9XG5cbiAgbG9hZFRvZG8odG9kbykge1xuICAgIGxldCBwcm9qZWN0Q29udGFpbmVyID0gdGhpcy5nZXRDdXJyZW50UHJvamVjdENvbnRhaW5lcigpO1xuICAgIHByb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQodG9kbyk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEV2ZW50TGlzdGVuZXJBZ3JlZ2F0b3Ige1xuICAvLyBkY28gbWVhbnMgRE9NQ3JlYXRvck9iamVjdFxuXG4gIGFkZE5hdmJhckxpc3RlbmVyKGFyZ3MpIHtcbiAgICBsZXQgbmF2YmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmJhcicpO1xuICAgIG5hdmJhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsXG4gICAgICAoZXZlbnQpID0+IHRoaXMuaGFuZGxlTmF2YmFyQnV0dG9ucyhldmVudCwgYXJncykpO1xuICB9XG5cbiAgaGFuZGxlTmF2YmFyQnV0dG9ucyA9IChldmVudCwgYXJncykgPT4ge1xuICAgIGxldCBkY28gPSB0aGlzLm9idGFpbkRDTyhhcmdzKTtcbiAgICBsZXQgdmFsaWRhdGVGdW5jdGlvbnMgPSBhcmdzWyd2YWxpZGF0ZUZ1bmN0aW9ucyddO1xuICAgIGxldCBidXR0b25DbGFzc05hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZUZyb20oZXZlbnQudGFyZ2V0LCAnY2xhc3NOYW1lJyk7XG4gICAgbGV0IGZvcm1GdW5jdGlvbiA9IHRoaXMuZ2V0Rm9ybUZ1bmN0aW9uKFxuICAgICAgdGhpcy5nZXRGb3JtQ3JlYXRvcihkY28pLCBidXR0b25DbGFzc05hbWUpO1xuICAgIGlmIChidXR0b25DbGFzc05hbWUgPT09ICduZXctdG8tZG8nKSB7XG4gICAgICBkY28ubG9hZEZvcm0oZm9ybUZ1bmN0aW9uKTtcbiAgICAgIHRoaXMuYWRkRm9ybUxpc3RlbmVyKHZhbGlkYXRlRnVuY3Rpb25zWzBdLCBhcmdzKTtcbiAgICB9XG4gICAgaWYgKGJ1dHRvbkNsYXNzTmFtZSA9PT0gJ25ldy1wcm9qZWN0Jykge1xuICAgICAgZGNvLmxvYWRGb3JtKGZvcm1GdW5jdGlvbik7XG4gICAgICB0aGlzLmFkZEZvcm1MaXN0ZW5lcih2YWxpZGF0ZUZ1bmN0aW9uc1sxXSwgYXJncyk7XG4gICAgfVxuICB9XG5cbiAgb2J0YWluRENPKGFyZ3MpIHtcbiAgICByZXR1cm4gYXJnc1snZGNvJ107XG4gIH1cblxuICBnZXRBdHRyaWJ1dGVGcm9tKGVsZW1lbnQsIGF0dHJpYnV0ZSkge1xuICAgIHJldHVybiBlbGVtZW50W2F0dHJpYnV0ZV07XG4gIH1cblxuICBnZXRGb3JtRnVuY3Rpb24oZm9ybUNyZWF0b3IsIGZvcm0pIHtcbiAgICBpZiAoZm9ybSA9PT0gJ25ldy10by1kbycpXG4gICAgICByZXR1cm4gZm9ybUNyZWF0b3IuY3JlYXRlVG9Eb0Zvcm07XG4gICAgaWYgKGZvcm0gPT09ICduZXctcHJvamVjdCcpXG4gICAgICByZXR1cm4gZm9ybUNyZWF0b3IuY3JlYXRlUHJvamVjdEZvcm07XG4gIH1cblxuICBnZXRGb3JtQ3JlYXRvcihkY28pIHtcbiAgICByZXR1cm4gZGNvLmZvcm1DcmVhdG9yO1xuICB9XG5cbiAgYWRkRm9ybUxpc3RlbmVyKHZhbGlkYXRlRnVuY3Rpb24sIGFyZ3MpIHtcbiAgICBsZXQgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKTtcbiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxcbiAgICAgIChldmVudCkgPT4gdGhpcy5oYW5kbGVGb3JtQnV0dG9ucyhldmVudCwgdmFsaWRhdGVGdW5jdGlvbiwgYXJncykpO1xuICB9XG5cbiAgaGFuZGxlRm9ybUJ1dHRvbnMgPSAoZXZlbnQsIHZhbGlkYXRlRnVuY3Rpb24sIGFyZ3MpID0+IHtcbiAgICBsZXQgZGNvID0gdGhpcy5vYnRhaW5EQ08oYXJncyk7XG4gICAgbGV0IGJ1dHRvblR5cGUgPSB0aGlzLmdldEF0dHJpYnV0ZUZyb20oZXZlbnQudGFyZ2V0LCAndHlwZScpO1xuICAgIGlmIChidXR0b25UeXBlID09PSAnYnV0dG9uJylcbiAgICAgIGRjby5yZW1vdmVGb3JtKCk7XG4gICAgaWYgKGJ1dHRvblR5cGUgPT09ICdzdWJtaXQnKVxuICAgICAgdmFsaWRhdGVGdW5jdGlvbihldmVudCwgYXJncyk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2plY3QgeyAgXG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMudG9kb3MgPSBbXTtcbiAgfVxuXG4gIGFkZFRvZG8odG9kbykge1xuICAgIHRoaXMudG9kb3MucHVzaCh0b2RvKTtcbiAgfVxuXG4gIGdldCBuYW1lKCkge1xuICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICB9XG5cbiAgc2V0IG5hbWUodmFsdWUpIHtcbiAgICB0aGlzLl9uYW1lID0gdmFsdWU7XG4gIH1cblxuICBnZXQgdG9kb3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RvZG9zO1xuICB9XG5cbiAgc2V0IHRvZG9zKHZhbHVlKSB7XG4gICAgdGhpcy5fdG9kb3MgPSB2YWx1ZTtcbiAgfVxuXG4gIHJlbW92ZVRvZG8oKSB7XG4gICAgLy8gZ2V0IHRoZSBpbmRleCBvZiB0aGUgZWxlbWVudCB0byBiZSByZW1vdmVkIChjcmVhdGUgb3RoZXIgZnVuY3Rpb24gZm9yIGl0KVxuICAgIC8vIHVzZSB0aGUgbmV4dCBsaW5lXG4gICAgLy8gdGhpcy50b2RvcyA9IHRoaXMudG9kb3Muc2xpY2UoMCwgbikuY29uY2F0KHRoaXMudG9kb3Muc2xpY2UobiArIDEpKVxuICB9XG59XG4iLCJpbXBvcnQgUHJvamVjdCBmcm9tICcuL3Byb2plY3QuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9qZWN0TWFuYWdlciB7XG4gIGNvbnN0cnVjdG9yKHByb2plY3RPYmplY3Q9UHJvamVjdCkge1xuICAgIHRoaXMucHJvamVjdExpc3QgPSBbXTtcbiAgICB0aGlzLmFkZFByb2plY3QobmV3IHByb2plY3RPYmplY3QoJ2RlZmF1bHQnKSk7XG4gIH1cblxuICBhZGRQcm9qZWN0KHByb2plY3QpIHtcbiAgICB0aGlzLnByb2plY3RMaXN0LnB1c2gocHJvamVjdCk7XG4gIH1cblxuICB2YWxpZGF0ZVByb2plY3RGb3JtID0gKGV2ZW50LCBhcmdzLCBwcm9qZWN0T2JqZWN0PVByb2plY3QpID0+IHtcbiAgICBsZXQgZGNvID0gYXJnc1snZGNvJ107XG4gICAgY29uc3QgZm9ybURhdGEgPSB0aGlzLmdhdGhlclByb2plY3RGb3JtRGF0YShldmVudCk7XG4gICAgaWYgKGZvcm1EYXRhID09PSAnJykge1xuICAgICAgLy8gQWRkIHNvbWV0aGluZyB0byBub3RpZnkgZXJyb3IgdG8gdXNlciAobWF5YmUgY3JlYXRlIGEgbW9kYWwpXG4gICAgICBjb25zb2xlLmxvZyhcIkNvdWxkbid0IGNyZWF0ZSBQcm9qZWN0XCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBmb3JtRGF0YUxvd2VyY2FzZSA9IGZvcm1EYXRhLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IG5ld1Byb2plY3QgPSBuZXcgcHJvamVjdE9iamVjdChmb3JtRGF0YUxvd2VyY2FzZSk7XG4gICAgdGhpcy5hZGRQcm9qZWN0KG5ld1Byb2plY3QpO1xuICAgIGRjby5sb2FkUHJvamVjdChmb3JtRGF0YUxvd2VyY2FzZSk7XG4gIH1cblxuICBnYXRoZXJQcm9qZWN0Rm9ybURhdGEoZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IHByb2plY3ROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltuYW1lPSdwcm9qZWN0LW5hbWUnXVwiKS52YWx1ZTtcbiAgICByZXR1cm4gcHJvamVjdE5hbWU7XG4gIH1cblxuICBwcm9qZWN0TmFtZUNvaW5jaWRlcyhwcm9qZWN0LCBwcm9qZWN0TmFtZSkge1xuICAgIHJldHVybiBwcm9qZWN0Lm5hbWUgPT09IHByb2plY3ROYW1lO1xuICB9XG5cbiAgc2VhcmNoUHJvamVjdChwcm9qZWN0TmFtZSkge1xuICAgIHJldHVybiB0aGlzLnByb2plY3RMaXN0LmZpbmQocHJvamVjdCA9PlxuICAgICAgdGhpcy5wcm9qZWN0TmFtZUNvaW5jaWRlcyhwcm9qZWN0LCBwcm9qZWN0TmFtZSkpO1xuICB9XG5cbiAgZ2V0IHByb2plY3RMaXN0KCkge1xuICAgIHJldHVybiB0aGlzLl9wcm9qZWN0TGlzdDtcbiAgfVxuXG4gIHNldCBwcm9qZWN0TGlzdCh2YWx1ZSkge1xuICAgIHRoaXMuX3Byb2plY3RMaXN0ID0gdmFsdWU7XG4gIH1cblxuICAvLyBGdW5jdGlvbiB0byByZW1vdmUgcHJvamVjdFxuICAvLyBGdW5jdGlvbiB0byBzZWxlY3QgcHJvamVjdFxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG9kbyB7XG4gIGNvbnN0cnVjdG9yKGFyZ3MpIHtcbiAgICB0aGlzLnRpdGxlID0gYXJnc1sndGl0bGUnXTtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gYXJnc1snZGVzY3JpcHRpb24nXTtcbiAgICB0aGlzLmR1ZURhdGUgPSBhcmdzWydkdWVEYXRlJ107XG4gICAgdGhpcy5wcmlvcml0eSA9IGFyZ3NbJ3ByaW9yaXR5J107XG4gIH1cbn1cbiIsImltcG9ydCBUb2RvIGZyb20gJy4vdG9kby5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvZG9NYW5hZ2VyIHtcbiAgdmFsaWRhdGVUb2RvRm9ybSA9IChldmVudCwgYXJncykgPT4ge1xuICAgIGNvbnN0IGZvcm1EYXRhID0gdGhpcy5nYXRoZXJUb2RvRm9ybURhdGEoZXZlbnQpO1xuICAgIGlmIChmb3JtRGF0YS5pbmNsdWRlcygnJykpIHtcbiAgICAgIC8vIEFkZCBzb21ldGhpbmcgdG8gbm90aWZ5IGVycm9yIHRvIHVzZXIgKG1heWJlIHVzZSBhIG1vZGFsKVxuICAgICAgY29uc29sZS5sb2coXCJDb3VsZG4ndCBjcmVhdGUgVG8tZG9cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuYWRkVG9kb1RvUHJvamVjdChmb3JtRGF0YSwgYXJncyk7XG4gIH1cblxuICBjcmVhdGVUb2RvKGZvcm1EYXRhKSB7XG4gICAgcmV0dXJuIG5ldyBUb2RvKHt0aXRsZTogZm9ybURhdGFbMF0sIGRlc2NyaXB0aW9uOiBmb3JtRGF0YVsxXSxcbiAgICAgICAgICAgICAgICAgICAgIGR1ZURhdGU6IGZvcm1EYXRhWzJdLCBwcmlvcml0eTogZm9ybURhdGFbM119KTtcbiAgfVxuXG4gIGFkZFRvZG9Ub1Byb2plY3QoZm9ybURhdGEsIGFyZ3MpIHtcbiAgICBsZXQgcG0gPSBhcmdzWydwbSddO1xuICAgIGxldCBkY28gPSBhcmdzWydkY28nXTtcbiAgICBsZXQgbmV3VG9kbyA9IHRoaXMuY3JlYXRlVG9kbyhmb3JtRGF0YSk7XG4gICAgbGV0IHByb2plY3ROYW1lID0gZGNvLmdldEN1cnJlbnRQcm9qZWN0TmFtZSgpO1xuICAgIGxldCBwcm9qZWN0T2JqZWN0ID0gcG0uc2VhcmNoUHJvamVjdChwcm9qZWN0TmFtZSk7XG4gICAgcHJvamVjdE9iamVjdC5hZGRUb2RvKG5ld1RvZG8pO1xuICAgIGRjby5sb2FkVG9kbyhkY28uY3JlYXRlVG9kbyhuZXdUb2RvLnRpdGxlLCBuZXdUb2RvLmRlc2NyaXB0aW9uKSk7XG4gICAgZGNvLnJlbW92ZUZvcm0oKTtcbiAgfVxuXG4gIGdhdGhlclRvZG9Gb3JtRGF0YSA9IChldmVudCkgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdG9kb1RpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltuYW1lPSd0b2RvLXRpdGxlJ11cIikudmFsdWU7XG4gICAgY29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltuYW1lPSd0b2RvLWRlc2NyaXB0aW9uJ11cIikudmFsdWU7XG4gICAgY29uc3QgdG9kb0R1ZURhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiW25hbWU9J3RvZG8tZHVlRGF0ZSddXCIpLnZhbHVlO1xuICAgIGNvbnN0IHRvZG9Qcmlvcml0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbbmFtZT0ndG9kby1wcmlvcml0eSddXCIpLnZhbHVlO1xuICAgIHJldHVybiBbdG9kb1RpdGxlLCB0b2RvRGVzY3JpcHRpb24sIHRvZG9EdWVEYXRlLCB0b2RvUHJpb3JpdHldO1xuICB9XG59XG4iLCJpbXBvcnQgUGFnZUNvbnRyb2xsZXIgZnJvbSBcIi4vcGFnZS1jb250cm9sbGVyLmpzXCI7XG5cbmNvbnN0IG15UGFnZUNvbnRyb2xsZXIgPSBuZXcgUGFnZUNvbnRyb2xsZXI7XG5teVBhZ2VDb250cm9sbGVyLmxvYWRQYWdlKCk7XG4iLCJpbXBvcnQgRE9NQ3JlYXRvciBmcm9tICcuL2RvbS1jcmVhdG9yLmpzJztcbmltcG9ydCBFdmVudExpc3RlbmVyQWdyZWdhdG9yIGZyb20gJy4vZXZlbnQtbGlzdGVuZXItYWdyZWdhdG9yLmpzJztcbmltcG9ydCBQcm9qZWN0TWFuYWdlciBmcm9tICcuL3Byb2plY3QtbWFuYWdlci5qcyc7XG5pbXBvcnQgVG9kb01hbmFnZXIgZnJvbSAnLi90b2RvLW1hbmFnZXIuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYWdlQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMubXlEQ08gPSBuZXcgRE9NQ3JlYXRvcigpO1xuICAgIHRoaXMubXlFTEEgPSBuZXcgRXZlbnRMaXN0ZW5lckFncmVnYXRvcigpO1xuICAgIHRoaXMubXlQTSA9IG5ldyBQcm9qZWN0TWFuYWdlcigpO1xuICAgIHRoaXMubXlUTSA9IG5ldyBUb2RvTWFuYWdlcigpO1xuICB9XG5cbiAgbG9hZFBhZ2UoKSB7XG4gICAgdGhpcy5teURDTy5sb2FkUGFnZSgpO1xuICAgIHRoaXMubXlFTEEuYWRkTmF2YmFyTGlzdGVuZXIoXG4gICAgICB7ZGNvOiB0aGlzLm15RENPLFxuICAgICAgIHBtOiB0aGlzLm15UE0sXG4gICAgICAgdmFsaWRhdGVGdW5jdGlvbnM6IHRoaXMuZ2V0VmFsaWRhdGVGdW5jdGlvbnMoKX0pO1xuICB9XG5cbiAgZ2V0VmFsaWRhdGVGdW5jdGlvbnMoKSB7XG4gICAgbGV0IGZ1bmN0aW9ucyA9IFt0aGlzLm15VE0udmFsaWRhdGVUb2RvRm9ybSwgdGhpcy5teVBNLnZhbGlkYXRlUHJvamVjdEZvcm1dO1xuICAgIHJldHVybiBmdW5jdGlvbnM7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJGb3JtQ3JlYXRvciIsImNyZWF0ZVRvRG9Gb3JtIiwiYnV0dG9uIiwiZm9ybSIsInRoaXMiLCJjcmVhdGVGb3JtIiwibGFiZWxzIiwiY3JlYXRlTGFiZWxzIiwiaW5wdXRzIiwiY3JlYXRlVG9Eb0lucHV0cyIsImVsZW1lbnRzIiwiam9pbkxpc3RzIiwiYXBwZW5kSW5wdXRzVG9MYWJlbHMiLCJhcHBlbmRCdXR0b25zIiwiYXBwZW5kRWxlbWVudHNUb0Zvcm0iLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJhc3NpZ25BdHRyaWJ1dGUiLCJlbGVtZW50IiwiYXR0cmlidXRlIiwidmFsdWUiLCJzZXRBdHRyaWJ1dGUiLCJsYWJlbENvbnRlbnRzIiwiY29udGVudCIsInB1c2giLCJjcmVhdGVMYWJlbCIsImxhYmVsIiwidGV4dENvbnRlbnQiLCJ0ZXh0SW5wdXROYW1lcyIsInRleHRJbnB1dHMiLCJjcmVhdGVUZXh0SW5wdXRzIiwiZGlzdGluY3RJbnB1dHMiLCJjcmVhdGVEaXN0aW5jdElucHV0cyIsImlucHV0TmFtZXMiLCJuYW1lIiwiY3JlYXRlSW5wdXQiLCJ0eXBlIiwiaW5wdXQiLCJhdHRyaWJ1dGVzIiwidmFsdWVzIiwiYXNzaWduQXR0cmlidXRlcyIsImkiLCJsZW5ndGgiLCJjcmVhdGVEYXRldGltZUxvY2FsSW5wdXQiLCJjcmVhdGVOdW1iZXJJbnB1dCIsImdldEN1cnJlbnREYXRlIiwiRGF0ZSIsInRvSlNPTiIsInNsaWNlIiwibGFiZWxzRGVlcENvcHkiLCJkZWVwQ2xvbmVOb2RlcyIsImlucHV0c0RlZXBDb3B5IiwiYXBwZW5kQ2hpbGQiLCJmaXJzdExpc3QiLCJzZWNvbmRMaXN0IiwiY29uY2F0Iiwibm9kZXMiLCJkZWVwQ2xvbmVkTm9kZXMiLCJub2RlIiwiY2xvbmVOb2RlIiwiY3JlYXRlU3VibWl0QnV0dG9uIiwic3VibWl0QnV0dG9uIiwiZWxlbWVudHNEZWVwQ29weSIsImNyZWF0ZVByb2plY3RGb3JtIiwiRE9NQ3JlYXRvciIsImNvbnN0cnVjdG9yIiwiZm9ybUNyZWF0b3JPYmplY3QiLCJzY3JpcHQiLCJxdWVyeVNlbGVjdG9yIiwiZm9ybUNyZWF0b3IiLCJsb2FkUGFnZSIsImNyZWF0ZUhlYWRlciIsImNyZWF0ZVNpZGViYXIiLCJjcmVhdGVNYWluIiwiY3JlYXRlRm9vdGVyIiwiaGVhZGVyIiwibmF2IiwibmF2YmFyIiwiY3JlYXRlTmF2YmFyIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsInVsIiwiY3JlYXRlVWwiLCJsaXN0RWxlbWVudHMiLCJjcmVhdGVCdXR0b24iLCJjbGFzc05hbWUiLCJhcHBlbmRMaXN0RWxlbWVudHMiLCJjbGFzc0xpc3QiLCJhZGQiLCJsaXN0IiwibG9hZEZvcm0iLCJjcmVhdGVGb3JtRnVuY3Rpb24iLCJtYWluIiwiYXJncyIsIm5ld0J1dHRvbiIsInJlbW92ZUZvcm0iLCJyZW1vdmUiLCJhZGRQcm9qZWN0VG9TaWRlYmFyIiwicHJvamVjdE5hbWUiLCJwcm9qZWN0c0xpc3QiLCJuZXdQcm9qZWN0IiwiY3JlYXRlSGVhZGluZyIsImNyZWF0ZUxpIiwiaGVhZGluZyIsImhlYWRpbmdFbGVtZW50IiwibGkiLCJjcmVhdGVQcm9qZWN0c0xpc3QiLCJkZWZhdWx0SDIiLCJjcmVhdGVEaXYiLCJkZWZhdWx0Q29udGFpbmVyIiwiY3JlYXRlUHJvamVjdENvbnRhaW5lciIsInByb2plY3RDbGFzc05hbWUiLCJyZXBsYWNlIiwicHJvamVjdENvbnRhaW5lciIsInByb2plY3RIZWFkaW5nIiwidG9kb0xpc3QiLCJkaXYiLCJmb290ZXIiLCJsb2FkUHJvamVjdCIsImZvcm1EYXRhIiwicmVwbGFjZVByb2plY3RDb250YWluZXIiLCJyZW1vdmVQcm9qZWN0Q29udGFpbmVyIiwiZ2V0Q3VycmVudFByb2plY3RDb250YWluZXIiLCJuZXdQcm9qZWN0Q29udGFpbmVyIiwiZ2V0Q3VycmVudFByb2plY3ROYW1lIiwic3BsaXQiLCJjcmVhdGVUb2RvIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInRvZG9JbmZvIiwiY3JlYXRlUGFyYWdyYXBoIiwicGFyYWdyYXBoIiwibG9hZFRvZG8iLCJ0b2RvIiwiRXZlbnRMaXN0ZW5lckFncmVnYXRvciIsImFkZE5hdmJhckxpc3RlbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiaGFuZGxlTmF2YmFyQnV0dG9ucyIsImRjbyIsIm9idGFpbkRDTyIsInZhbGlkYXRlRnVuY3Rpb25zIiwiYnV0dG9uQ2xhc3NOYW1lIiwiZ2V0QXR0cmlidXRlRnJvbSIsInRhcmdldCIsImZvcm1GdW5jdGlvbiIsImdldEZvcm1GdW5jdGlvbiIsImdldEZvcm1DcmVhdG9yIiwiYWRkRm9ybUxpc3RlbmVyIiwidmFsaWRhdGVGdW5jdGlvbiIsImhhbmRsZUZvcm1CdXR0b25zIiwiYnV0dG9uVHlwZSIsIlByb2plY3QiLCJ0b2RvcyIsImFkZFRvZG8iLCJfbmFtZSIsIl90b2RvcyIsInJlbW92ZVRvZG8iLCJQcm9qZWN0TWFuYWdlciIsInByb2plY3RPYmplY3QiLCJwcm9qZWN0TGlzdCIsImFkZFByb2plY3QiLCJwcm9qZWN0IiwidmFsaWRhdGVQcm9qZWN0Rm9ybSIsImdhdGhlclByb2plY3RGb3JtRGF0YSIsImNvbnNvbGUiLCJsb2ciLCJmb3JtRGF0YUxvd2VyY2FzZSIsInRvTG93ZXJDYXNlIiwicHJldmVudERlZmF1bHQiLCJwcm9qZWN0TmFtZUNvaW5jaWRlcyIsInNlYXJjaFByb2plY3QiLCJmaW5kIiwiX3Byb2plY3RMaXN0IiwiVG9kbyIsImR1ZURhdGUiLCJwcmlvcml0eSIsIlRvZG9NYW5hZ2VyIiwidmFsaWRhdGVUb2RvRm9ybSIsImdhdGhlclRvZG9Gb3JtRGF0YSIsImluY2x1ZGVzIiwiYWRkVG9kb1RvUHJvamVjdCIsInBtIiwibmV3VG9kbyIsIm15RENPIiwibXlFTEEiLCJteVBNIiwibXlUTSIsImdldFZhbGlkYXRlRnVuY3Rpb25zIl0sInNvdXJjZVJvb3QiOiIifQ==