(()=>{"use strict";class t{createToDoForm=t=>{const e=this.createForm(),r=this.createLabels(["*Title:","*Description:","*Due Date:","*Priority:"]),o=this.createToDoInputs(["todo-title","todo-description"]);let s=this.joinLists(this.appendInputsToLabels(r,o),this.appendButtons(t,"to-do"));return this.appendElementsToForm(e,s)};createForm(){let t=document.createElement("form");return this.assignAttribute(t,"method","post"),t}assignAttribute(t,e,r=""){t.setAttribute(e,r)}createLabels(t){let e=[];for(const r of t)e.push(this.createLabel(r));return e}createLabel(t){const e=document.createElement("label");return e.textContent=t,e}createToDoInputs(t){const e=this.createTextInputs(t),r=this.createDistinctInputs();return this.joinLists(e,r)}createTextInputs(t){let e=[];for(const r of t)e.push(this.createInput(r));return e}createInput(t,e=""){const r=document.createElement("input");let o=["name","required"],s=[t,""];return e&&(o.push("type"),s.push(e)),this.assignAttributes(r,o,s),r}assignAttributes(t,e,r){for(let o=0;o<e.length;o++)this.assignAttribute(t,e[o],r[o])}createDistinctInputs(){return[this.createDatetimeLocalInput("todo-dueDate"),this.createNumberInput("todo-priority")]}createDatetimeLocalInput(t){const e=this.createInput(t,"datetime-local");return this.assignAttribute(e,"value",this.getCurrentDate()),e}getCurrentDate(){return(new Date).toJSON().slice(0,19)}createNumberInput(t){const e=this.createInput(t,"number");return this.assignAttributes(e,["min","max","placeholder"],["1","3","1"]),e}appendInputsToLabels(t,e){let r=this.deepCloneNodes(t);const o=this.deepCloneNodes(e);for(let e=0;e<t.length;e++)r[e].appendChild(o[e]);return r}joinLists(t,e){return t.concat(e)}deepCloneNodes(t){let e=[];for(const r of t)e.push(r.cloneNode(!0));return e}appendButtons(t,e){return[t,this.createSubmitButton(e)]}createSubmitButton(t){const e=document.createElement("input");let r=["submit",`Create ${t}`];return this.assignAttributes(e,["type","value"],r),e}appendElementsToForm(t,e){const r=this.deepCloneNodes(e);for(const e of r)t.appendChild(e);return t}createProjectForm=t=>{const e=this.createForm(),r=this.createLabels(["*Name:"]),o=this.createTextInputs(["project-name"]);let s=this.joinLists(this.appendInputsToLabels(r,o),this.appendButtons(t,"project"));return this.appendElementsToForm(e,s)}}class e{constructor(e=t){this.script=document.querySelector("script"),this.formCreator=new e}get script(){return this._script}set script(t){this._script=t}get formCreator(){return this._formCreator}set formCreator(t){this._formCreator=t}loadPage(){this.createHeader(),this.createSidebar(),this.createMain(),this.createFooter()}createHeader(){let t=document.createElement("header"),e=document.createElement("nav"),r=this.createNavbar();t.appendChild(e),e.appendChild(r),this.script.parentNode.insertBefore(t,this.script)}createNavbar(){let t=this.createUl("navbar"),e=[this.createButton("New to-do",{className:"new-to-do"}),this.createButton("New project",{className:"new-project"})];return this.appendListElements(t,e),t}createUl(t=""){const e=document.createElement("ul");return t&&e.classList.add(t),e}appendListElements(t,e){for(let r of e)t.appendChild(r)}loadForm=t=>{if(null===this.getElement("form")){let e=this.getElement("main");const r=t(this.createButton("Cancel",{type:"button"}));e.appendChild(r)}};getElement(t){return document.querySelector(t)}createButton(t,e={}){let r=document.createElement("button");return r.textContent=t,e.type&&r.setAttribute("type",e.type),e.className&&r.classList.add(e.className),r}removeForm(){const t=this.getElement("form");this.removeElement(t)}removeElement(t){t.remove()}addProjectToSidebar(t){let e=this.getElement(".projects-list");const r=this.createButton(t,{className:"project-button"});e.appendChild(this.createLi(r))}createHeading(t,e){let r=document.createElement(e);return r.textContent=t,r}createLi(t){let e=document.createElement("li");return e.appendChild(t),e}createSidebar(){let t=document.createElement("nav"),e=[this.createHeading("Projects","h1"),this.createProjectsList()];this.appendListElements(t,e),this.script.parentNode.insertBefore(t,this.script)}createProjectsList(){let t=this.createUl("projects-list"),e=this.createButton("default",{className:"project-button"});return t.appendChild(this.createLi(e)),t}createMain(){const t=document.createElement("main");let e=this.createDiv("content");const r=this.createProjectContainer("default-container");e.appendChild(r),t.appendChild(e),this.script.parentNode.insertBefore(t,this.script)}createProjectContainer(t,e={}){let r=t.replace("-container",""),o=this.createDiv(t),s=this.createHeading(r,"h1"),i=this.loadTodos(r,e);return this.appendListElements(o,[s,i]),o}createDiv(t){let e=document.createElement("div");return e.classList.add(t),e}loadTodos(t,e){let r=this.createUl("todo-list");if(e.pm){let o=e.pm.searchProject(t),s=this.createTodos(o.todos);this.appendListElements(r,s)}return r}createTodos(t){let e=[];for(let r of t)e.push(this.createTodo(r.title,r.description));return e}createFooter(){const t=document.createElement("footer");this.script.parentNode.insertBefore(t,this.script)}loadProject(t){this.replaceProjectContainer(`${t}-container`),this.addProjectToSidebar(t),this.removeForm()}removeProjectContainer(){const t=this.getCurrentProjectContainer();this.removeElement(t)}getCurrentProjectContainer(){return this.getElement(".content > div")}replaceProjectContainer(t,e={}){let r=this.getElement(".content"),o=this.createProjectContainer(t,e);this.removeProjectContainer(),r.appendChild(o)}getCurrentProjectName(){return this.getCurrentProjectContainer().className.split("-")[0]}createTodo(t,e){let r=this.createButton(""),o=this.createParagraph(`Title: ${t}, Description: ${e}`),s=this.createLi(r);return s.appendChild(o),s}createParagraph(t){let e=document.createElement("p");return e.textContent=t,e}loadTodo(t){this.getElement(".todo-list").appendChild(t)}obtainTodoTitle(t){let e=t.querySelector("p").textContent.split(",");return e=e[0].split(": "),e[1]}updateTodo(t,e){let r=this.createParagraph(`Due date: ${e.dueDate}, priority: ${e.priority}`);t.appendChild(r)}getAttributeFrom(t,e){return t[e]}}class r{addNavbarListener(t,e){e.dco.getElement(".navbar").addEventListener("click",(r=>t(r,e)))}addFormListener(t,e){e.dco.getElement("form").addEventListener("click",(r=>e.handleFunction(r,t,e)))}addElementListener(t,e){t.addEventListener("click",(t=>e(t)))}}class o{constructor(t){this.name=t,this.todos=[]}addTodo(t){this.todos.push(t)}get name(){return this._name}set name(t){this._name=t}get todos(){return this._todos}set todos(t){this._todos=t}searchTodo(t){return this.todos.find((e=>e.title===t))}removeTodo(){}}class s{constructor(t=o){this.projectList=[],this.addProject(new t("default"))}addProject(t){this.projectList.push(t)}validateProjectForm=(t,e,r=o)=>{let s=e.dco;const i=this.gatherProjectFormData(t,s);if(""===i)return void console.log("Couldn't create Project");const n=i.toLowerCase();let a=new r(n);this.addProject(a),s.loadProject(n)};gatherProjectFormData(t,e){return t.preventDefault(),e.getElement("[name='project-name']").value}projectNameCoincides(t,e){return t.name===e}searchProject(t){return this.projectList.find((e=>this.projectNameCoincides(e,t)))}get projectList(){return this._projectList}set projectList(t){this._projectList=t}}class i{constructor(t){this.title=t.title,this.description=t.description,this.dueDate=t.dueDate,this.priority=t.priority}}class n{validateTodoForm=(t,e)=>{let r=this.gatherTodoFormData(t,e.dco);this.validateFormData(r)?console.log("Couldn't create To-do"):this.addTodoToProject(r,e)};gatherTodoFormData=(t,e)=>(t.preventDefault(),{title:e.getElement("[name='todo-title']").value,description:e.getElement("[name='todo-description']").value,dueDate:e.getElement("[name='todo-dueDate']").value,priority:e.getElement("[name='todo-priority']").value});validateFormData(t){return Object.values(t).some((t=>""===t))}createTodo(t){return new i({title:t.title,description:t.description,dueDate:t.dueDate,priority:t.priority})}addTodoToProject(t,e){let r=e.pm,o=e.dco,s=this.createTodo(t),i=o.getCurrentProjectName();r.searchProject(i).addTodo(s),o.loadTodo(o.createTodo(s.title,s.description)),o.removeForm()}}(new class{constructor(){this.myDCO=new e,this.myELA=new r,this.myPM=new s,this.myTM=new n}loadPage(){this.createFC(),this.myDCO.loadPage(),this.myELA.addNavbarListener(this.handleNavbarButtons,this.getNavBarArguments()),this.myELA.addElementListener(this.myDCO.getElement(".projects-list"),this.handleProjectButtons),this.myELA.addElementListener(this.myDCO.getElement(".todo-list"),this.handleTodosLi)}getNavBarArguments(){return{dco:this.myDCO,pm:this.myPM,validateFunctions:this.getValidateFunctions(),handleFunction:this.handleFormButtons}}getValidateFunctions(){return[this.myTM.validateTodoForm,this.myPM.validateProjectForm]}handleNavbarButtons=(t,e)=>{let r=this.myDCO.getAttributeFrom(t.target,"className"),o=this.selectFormFunctions(r,e.validateFunctions);this.myDCO.loadForm(o.formFunction),this.myELA.addFormListener(o.validateFunction,e)};createFC(){this.myFC=this.myDCO.formCreator}selectFormFunctions(t,e){switch(t){case"new-to-do":return{validateFunction:e[0],formFunction:this.myFC.createToDoForm};case"new-project":return{validateFunction:e[1],formFunction:this.myFC.createProjectForm}}}handleFormButtons=(t,e,r)=>{let o=this.myDCO.getAttributeFrom(t.target,"type");"button"===o&&this.myDCO.removeForm(),"submit"===o&&e(t,r)};handleProjectButtons=t=>{if("project-button"===this.myDCO.getAttributeFrom(t.target,"className")){let e=this.myDCO.getAttributeFrom(t.target,"innerText");this.myDCO.replaceProjectContainer(e,{pm:this.myPM}),this.myELA.addElementListener(this.myDCO.getElement(".todo-list"),this.handleTodosLi)}};handleTodosLi=t=>{if("BUTTON"!==this.myDCO.getAttributeFrom(t.target,"nodeName")){let e=t.target.children.length;2==e?this.expandTodo(t):e>2&&this.collapseTodo(t.target)}};expandTodo(t){let e=this.myDCO.getCurrentProjectName(),r=this.myPM.searchProject(e),o=this.myDCO.obtainTodoTitle(t.target),s=r.searchTodo(o),i={dueDate:s.dueDate,priority:s.priority};this.myDCO.updateTodo(t.target,i)}collapseTodo(t){let e=t.lastChild;this.myDCO.removeElement(e)}}).loadPage()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxFQUFNa0QsT0FBUSxZQUM5QixDQUN6QixJQUFJTyxFQUFlekQsRUFBTWtELE9BQU9RLFNBQVM3SyxPQUNyQixHQUFoQjRLLEVBQ0ZsTixLQUFLb04sV0FBVzNELEdBQ1R5RCxFQUFlLEdBQ3RCbE4sS0FBS3FOLGFBQWE1RCxFQUFNa0QsT0FDNUIsR0FHRlMsV0FBVzNELEdBQ1QsSUFBSXRELEVBQWNuRyxLQUFLOEwsTUFBTXZELHdCQUN6QmhCLEVBQWdCdkgsS0FBS2dNLEtBQUt4RSxjQUFjckIsR0FDeEM0QyxFQUFZL0ksS0FBSzhMLE1BQU1qRCxnQkFBZ0JZLEVBQU1rRCxRQUM3Q1csRUFBYS9GLEVBQWMwQyxXQUFXbEIsR0FDdEN3RSxFQUFvQixDQUN0QnBDLFFBQVNtQyxFQUFXbkMsUUFBU0MsU0FBVWtDLEVBQVdsQyxVQUVwRHBMLEtBQUs4TCxNQUFNOUMsV0FBV1MsRUFBTWtELE9BQVFZLEVBR3RDLENBRUFGLGFBQWF2TSxHQUNYLElBQUkwTSxFQUFnQjFNLEVBQVEyTSxVQUM1QnpOLEtBQUs4TCxNQUFNOUYsY0FBY3dILEVBQzNCLElEckdlcEosVSIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9mb3JtLWNyZWF0b3IuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2RvbS1jcmVhdG9yLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9ldmVudC1saXN0ZW5lci1hZ3JlZ2F0b3IuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3Byb2plY3QtbWFuYWdlci5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvdG9kby5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvdG9kby1tYW5hZ2VyLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvcGFnZS1jb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1DcmVhdG9yIHtcbiAgY3JlYXRlVG9Eb0Zvcm0gPSAoYnV0dG9uKSA9PiB7XG4gICAgY29uc3QgZm9ybSA9IHRoaXMuY3JlYXRlRm9ybSgpO1xuICAgIGNvbnN0IGxhYmVsQ29udGVudHMgPSBbJypUaXRsZTonLCAnKkRlc2NyaXB0aW9uOicsICcqRHVlIERhdGU6JywgJypQcmlvcml0eTonXTtcbiAgICBjb25zdCB0ZXh0SW5wdXROYW1lcyA9IFsndG9kby10aXRsZScsICd0b2RvLWRlc2NyaXB0aW9uJ107XG4gICAgY29uc3QgbGFiZWxzID0gdGhpcy5jcmVhdGVMYWJlbHMobGFiZWxDb250ZW50cyk7XG4gICAgY29uc3QgaW5wdXRzID0gdGhpcy5jcmVhdGVUb0RvSW5wdXRzKHRleHRJbnB1dE5hbWVzKTtcbiAgICBsZXQgZWxlbWVudHMgPSB0aGlzLmpvaW5MaXN0cyhcbiAgICAgIHRoaXMuYXBwZW5kSW5wdXRzVG9MYWJlbHMobGFiZWxzLCBpbnB1dHMpLFxuICAgICAgdGhpcy5hcHBlbmRCdXR0b25zKGJ1dHRvbiwgJ3RvLWRvJykpO1xuICAgIHJldHVybiB0aGlzLmFwcGVuZEVsZW1lbnRzVG9Gb3JtKGZvcm0sIGVsZW1lbnRzKTtcbiAgfVxuXG4gIGNyZWF0ZUZvcm0oKSB7XG4gICAgbGV0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7XG4gICAgdGhpcy5hc3NpZ25BdHRyaWJ1dGUoZm9ybSwgJ21ldGhvZCcsICdwb3N0Jyk7XG4gICAgcmV0dXJuIGZvcm07XG4gIH1cblxuICBhc3NpZ25BdHRyaWJ1dGUoZWxlbWVudCAsYXR0cmlidXRlLCB2YWx1ZT0nJykge1xuICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgdmFsdWUpO1xuICB9XG5cbiAgY3JlYXRlTGFiZWxzKGxhYmVsQ29udGVudHMpIHtcbiAgICBsZXQgbGFiZWxzID0gW107XG4gICAgZm9yIChjb25zdCBjb250ZW50IG9mIGxhYmVsQ29udGVudHMpXG4gICAgICBsYWJlbHMucHVzaCh0aGlzLmNyZWF0ZUxhYmVsKGNvbnRlbnQpKTtcbiAgICByZXR1cm4gbGFiZWxzO1xuICB9XG5cbiAgY3JlYXRlTGFiZWwoY29udGVudCkge1xuICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgICBsYWJlbC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgcmV0dXJuIGxhYmVsO1xuICB9XG5cbiAgY3JlYXRlVG9Eb0lucHV0cyh0ZXh0SW5wdXROYW1lcykge1xuICAgIGNvbnN0IHRleHRJbnB1dHMgPSB0aGlzLmNyZWF0ZVRleHRJbnB1dHModGV4dElucHV0TmFtZXMpO1xuICAgIGNvbnN0IGRpc3RpbmN0SW5wdXRzID0gdGhpcy5jcmVhdGVEaXN0aW5jdElucHV0cygpO1xuICAgIHJldHVybiB0aGlzLmpvaW5MaXN0cyh0ZXh0SW5wdXRzLCBkaXN0aW5jdElucHV0cyk7XG4gIH1cblxuICBjcmVhdGVUZXh0SW5wdXRzKGlucHV0TmFtZXMpIHtcbiAgICBsZXQgaW5wdXRzID0gW107XG4gICAgZm9yIChjb25zdCBuYW1lIG9mIGlucHV0TmFtZXMpXG4gICAgICBpbnB1dHMucHVzaCh0aGlzLmNyZWF0ZUlucHV0KG5hbWUpKTtcbiAgICByZXR1cm4gaW5wdXRzO1xuICB9XG5cbiAgY3JlYXRlSW5wdXQobmFtZSwgdHlwZT0nJykge1xuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICBsZXQgYXR0cmlidXRlcyA9IFsnbmFtZScsICdyZXF1aXJlZCddO1xuICAgIGxldCB2YWx1ZXMgPSBbbmFtZSwgJyddO1xuICAgIGlmICh0eXBlKSB7XG4gICAgICBhdHRyaWJ1dGVzLnB1c2goJ3R5cGUnKTtcbiAgICAgIHZhbHVlcy5wdXNoKHR5cGUpO1xuICAgIH1cbiAgICB0aGlzLmFzc2lnbkF0dHJpYnV0ZXMoaW5wdXQsIGF0dHJpYnV0ZXMsIHZhbHVlcyk7XG4gICAgcmV0dXJuIGlucHV0O1xuICB9XG5cbiAgYXNzaWduQXR0cmlidXRlcyhlbGVtZW50LCBhdHRyaWJ1dGVzLCB2YWx1ZXMpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspXG4gICAgICB0aGlzLmFzc2lnbkF0dHJpYnV0ZShlbGVtZW50LCBhdHRyaWJ1dGVzW2ldLCB2YWx1ZXNbaV0pO1xuICB9XG5cbiAgY3JlYXRlRGlzdGluY3RJbnB1dHMoKSB7XG4gICAgLy8gVGhlc2UgaW5wdXRzIGFyZSB1c2VkIGluIHRoZSB0by1kbyBmb3JtXG4gICAgY29uc3QgZGF0ZVBpY2tlciA9IHRoaXMuY3JlYXRlRGF0ZXRpbWVMb2NhbElucHV0KCd0b2RvLWR1ZURhdGUnKTtcbiAgICBjb25zdCBudW1iZXJJbnB1dCA9IHRoaXMuY3JlYXRlTnVtYmVySW5wdXQoJ3RvZG8tcHJpb3JpdHknKTtcbiAgICByZXR1cm4gW2RhdGVQaWNrZXIsIG51bWJlcklucHV0XTtcbiAgfVxuXG4gIGNyZWF0ZURhdGV0aW1lTG9jYWxJbnB1dChuYW1lKSB7XG4gICAgY29uc3QgaW5wdXQgPSB0aGlzLmNyZWF0ZUlucHV0KG5hbWUsICdkYXRldGltZS1sb2NhbCcpO1xuICAgIHRoaXMuYXNzaWduQXR0cmlidXRlKGlucHV0LCAndmFsdWUnLCB0aGlzLmdldEN1cnJlbnREYXRlKCkpO1xuICAgIHJldHVybiBpbnB1dDtcbiAgfVxuXG4gIGdldEN1cnJlbnREYXRlKCkge1xuICAgIC8vIFJldHVybnMgaW4gdGhlIGZvcm1hdCB5eXl5LU1NLURELVRoaDptbVxuICAgIHJldHVybiBuZXcgRGF0ZSgpLnRvSlNPTigpLnNsaWNlKDAsMTkpO1xuICB9XG5cbiAgY3JlYXRlTnVtYmVySW5wdXQobmFtZSkge1xuICAgIC8vIEZvciB0aGUgbW9tZW50IGl0J3Mgb25seSB1c2VkIGZvciBhIHByaW9yaXR5IGlucHV0XG4gICAgY29uc3QgaW5wdXQgPSB0aGlzLmNyZWF0ZUlucHV0KG5hbWUsICdudW1iZXInKTtcbiAgICBsZXQgbWluVmFsdWUgPSAnMSc7XG4gICAgbGV0IG1heFZhbHVlID0gJzMnO1xuICAgIGxldCBhdHRyaWJ1dGVzID0gWydtaW4nLCAnbWF4JywgJ3BsYWNlaG9sZGVyJ107XG4gICAgbGV0IHZhbHVlcyA9IFttaW5WYWx1ZSwgbWF4VmFsdWUsIG1pblZhbHVlXTtcbiAgICB0aGlzLmFzc2lnbkF0dHJpYnV0ZXMoaW5wdXQsIGF0dHJpYnV0ZXMsIHZhbHVlcyk7XG4gICAgcmV0dXJuIGlucHV0O1xuICB9XG5cbiAgYXBwZW5kSW5wdXRzVG9MYWJlbHMobGFiZWxzLCBpbnB1dHMpIHtcbiAgICBsZXQgbGFiZWxzRGVlcENvcHkgPSB0aGlzLmRlZXBDbG9uZU5vZGVzKGxhYmVscyk7XG4gICAgY29uc3QgaW5wdXRzRGVlcENvcHkgPSB0aGlzLmRlZXBDbG9uZU5vZGVzKGlucHV0cyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYWJlbHMubGVuZ3RoOyBpKyspXG4gICAgICBsYWJlbHNEZWVwQ29weVtpXS5hcHBlbmRDaGlsZChpbnB1dHNEZWVwQ29weVtpXSk7XG4gICAgcmV0dXJuIGxhYmVsc0RlZXBDb3B5O1xuICB9XG5cbiAgam9pbkxpc3RzKGZpcnN0TGlzdCwgc2Vjb25kTGlzdCkge1xuICAgIHJldHVybiBmaXJzdExpc3QuY29uY2F0KHNlY29uZExpc3QpO1xuICB9XG5cbiAgZGVlcENsb25lTm9kZXMobm9kZXMpIHtcbiAgICBsZXQgZGVlcENsb25lZE5vZGVzID0gW107XG4gICAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKVxuICAgICAgZGVlcENsb25lZE5vZGVzLnB1c2gobm9kZS5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgIHJldHVybiBkZWVwQ2xvbmVkTm9kZXM7XG4gIH1cblxuICBhcHBlbmRCdXR0b25zKGJ1dHRvbiwgdmFsdWUpIHtcbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSB0aGlzLmNyZWF0ZVN1Ym1pdEJ1dHRvbih2YWx1ZSk7XG4gICAgcmV0dXJuIFtidXR0b24sIHN1Ym1pdEJ1dHRvbl07XG4gIH1cblxuICBjcmVhdGVTdWJtaXRCdXR0b24odmFsdWUpIHtcbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGxldCBhdHRyaWJ1dGVzID0gWyd0eXBlJywgJ3ZhbHVlJ107XG4gICAgbGV0IHZhbHVlcyA9IFsnc3VibWl0JywgYENyZWF0ZSAke3ZhbHVlfWBdO1xuICAgIHRoaXMuYXNzaWduQXR0cmlidXRlcyhzdWJtaXRCdXR0b24sIGF0dHJpYnV0ZXMsIHZhbHVlcyk7XG4gICAgcmV0dXJuIHN1Ym1pdEJ1dHRvbjtcbiAgfVxuXG4gIGFwcGVuZEVsZW1lbnRzVG9Gb3JtKGZvcm0sIGVsZW1lbnRzKSB7XG4gICAgY29uc3QgZWxlbWVudHNEZWVwQ29weSA9IHRoaXMuZGVlcENsb25lTm9kZXMoZWxlbWVudHMpO1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50c0RlZXBDb3B5KVxuICAgICAgZm9ybS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICByZXR1cm4gZm9ybTtcbiAgfVxuXG4gIGNyZWF0ZVByb2plY3RGb3JtID0gKGJ1dHRvbikgPT4ge1xuICAgIGNvbnN0IGZvcm0gPSB0aGlzLmNyZWF0ZUZvcm0oKTtcbiAgICBjb25zdCBsYWJlbCA9IHRoaXMuY3JlYXRlTGFiZWxzKFsnKk5hbWU6J10pO1xuICAgIGNvbnN0IGlucHV0ID0gdGhpcy5jcmVhdGVUZXh0SW5wdXRzKFsncHJvamVjdC1uYW1lJ10pO1xuICAgIGxldCBlbGVtZW50cyA9IHRoaXMuam9pbkxpc3RzKFxuICAgICAgdGhpcy5hcHBlbmRJbnB1dHNUb0xhYmVscyhsYWJlbCwgaW5wdXQpLFxuICAgICAgdGhpcy5hcHBlbmRCdXR0b25zKGJ1dHRvbiwgJ3Byb2plY3QnKSk7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kRWxlbWVudHNUb0Zvcm0oZm9ybSwgZWxlbWVudHMpO1xuICB9XG59XG4iLCJpbXBvcnQgRm9ybUNyZWF0b3IgZnJvbSBcIi4vZm9ybS1jcmVhdG9yLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERPTUNyZWF0b3Ige1xuICBjb25zdHJ1Y3Rvcihmb3JtQ3JlYXRvck9iamVjdD1Gb3JtQ3JlYXRvcikge1xuICAgIHRoaXMuc2NyaXB0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2NyaXB0Jyk7XG4gICAgdGhpcy5mb3JtQ3JlYXRvciA9IG5ldyBmb3JtQ3JlYXRvck9iamVjdCgpO1xuICB9XG5cbiAgZ2V0IHNjcmlwdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fc2NyaXB0O1xuICB9XG5cbiAgc2V0IHNjcmlwdCh2YWx1ZSkge1xuICAgIHRoaXMuX3NjcmlwdCA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IGZvcm1DcmVhdG9yKCkge1xuICAgIHJldHVybiB0aGlzLl9mb3JtQ3JlYXRvcjtcbiAgfVxuXG4gIHNldCBmb3JtQ3JlYXRvcih2YWx1ZSkge1xuICAgIHRoaXMuX2Zvcm1DcmVhdG9yID0gdmFsdWU7XG4gIH1cblxuICBsb2FkUGFnZSgpIHtcbiAgICB0aGlzLmNyZWF0ZUhlYWRlcigpO1xuICAgIHRoaXMuY3JlYXRlU2lkZWJhcigpO1xuICAgIHRoaXMuY3JlYXRlTWFpbigpO1xuICAgIHRoaXMuY3JlYXRlRm9vdGVyKCk7XG4gIH1cblxuICBjcmVhdGVIZWFkZXIoKSB7XG4gICAgbGV0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2hlYWRlcicpO1xuICAgIGxldCBuYXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCduYXYnKTtcbiAgICBsZXQgbmF2YmFyID0gdGhpcy5jcmVhdGVOYXZiYXIoKTtcbiAgICBoZWFkZXIuYXBwZW5kQ2hpbGQobmF2KTtcbiAgICBuYXYuYXBwZW5kQ2hpbGQobmF2YmFyKTtcbiAgICB0aGlzLnNjcmlwdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShoZWFkZXIsIHRoaXMuc2NyaXB0KTtcbiAgfVxuXG4gIGNyZWF0ZU5hdmJhcigpIHtcbiAgICAvLyBDb25zaWRlciBhZGRpbmcgbW9yZSBlbGVtZW50c1xuICAgIGxldCB1bCA9IHRoaXMuY3JlYXRlVWwoJ25hdmJhcicpO1xuICAgIGxldCB0b2RvQnV0dG9uID0gdGhpcy5jcmVhdGVCdXR0b24oJ05ldyB0by1kbycsIHtjbGFzc05hbWU6ICduZXctdG8tZG8nfSk7XG4gICAgbGV0IHByb2plY3RCdXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbignTmV3IHByb2plY3QnLFxuICAgICAge2NsYXNzTmFtZTogJ25ldy1wcm9qZWN0J30pO1xuICAgIGxldCBsaXN0RWxlbWVudHMgPSBbdG9kb0J1dHRvbiwgcHJvamVjdEJ1dHRvbl07XG4gICAgdGhpcy5hcHBlbmRMaXN0RWxlbWVudHModWwsIGxpc3RFbGVtZW50cyk7XG4gICAgcmV0dXJuIHVsO1xuICB9XG5cbiAgY3JlYXRlVWwoY2xhc3NOYW1lPScnKSB7XG4gICAgY29uc3QgdWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgIGlmIChjbGFzc05hbWUpXG4gICAgICB1bC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgcmV0dXJuIHVsO1xuICB9XG5cbiAgYXBwZW5kTGlzdEVsZW1lbnRzKGxpc3QsIGVsZW1lbnRzKSB7XG4gICAgZm9yIChsZXQgZWxlbWVudCBvZiBlbGVtZW50cylcbiAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gIH1cblxuICBsb2FkRm9ybSA9IChjcmVhdGVGb3JtRnVuY3Rpb24pID0+IHtcbiAgICBpZiAodGhpcy5nZXRFbGVtZW50KCdmb3JtJykgPT09IG51bGwpIHtcbiAgICAgIGxldCBtYWluID0gdGhpcy5nZXRFbGVtZW50KCdtYWluJyk7XG4gICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbignQ2FuY2VsJywge3R5cGU6ICdidXR0b24nfSk7XG4gICAgICBjb25zdCBmb3JtID0gY3JlYXRlRm9ybUZ1bmN0aW9uKGNhbmNlbEJ1dHRvbik7XG4gICAgICBtYWluLmFwcGVuZENoaWxkKGZvcm0pO1xuICAgIH1cbiAgfVxuXG4gIGdldEVsZW1lbnQocXVlcnkpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihxdWVyeSk7XG4gIH1cblxuICBjcmVhdGVCdXR0b24oY29udGVudCwgYXJncz17fSkge1xuICAgIGxldCBuZXdCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBuZXdCdXR0b24udGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgIGlmIChhcmdzWyd0eXBlJ10pXG4gICAgICBuZXdCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgYXJnc1sndHlwZSddKTtcbiAgICBpZiAoYXJnc1snY2xhc3NOYW1lJ10pXG4gICAgICBuZXdCdXR0b24uY2xhc3NMaXN0LmFkZChhcmdzWydjbGFzc05hbWUnXSk7XG4gICAgcmV0dXJuIG5ld0J1dHRvbjtcbiAgfVxuXG4gIHJlbW92ZUZvcm0oKSB7XG4gICAgY29uc3QgZm9ybSA9IHRoaXMuZ2V0RWxlbWVudCgnZm9ybScpO1xuICAgIHRoaXMucmVtb3ZlRWxlbWVudChmb3JtKTtcbiAgfVxuXG4gIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xuICAgIGVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICBhZGRQcm9qZWN0VG9TaWRlYmFyKHByb2plY3ROYW1lKSB7XG4gICAgbGV0IHByb2plY3RzTGlzdCA9IHRoaXMuZ2V0RWxlbWVudCgnLnByb2plY3RzLWxpc3QnKTtcbiAgICBjb25zdCBuZXdQcm9qZWN0ID0gdGhpcy5jcmVhdGVCdXR0b24oXG4gICAgICBwcm9qZWN0TmFtZSwgeyBjbGFzc05hbWU6ICdwcm9qZWN0LWJ1dHRvbicgfSk7XG4gICAgcHJvamVjdHNMaXN0LmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlTGkobmV3UHJvamVjdCkpO1xuICB9XG5cbiAgY3JlYXRlSGVhZGluZyhjb250ZW50LCBoZWFkaW5nKSB7XG4gICAgbGV0IGhlYWRpbmdFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChoZWFkaW5nKTtcbiAgICBoZWFkaW5nRWxlbWVudC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgcmV0dXJuIGhlYWRpbmdFbGVtZW50O1xuICB9XG5cbiAgY3JlYXRlTGkoZWxlbWVudCkge1xuICAgIGxldCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgbGkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gICAgcmV0dXJuIGxpO1xuICB9XG5cbiAgY3JlYXRlU2lkZWJhcigpIHtcbiAgICBsZXQgbmF2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbmF2Jyk7XG4gICAgY29uc3QgcHJvamVjdHNIMSA9IHRoaXMuY3JlYXRlSGVhZGluZygnUHJvamVjdHMnLCAnaDEnKTtcbiAgICBsZXQgcHJvamVjdHNMaXN0ID0gdGhpcy5jcmVhdGVQcm9qZWN0c0xpc3QoKTtcbiAgICBsZXQgbGlzdEVsZW1lbnRzID0gW3Byb2plY3RzSDEsIHByb2plY3RzTGlzdF07XG4gICAgdGhpcy5hcHBlbmRMaXN0RWxlbWVudHMobmF2LCBsaXN0RWxlbWVudHMpO1xuICAgIHRoaXMuc2NyaXB0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5hdiwgdGhpcy5zY3JpcHQpO1xuICB9XG5cbiAgY3JlYXRlUHJvamVjdHNMaXN0KCkge1xuICAgIGxldCBwcm9qZWN0c0xpc3QgPSB0aGlzLmNyZWF0ZVVsKCdwcm9qZWN0cy1saXN0Jyk7XG4gICAgbGV0IGRlZmF1bHRCdXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbihcbiAgICAgICdkZWZhdWx0JywgeyBjbGFzc05hbWU6ICdwcm9qZWN0LWJ1dHRvbicgfSk7XG4gICAgcHJvamVjdHNMaXN0LmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlTGkoZGVmYXVsdEJ1dHRvbikpO1xuICAgIHJldHVybiBwcm9qZWN0c0xpc3Q7XG4gIH1cblxuICBjcmVhdGVNYWluKCkge1xuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdtYWluJyk7XG4gICAgbGV0IGNvbnRlbnQgPSB0aGlzLmNyZWF0ZURpdignY29udGVudCcpO1xuICAgIGNvbnN0IGRlZmF1bHRDb250YWluZXIgPSB0aGlzLmNyZWF0ZVByb2plY3RDb250YWluZXIoJ2RlZmF1bHQtY29udGFpbmVyJylcbiAgICBjb250ZW50LmFwcGVuZENoaWxkKGRlZmF1bHRDb250YWluZXIpO1xuICAgIG1haW4uYXBwZW5kQ2hpbGQoY29udGVudCk7XG4gICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobWFpbiwgdGhpcy5zY3JpcHQpO1xuICB9XG5cbiAgY3JlYXRlUHJvamVjdENvbnRhaW5lcihwcm9qZWN0Q2xhc3NOYW1lLCBhcmdzPXt9KSB7XG4gICAgLy8gQ29uc2lkZXIgYSBtZXRob2QgaW4gYW5vdGhlciBtb2R1bGUgdG8gY2hhbmdlIHRoaXMgbGluZVxuICAgIGxldCBwcm9qZWN0TmFtZSA9IHByb2plY3RDbGFzc05hbWUucmVwbGFjZSgnLWNvbnRhaW5lcicsICcnKTtcbiAgICBsZXQgcHJvamVjdENvbnRhaW5lciA9IHRoaXMuY3JlYXRlRGl2KHByb2plY3RDbGFzc05hbWUpO1xuICAgIGxldCBwcm9qZWN0SGVhZGluZyA9IHRoaXMuY3JlYXRlSGVhZGluZyhwcm9qZWN0TmFtZSwgJ2gxJyk7XG4gICAgbGV0IHRvZG9MaXN0ID0gdGhpcy5sb2FkVG9kb3MocHJvamVjdE5hbWUsIGFyZ3MpO1xuICAgIHRoaXMuYXBwZW5kTGlzdEVsZW1lbnRzKHByb2plY3RDb250YWluZXIsIFtwcm9qZWN0SGVhZGluZywgdG9kb0xpc3RdKTtcbiAgICByZXR1cm4gcHJvamVjdENvbnRhaW5lcjtcbiAgfVxuXG4gIGNyZWF0ZURpdihjbGFzc05hbWUpIHtcbiAgICBsZXQgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZGl2LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICByZXR1cm4gZGl2O1xuICB9XG4gIFxuICBsb2FkVG9kb3MocHJvamVjdE5hbWUsIGFyZ3MpIHtcbiAgICBsZXQgdG9kb0xpc3QgPSB0aGlzLmNyZWF0ZVVsKCd0b2RvLWxpc3QnKTtcbiAgICBpZiAoYXJnc1sncG0nXSkge1xuICAgICAgbGV0IHByb2plY3RPYmplY3QgPSBhcmdzWydwbSddLnNlYXJjaFByb2plY3QocHJvamVjdE5hbWUpO1xuICAgICAgbGV0IHRvZG9zID0gdGhpcy5jcmVhdGVUb2Rvcyhwcm9qZWN0T2JqZWN0LnRvZG9zKTtcbiAgICAgIHRoaXMuYXBwZW5kTGlzdEVsZW1lbnRzKHRvZG9MaXN0LCB0b2Rvcyk7XG4gICAgfVxuICAgIHJldHVybiB0b2RvTGlzdDtcbiAgfVxuXG4gIGNyZWF0ZVRvZG9zKHRvZG9zKSB7XG4gICAgbGV0IGxpVG9kb3MgPSBbXTtcbiAgICBmb3IgKGxldCB0b2RvIG9mIHRvZG9zKVxuICAgICAgbGlUb2Rvcy5wdXNoKHRoaXMuY3JlYXRlVG9kbyh0b2RvLnRpdGxlLCB0b2RvLmRlc2NyaXB0aW9uKSk7XG4gICAgcmV0dXJuIGxpVG9kb3M7XG4gIH1cblxuICBjcmVhdGVGb290ZXIoKSB7XG4gICAgY29uc3QgZm9vdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9vdGVyJyk7XG4gICAgdGhpcy5zY3JpcHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZm9vdGVyLCB0aGlzLnNjcmlwdCk7XG4gIH1cblxuICBsb2FkUHJvamVjdChmb3JtRGF0YSkge1xuICAgIHRoaXMucmVwbGFjZVByb2plY3RDb250YWluZXIoYCR7Zm9ybURhdGF9LWNvbnRhaW5lcmApO1xuICAgIHRoaXMuYWRkUHJvamVjdFRvU2lkZWJhcihmb3JtRGF0YSk7XG4gICAgdGhpcy5yZW1vdmVGb3JtKCk7XG4gIH1cblxuICByZW1vdmVQcm9qZWN0Q29udGFpbmVyKCkge1xuICAgIGNvbnN0IHByb2plY3RDb250YWluZXIgPSB0aGlzLmdldEN1cnJlbnRQcm9qZWN0Q29udGFpbmVyKCk7XG4gICAgdGhpcy5yZW1vdmVFbGVtZW50KHByb2plY3RDb250YWluZXIpO1xuICB9XG5cbiAgZ2V0Q3VycmVudFByb2plY3RDb250YWluZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudCgnLmNvbnRlbnQgPiBkaXYnKTtcbiAgfVxuXG4gIHJlcGxhY2VQcm9qZWN0Q29udGFpbmVyKHByb2plY3RDbGFzc05hbWUsIGFyZ3M9e30pIHtcbiAgICBsZXQgY29udGVudCA9IHRoaXMuZ2V0RWxlbWVudCgnLmNvbnRlbnQnKTtcbiAgICBsZXQgbmV3UHJvamVjdENvbnRhaW5lciA9IHRoaXMuY3JlYXRlUHJvamVjdENvbnRhaW5lcihcbiAgICAgIHByb2plY3RDbGFzc05hbWUsIGFyZ3MpO1xuICAgIHRoaXMucmVtb3ZlUHJvamVjdENvbnRhaW5lcigpO1xuICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQobmV3UHJvamVjdENvbnRhaW5lcik7XG4gIH1cblxuICBnZXRDdXJyZW50UHJvamVjdE5hbWUoKSB7XG4gICAgY29uc3QgcHJvamVjdENvbnRhaW5lciA9IHRoaXMuZ2V0Q3VycmVudFByb2plY3RDb250YWluZXIoKTtcbiAgICBsZXQgcHJvamVjdENsYXNzTmFtZSA9IHByb2plY3RDb250YWluZXIuY2xhc3NOYW1lO1xuICAgIHJldHVybiBwcm9qZWN0Q2xhc3NOYW1lLnNwbGl0KCctJylbMF07XG4gIH1cblxuICBjcmVhdGVUb2RvKHRpdGxlLCBkZXNjcmlwdGlvbikge1xuICAgIGxldCBidXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbignJyk7XG4gICAgbGV0IHRvZG9JbmZvID0gdGhpcy5jcmVhdGVQYXJhZ3JhcGgoXG4gICAgICBgVGl0bGU6ICR7dGl0bGV9LCBEZXNjcmlwdGlvbjogJHtkZXNjcmlwdGlvbn1gKTtcbiAgICAvLyBNYXliZSBjaGFuZ2UgdGhlIGNyZWF0ZSBsaSB0byBhY2NlcHQgdHdvIG9yIG1vcmUgZWxlbWVudHNcbiAgICBsZXQgbGkgPSB0aGlzLmNyZWF0ZUxpKGJ1dHRvbik7XG4gICAgbGkuYXBwZW5kQ2hpbGQodG9kb0luZm8pO1xuICAgIHJldHVybiBsaTtcbiAgfVxuXG4gIGNyZWF0ZVBhcmFncmFwaChjb250ZW50KSB7XG4gICAgbGV0IHBhcmFncmFwaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBwYXJhZ3JhcGgudGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgIHJldHVybiBwYXJhZ3JhcGg7XG4gIH1cblxuICBsb2FkVG9kbyh0b2RvKSB7XG4gICAgbGV0IHRvZG9MaXN0ID0gdGhpcy5nZXRFbGVtZW50KCcudG9kby1saXN0Jyk7XG4gICAgdG9kb0xpc3QuYXBwZW5kQ2hpbGQodG9kbyk7XG4gIH1cblxuICBvYnRhaW5Ub2RvVGl0bGUobGlFbGVtZW50KSB7XG4gICAgbGV0IHRvZG9JbmZvID0gbGlFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKTtcbiAgICBsZXQgdG9kb1RpdGxlID0gdG9kb0luZm8udGV4dENvbnRlbnQuc3BsaXQoJywnKTtcbiAgICB0b2RvVGl0bGUgPSB0b2RvVGl0bGVbMF0uc3BsaXQoJzogJyk7XG4gICAgcmV0dXJuIHRvZG9UaXRsZVsxXTtcbiAgfVxuXG4gIHVwZGF0ZVRvZG8odG9kb0VsZW1lbnQsIHRvZG9EYXRhKSB7XG4gICAgbGV0IHAgPSB0aGlzLmNyZWF0ZVBhcmFncmFwaChcbiAgICAgIGBEdWUgZGF0ZTogJHt0b2RvRGF0YVsnZHVlRGF0ZSddfSwgcHJpb3JpdHk6ICR7dG9kb0RhdGFbJ3ByaW9yaXR5J119YCk7XG4gICAgdG9kb0VsZW1lbnQuYXBwZW5kQ2hpbGQocCk7XG4gIH1cblxuICBnZXRBdHRyaWJ1dGVGcm9tKGVsZW1lbnQsIGF0dHJpYnV0ZSkge1xuICAgIHJldHVybiBlbGVtZW50W2F0dHJpYnV0ZV07XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEV2ZW50TGlzdGVuZXJBZ3JlZ2F0b3Ige1xuICBhZGROYXZiYXJMaXN0ZW5lcihoYW5kbGVGdW5jdGlvbiwgYXJncykge1xuICAgIGxldCBuYXZiYXIgPSBhcmdzWydkY28nXS5nZXRFbGVtZW50KCcubmF2YmFyJyk7XG4gICAgbmF2YmFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxcbiAgICAgIChldmVudCkgPT4gaGFuZGxlRnVuY3Rpb24oZXZlbnQsIGFyZ3MpKTtcbiAgfVxuXG4gIGFkZEZvcm1MaXN0ZW5lcih2YWxpZGF0ZUZ1bmN0aW9uLCBhcmdzKSB7XG4gICAgbGV0IGZvcm0gPSBhcmdzWydkY28nXS5nZXRFbGVtZW50KCdmb3JtJyk7XG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsXG4gICAgICAoZXZlbnQpID0+IGFyZ3NbJ2hhbmRsZUZ1bmN0aW9uJ10oZXZlbnQsIHZhbGlkYXRlRnVuY3Rpb24sIGFyZ3MpKTtcbiAgfVxuXG4gIGFkZEVsZW1lbnRMaXN0ZW5lcihlbGVtZW50LCBoYW5kbGVGdW5jdGlvbikge1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IGhhbmRsZUZ1bmN0aW9uKGV2ZW50KSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2plY3QgeyAgXG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMudG9kb3MgPSBbXTtcbiAgfVxuXG4gIGFkZFRvZG8odG9kbykge1xuICAgIHRoaXMudG9kb3MucHVzaCh0b2RvKTtcbiAgfVxuXG4gIGdldCBuYW1lKCkge1xuICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICB9XG5cbiAgc2V0IG5hbWUodmFsdWUpIHtcbiAgICB0aGlzLl9uYW1lID0gdmFsdWU7XG4gIH1cblxuICBnZXQgdG9kb3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RvZG9zO1xuICB9XG5cbiAgc2V0IHRvZG9zKHZhbHVlKSB7XG4gICAgdGhpcy5fdG9kb3MgPSB2YWx1ZTtcbiAgfVxuXG4gIHNlYXJjaFRvZG8odG9kb1RpdGxlKSB7XG4gICAgcmV0dXJuIHRoaXMudG9kb3MuZmluZCh0b2RvID0+IHRvZG8udGl0bGUgPT09IHRvZG9UaXRsZSk7XG4gIH1cblxuICByZW1vdmVUb2RvKCkge1xuICAgIC8vIGdldCB0aGUgaW5kZXggb2YgdGhlIGVsZW1lbnQgdG8gYmUgcmVtb3ZlZCAoY3JlYXRlIG90aGVyIGZ1bmN0aW9uIGZvciBpdClcbiAgICAvLyB1c2UgdGhlIG5leHQgbGluZVxuICAgIC8vIHRoaXMudG9kb3MgPSB0aGlzLnRvZG9zLnNsaWNlKDAsIG4pLmNvbmNhdCh0aGlzLnRvZG9zLnNsaWNlKG4gKyAxKSlcbiAgfVxufVxuIiwiaW1wb3J0IFByb2plY3QgZnJvbSAnLi9wcm9qZWN0LmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvamVjdE1hbmFnZXIge1xuICBjb25zdHJ1Y3Rvcihwcm9qZWN0T2JqZWN0PVByb2plY3QpIHtcbiAgICB0aGlzLnByb2plY3RMaXN0ID0gW107XG4gICAgdGhpcy5hZGRQcm9qZWN0KG5ldyBwcm9qZWN0T2JqZWN0KCdkZWZhdWx0JykpO1xuICB9XG5cbiAgYWRkUHJvamVjdChwcm9qZWN0KSB7XG4gICAgdGhpcy5wcm9qZWN0TGlzdC5wdXNoKHByb2plY3QpO1xuICB9XG5cbiAgdmFsaWRhdGVQcm9qZWN0Rm9ybSA9IChldmVudCwgYXJncywgcHJvamVjdE9iamVjdD1Qcm9qZWN0KSA9PiB7XG4gICAgbGV0IGRjbyA9IGFyZ3NbJ2RjbyddO1xuICAgIGNvbnN0IGZvcm1EYXRhID0gdGhpcy5nYXRoZXJQcm9qZWN0Rm9ybURhdGEoZXZlbnQsIGRjbyk7XG4gICAgaWYgKGZvcm1EYXRhID09PSAnJykge1xuICAgICAgLy8gQWRkIHNvbWV0aGluZyB0byBub3RpZnkgZXJyb3IgdG8gdXNlciAobWF5YmUgY3JlYXRlIGEgbW9kYWwpXG4gICAgICBjb25zb2xlLmxvZyhcIkNvdWxkbid0IGNyZWF0ZSBQcm9qZWN0XCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBmb3JtRGF0YUxvd2VyY2FzZSA9IGZvcm1EYXRhLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IG5ld1Byb2plY3QgPSBuZXcgcHJvamVjdE9iamVjdChmb3JtRGF0YUxvd2VyY2FzZSk7XG4gICAgdGhpcy5hZGRQcm9qZWN0KG5ld1Byb2plY3QpO1xuICAgIGRjby5sb2FkUHJvamVjdChmb3JtRGF0YUxvd2VyY2FzZSk7XG4gIH1cblxuICBnYXRoZXJQcm9qZWN0Rm9ybURhdGEoZXZlbnQsIGRjbykge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgcHJvamVjdE5hbWUgPSBkY28uZ2V0RWxlbWVudChcIltuYW1lPSdwcm9qZWN0LW5hbWUnXVwiKS52YWx1ZTtcbiAgICByZXR1cm4gcHJvamVjdE5hbWU7XG4gIH1cblxuICBwcm9qZWN0TmFtZUNvaW5jaWRlcyhwcm9qZWN0LCBwcm9qZWN0TmFtZSkge1xuICAgIHJldHVybiBwcm9qZWN0Lm5hbWUgPT09IHByb2plY3ROYW1lO1xuICB9XG5cbiAgc2VhcmNoUHJvamVjdChwcm9qZWN0TmFtZSkge1xuICAgIHJldHVybiB0aGlzLnByb2plY3RMaXN0LmZpbmQocHJvamVjdCA9PlxuICAgICAgdGhpcy5wcm9qZWN0TmFtZUNvaW5jaWRlcyhwcm9qZWN0LCBwcm9qZWN0TmFtZSkpO1xuICB9XG5cbiAgZ2V0IHByb2plY3RMaXN0KCkge1xuICAgIHJldHVybiB0aGlzLl9wcm9qZWN0TGlzdDtcbiAgfVxuXG4gIHNldCBwcm9qZWN0TGlzdCh2YWx1ZSkge1xuICAgIHRoaXMuX3Byb2plY3RMaXN0ID0gdmFsdWU7XG4gIH1cblxuICAvLyBGdW5jdGlvbiB0byByZW1vdmUgcHJvamVjdFxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG9kbyB7XG4gIGNvbnN0cnVjdG9yKGFyZ3MpIHtcbiAgICB0aGlzLnRpdGxlID0gYXJnc1sndGl0bGUnXTtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gYXJnc1snZGVzY3JpcHRpb24nXTtcbiAgICB0aGlzLmR1ZURhdGUgPSBhcmdzWydkdWVEYXRlJ107XG4gICAgdGhpcy5wcmlvcml0eSA9IGFyZ3NbJ3ByaW9yaXR5J107XG4gIH1cbn1cbiIsImltcG9ydCBUb2RvIGZyb20gJy4vdG9kby5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvZG9NYW5hZ2VyIHtcbiAgdmFsaWRhdGVUb2RvRm9ybSA9IChldmVudCwgYXJncykgPT4ge1xuICAgIGxldCBmb3JtRGF0YSA9IHRoaXMuZ2F0aGVyVG9kb0Zvcm1EYXRhKGV2ZW50LCBhcmdzWydkY28nXSk7XG4gICAgbGV0IHJlc3VsdCA9IHRoaXMudmFsaWRhdGVGb3JtRGF0YShmb3JtRGF0YSk7XG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgLy8gQWRkIHNvbWV0aGluZyB0byBub3RpZnkgZXJyb3IgdG8gdXNlciAobWF5YmUgdXNlIGEgbW9kYWwpXG4gICAgICBjb25zb2xlLmxvZyhcIkNvdWxkbid0IGNyZWF0ZSBUby1kb1wiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5hZGRUb2RvVG9Qcm9qZWN0KGZvcm1EYXRhLCBhcmdzKTtcbiAgfVxuXG4gIGdhdGhlclRvZG9Gb3JtRGF0YSA9IChldmVudCwgZGNvKSA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB0b2RvVGl0bGUgPSBkY28uZ2V0RWxlbWVudChcIltuYW1lPSd0b2RvLXRpdGxlJ11cIikudmFsdWU7XG4gICAgY29uc3QgdG9kb0Rlc2NyaXB0aW9uID0gZGNvLmdldEVsZW1lbnQoXCJbbmFtZT0ndG9kby1kZXNjcmlwdGlvbiddXCIpLnZhbHVlO1xuICAgIGNvbnN0IHRvZG9EdWVEYXRlID0gZGNvLmdldEVsZW1lbnQoXCJbbmFtZT0ndG9kby1kdWVEYXRlJ11cIikudmFsdWU7XG4gICAgY29uc3QgdG9kb1ByaW9yaXR5ID0gZGNvLmdldEVsZW1lbnQoXCJbbmFtZT0ndG9kby1wcmlvcml0eSddXCIpLnZhbHVlO1xuICAgIHJldHVybiB7IHRpdGxlOiB0b2RvVGl0bGUsIFxuICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0b2RvRGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgZHVlRGF0ZTogdG9kb0R1ZURhdGUsXG4gICAgICAgICAgICAgcHJpb3JpdHk6IHRvZG9Qcmlvcml0eSB9O1xuICB9XG5cbiAgdmFsaWRhdGVGb3JtRGF0YShmb3JtRGF0YSkge1xuICAgIGxldCB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKGZvcm1EYXRhKTtcbiAgICByZXR1cm4gdmFsdWVzLnNvbWUodmFsdWUgPT4gdmFsdWUgPT09ICcnKTtcbiAgfVxuXG4gIGNyZWF0ZVRvZG8oZm9ybURhdGEpIHtcbiAgICByZXR1cm4gbmV3IFRvZG8oeyB0aXRsZTogZm9ybURhdGFbJ3RpdGxlJ10sXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGZvcm1EYXRhWydkZXNjcmlwdGlvbiddLFxuICAgICAgICAgICAgICAgICAgICAgIGR1ZURhdGU6IGZvcm1EYXRhWydkdWVEYXRlJ10sXG4gICAgICAgICAgICAgICAgICAgICAgcHJpb3JpdHk6IGZvcm1EYXRhWydwcmlvcml0eSddIH0pO1xuICB9XG5cbiAgYWRkVG9kb1RvUHJvamVjdChmb3JtRGF0YSwgYXJncykge1xuICAgIGxldCBwbSA9IGFyZ3NbJ3BtJ107XG4gICAgbGV0IGRjbyA9IGFyZ3NbJ2RjbyddO1xuICAgIGxldCBuZXdUb2RvID0gdGhpcy5jcmVhdGVUb2RvKGZvcm1EYXRhKTtcbiAgICBsZXQgcHJvamVjdE5hbWUgPSBkY28uZ2V0Q3VycmVudFByb2plY3ROYW1lKCk7XG4gICAgbGV0IHByb2plY3RPYmplY3QgPSBwbS5zZWFyY2hQcm9qZWN0KHByb2plY3ROYW1lKTtcbiAgICBwcm9qZWN0T2JqZWN0LmFkZFRvZG8obmV3VG9kbyk7XG4gICAgZGNvLmxvYWRUb2RvKGRjby5jcmVhdGVUb2RvKG5ld1RvZG8udGl0bGUsIG5ld1RvZG8uZGVzY3JpcHRpb24pKTtcbiAgICBkY28ucmVtb3ZlRm9ybSgpO1xuICB9XG59XG4iLCJpbXBvcnQgUGFnZUNvbnRyb2xsZXIgZnJvbSBcIi4vcGFnZS1jb250cm9sbGVyLmpzXCI7XG5cbmNvbnN0IG15UGFnZUNvbnRyb2xsZXIgPSBuZXcgUGFnZUNvbnRyb2xsZXI7XG5teVBhZ2VDb250cm9sbGVyLmxvYWRQYWdlKCk7XG4iLCJpbXBvcnQgRE9NQ3JlYXRvciBmcm9tICcuL2RvbS1jcmVhdG9yLmpzJztcbmltcG9ydCBFdmVudExpc3RlbmVyQWdyZWdhdG9yIGZyb20gJy4vZXZlbnQtbGlzdGVuZXItYWdyZWdhdG9yLmpzJztcbmltcG9ydCBQcm9qZWN0TWFuYWdlciBmcm9tICcuL3Byb2plY3QtbWFuYWdlci5qcyc7XG5pbXBvcnQgVG9kb01hbmFnZXIgZnJvbSAnLi90b2RvLW1hbmFnZXIuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYWdlQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMubXlEQ08gPSBuZXcgRE9NQ3JlYXRvcigpO1xuICAgIHRoaXMubXlFTEEgPSBuZXcgRXZlbnRMaXN0ZW5lckFncmVnYXRvcigpO1xuICAgIHRoaXMubXlQTSA9IG5ldyBQcm9qZWN0TWFuYWdlcigpO1xuICAgIHRoaXMubXlUTSA9IG5ldyBUb2RvTWFuYWdlcigpO1xuICB9XG5cbiAgbG9hZFBhZ2UoKSB7XG4gICAgdGhpcy5jcmVhdGVGQygpO1xuICAgIHRoaXMubXlEQ08ubG9hZFBhZ2UoKTtcbiAgICB0aGlzLm15RUxBLmFkZE5hdmJhckxpc3RlbmVyKFxuICAgICAgdGhpcy5oYW5kbGVOYXZiYXJCdXR0b25zLCB0aGlzLmdldE5hdkJhckFyZ3VtZW50cygpKTtcbiAgICB0aGlzLm15RUxBLmFkZEVsZW1lbnRMaXN0ZW5lcihcbiAgICAgIHRoaXMubXlEQ08uZ2V0RWxlbWVudCgnLnByb2plY3RzLWxpc3QnKSwgdGhpcy5oYW5kbGVQcm9qZWN0QnV0dG9ucyk7XG4gICAgdGhpcy5teUVMQS5hZGRFbGVtZW50TGlzdGVuZXIodGhpcy5teURDTy5nZXRFbGVtZW50KCcudG9kby1saXN0JyksIHRoaXMuaGFuZGxlVG9kb3NMaSk7XG4gIH1cblxuICBnZXROYXZCYXJBcmd1bWVudHMoKSB7XG4gICAgcmV0dXJuIHsgZGNvOiB0aGlzLm15RENPLFxuICAgICAgICAgICAgIHBtOiB0aGlzLm15UE0sXG4gICAgICAgICAgICAgdmFsaWRhdGVGdW5jdGlvbnM6IHRoaXMuZ2V0VmFsaWRhdGVGdW5jdGlvbnMoKSxcbiAgICAgICAgICAgICBoYW5kbGVGdW5jdGlvbjogdGhpcy5oYW5kbGVGb3JtQnV0dG9ucyB9O1xuICB9XG5cbiAgZ2V0VmFsaWRhdGVGdW5jdGlvbnMoKSB7XG4gICAgbGV0IGZ1bmN0aW9ucyA9IFt0aGlzLm15VE0udmFsaWRhdGVUb2RvRm9ybSwgdGhpcy5teVBNLnZhbGlkYXRlUHJvamVjdEZvcm1dO1xuICAgIHJldHVybiBmdW5jdGlvbnM7XG4gIH1cblxuICBoYW5kbGVOYXZiYXJCdXR0b25zID0gKGV2ZW50LCBhcmdzKSA9PiB7XG4gICAgbGV0IGZvcm1OYW1lID0gdGhpcy5teURDTy5nZXRBdHRyaWJ1dGVGcm9tKFxuICAgICAgZXZlbnQudGFyZ2V0LCAnY2xhc3NOYW1lJyk7XG4gICAgbGV0IGZvcm1GdW5jdGlvbnMgPSB0aGlzLnNlbGVjdEZvcm1GdW5jdGlvbnMoXG4gICAgICBmb3JtTmFtZSwgYXJnc1sndmFsaWRhdGVGdW5jdGlvbnMnXSk7XG4gICAgdGhpcy5teURDTy5sb2FkRm9ybShmb3JtRnVuY3Rpb25zWydmb3JtRnVuY3Rpb24nXSk7XG4gICAgdGhpcy5teUVMQS5hZGRGb3JtTGlzdGVuZXIoZm9ybUZ1bmN0aW9uc1sndmFsaWRhdGVGdW5jdGlvbiddLCBhcmdzKTtcbiAgfVxuXG4gIGNyZWF0ZUZDKCkge1xuICAgIHRoaXMubXlGQyA9IHRoaXMubXlEQ08uZm9ybUNyZWF0b3I7XG4gIH1cblxuICBzZWxlY3RGb3JtRnVuY3Rpb25zKGZvcm1OYW1lLCBmdW5jdGlvbnMpIHtcbiAgICBzd2l0Y2goZm9ybU5hbWUpIHtcbiAgICAgIGNhc2UgJ25ldy10by1kbyc6XG4gICAgICAgIHJldHVybiB7IHZhbGlkYXRlRnVuY3Rpb246IGZ1bmN0aW9uc1swXSxcbiAgICAgICAgICAgICAgICAgZm9ybUZ1bmN0aW9uOiB0aGlzLm15RkMuY3JlYXRlVG9Eb0Zvcm0gfTtcbiAgICAgIGNhc2UgJ25ldy1wcm9qZWN0JzpcbiAgICAgICAgcmV0dXJuIHsgdmFsaWRhdGVGdW5jdGlvbjogZnVuY3Rpb25zWzFdLFxuICAgICAgICAgICAgICAgICBmb3JtRnVuY3Rpb246IHRoaXMubXlGQy5jcmVhdGVQcm9qZWN0Rm9ybSB9O1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUZvcm1CdXR0b25zID0gKGV2ZW50LCB2YWxpZGF0ZUZ1bmN0aW9uLCBhcmdzKSA9PiB7XG4gICAgbGV0IGJ1dHRvblR5cGUgPSB0aGlzLm15RENPLmdldEF0dHJpYnV0ZUZyb20oZXZlbnQudGFyZ2V0LCAndHlwZScpO1xuICAgIGlmIChidXR0b25UeXBlID09PSAnYnV0dG9uJylcbiAgICAgIHRoaXMubXlEQ08ucmVtb3ZlRm9ybSgpO1xuICAgIGlmIChidXR0b25UeXBlID09PSAnc3VibWl0JylcbiAgICAgIHZhbGlkYXRlRnVuY3Rpb24oZXZlbnQsIGFyZ3MpO1xuICB9XG5cbiAgaGFuZGxlUHJvamVjdEJ1dHRvbnMgPSAoZXZlbnQpID0+IHtcbiAgICBsZXQgY2xhc3NOYW1lID0gdGhpcy5teURDTy5nZXRBdHRyaWJ1dGVGcm9tKGV2ZW50LnRhcmdldCwgJ2NsYXNzTmFtZScpO1xuICAgIGlmIChjbGFzc05hbWUgPT09ICdwcm9qZWN0LWJ1dHRvbicpIHtcbiAgICAgIGxldCBwcm9qZWN0TmFtZSA9IHRoaXMubXlEQ08uZ2V0QXR0cmlidXRlRnJvbShldmVudC50YXJnZXQsICdpbm5lclRleHQnKTtcbiAgICAgIHRoaXMubXlEQ08ucmVwbGFjZVByb2plY3RDb250YWluZXIocHJvamVjdE5hbWUsIHsgcG06IHRoaXMubXlQTSB9KTtcbiAgICAgIHRoaXMubXlFTEEuYWRkRWxlbWVudExpc3RlbmVyKFxuICAgICAgICB0aGlzLm15RENPLmdldEVsZW1lbnQoJy50b2RvLWxpc3QnKSwgdGhpcy5oYW5kbGVUb2Rvc0xpKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVUb2Rvc0xpID0gKGV2ZW50KSA9PiB7XG4gICAgbGV0IG5vZGVOYW1lID0gdGhpcy5teURDTy5nZXRBdHRyaWJ1dGVGcm9tKGV2ZW50LnRhcmdldCwgJ25vZGVOYW1lJyk7XG4gICAgaWYgKG5vZGVOYW1lICE9PSAnQlVUVE9OJykge1xuICAgICAgbGV0IHRvZG9DaGlsZHJlbiA9IGV2ZW50LnRhcmdldC5jaGlsZHJlbi5sZW5ndGg7XG4gICAgICBpZiAodG9kb0NoaWxkcmVuID09IDIpXG4gICAgICAgIHRoaXMuZXhwYW5kVG9kbyhldmVudCk7XG4gICAgICBlbHNlIGlmICh0b2RvQ2hpbGRyZW4gPiAyKVxuICAgICAgICB0aGlzLmNvbGxhcHNlVG9kbyhldmVudC50YXJnZXQpO1xuICAgIH1cbiAgfVxuXG4gIGV4cGFuZFRvZG8oZXZlbnQpIHtcbiAgICBsZXQgcHJvamVjdE5hbWUgPSB0aGlzLm15RENPLmdldEN1cnJlbnRQcm9qZWN0TmFtZSgpO1xuICAgIGxldCBwcm9qZWN0T2JqZWN0ID0gdGhpcy5teVBNLnNlYXJjaFByb2plY3QocHJvamVjdE5hbWUpO1xuICAgIGxldCB0b2RvVGl0bGUgPSB0aGlzLm15RENPLm9idGFpblRvZG9UaXRsZShldmVudC50YXJnZXQpO1xuICAgIGxldCB0b2RvT2JqZWN0ID0gcHJvamVjdE9iamVjdC5zZWFyY2hUb2RvKHRvZG9UaXRsZSk7XG4gICAgbGV0IHRvZG9SZW1haW5pbmdEYXRhID0ge1xuICAgICAgZHVlRGF0ZTogdG9kb09iamVjdC5kdWVEYXRlLCBwcmlvcml0eTogdG9kb09iamVjdC5wcmlvcml0eX07XG4gICAgLy8gbWF5YmUgYWRkIGEgYnV0dG9uIHRoYXQgYWxsb3dzIHRvIGVkaXQgdGhlIHRvZG8uXG4gICAgdGhpcy5teURDTy51cGRhdGVUb2RvKGV2ZW50LnRhcmdldCwgdG9kb1JlbWFpbmluZ0RhdGEpO1xuICAgIC8vIGFkZCBzb21ldGhpbmcgbGF0ZXIgdG8gbWFyayB0aGUgdG9kbyBhcyBjb21wbGV0ZSAodGhpbmsgYWJvdXQgYWRkaW5nXG4gICAgLy8gICBhIG5ldyBjb21wbGV0ZWQgcHJvcGVydHkgaW4gdG9kbyBvYmplY3QpXG4gIH1cblxuICBjb2xsYXBzZVRvZG8oZWxlbWVudCkge1xuICAgIGxldCBsYXN0UGFyYWdyYXBoID0gZWxlbWVudC5sYXN0Q2hpbGQ7XG4gICAgdGhpcy5teURDTy5yZW1vdmVFbGVtZW50KGxhc3RQYXJhZ3JhcGgpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiRm9ybUNyZWF0b3IiLCJjcmVhdGVUb0RvRm9ybSIsImJ1dHRvbiIsImZvcm0iLCJ0aGlzIiwiY3JlYXRlRm9ybSIsImxhYmVscyIsImNyZWF0ZUxhYmVscyIsImlucHV0cyIsImNyZWF0ZVRvRG9JbnB1dHMiLCJlbGVtZW50cyIsImpvaW5MaXN0cyIsImFwcGVuZElucHV0c1RvTGFiZWxzIiwiYXBwZW5kQnV0dG9ucyIsImFwcGVuZEVsZW1lbnRzVG9Gb3JtIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiYXNzaWduQXR0cmlidXRlIiwiZWxlbWVudCIsImF0dHJpYnV0ZSIsInZhbHVlIiwic2V0QXR0cmlidXRlIiwibGFiZWxDb250ZW50cyIsImNvbnRlbnQiLCJwdXNoIiwiY3JlYXRlTGFiZWwiLCJsYWJlbCIsInRleHRDb250ZW50IiwidGV4dElucHV0TmFtZXMiLCJ0ZXh0SW5wdXRzIiwiY3JlYXRlVGV4dElucHV0cyIsImRpc3RpbmN0SW5wdXRzIiwiY3JlYXRlRGlzdGluY3RJbnB1dHMiLCJpbnB1dE5hbWVzIiwibmFtZSIsImNyZWF0ZUlucHV0IiwidHlwZSIsImlucHV0IiwiYXR0cmlidXRlcyIsInZhbHVlcyIsImFzc2lnbkF0dHJpYnV0ZXMiLCJpIiwibGVuZ3RoIiwiY3JlYXRlRGF0ZXRpbWVMb2NhbElucHV0IiwiY3JlYXRlTnVtYmVySW5wdXQiLCJnZXRDdXJyZW50RGF0ZSIsIkRhdGUiLCJ0b0pTT04iLCJzbGljZSIsImxhYmVsc0RlZXBDb3B5IiwiZGVlcENsb25lTm9kZXMiLCJpbnB1dHNEZWVwQ29weSIsImFwcGVuZENoaWxkIiwiZmlyc3RMaXN0Iiwic2Vjb25kTGlzdCIsImNvbmNhdCIsIm5vZGVzIiwiZGVlcENsb25lZE5vZGVzIiwibm9kZSIsImNsb25lTm9kZSIsImNyZWF0ZVN1Ym1pdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvbiIsImVsZW1lbnRzRGVlcENvcHkiLCJjcmVhdGVQcm9qZWN0Rm9ybSIsIkRPTUNyZWF0b3IiLCJjb25zdHJ1Y3RvciIsImZvcm1DcmVhdG9yT2JqZWN0Iiwic2NyaXB0IiwicXVlcnlTZWxlY3RvciIsImZvcm1DcmVhdG9yIiwiX3NjcmlwdCIsIl9mb3JtQ3JlYXRvciIsImxvYWRQYWdlIiwiY3JlYXRlSGVhZGVyIiwiY3JlYXRlU2lkZWJhciIsImNyZWF0ZU1haW4iLCJjcmVhdGVGb290ZXIiLCJoZWFkZXIiLCJuYXYiLCJuYXZiYXIiLCJjcmVhdGVOYXZiYXIiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIiwidWwiLCJjcmVhdGVVbCIsImxpc3RFbGVtZW50cyIsImNyZWF0ZUJ1dHRvbiIsImNsYXNzTmFtZSIsImFwcGVuZExpc3RFbGVtZW50cyIsImNsYXNzTGlzdCIsImFkZCIsImxpc3QiLCJsb2FkRm9ybSIsImNyZWF0ZUZvcm1GdW5jdGlvbiIsImdldEVsZW1lbnQiLCJtYWluIiwicXVlcnkiLCJhcmdzIiwibmV3QnV0dG9uIiwicmVtb3ZlRm9ybSIsInJlbW92ZUVsZW1lbnQiLCJyZW1vdmUiLCJhZGRQcm9qZWN0VG9TaWRlYmFyIiwicHJvamVjdE5hbWUiLCJwcm9qZWN0c0xpc3QiLCJuZXdQcm9qZWN0IiwiY3JlYXRlTGkiLCJjcmVhdGVIZWFkaW5nIiwiaGVhZGluZyIsImhlYWRpbmdFbGVtZW50IiwibGkiLCJjcmVhdGVQcm9qZWN0c0xpc3QiLCJkZWZhdWx0QnV0dG9uIiwiY3JlYXRlRGl2IiwiZGVmYXVsdENvbnRhaW5lciIsImNyZWF0ZVByb2plY3RDb250YWluZXIiLCJwcm9qZWN0Q2xhc3NOYW1lIiwicmVwbGFjZSIsInByb2plY3RDb250YWluZXIiLCJwcm9qZWN0SGVhZGluZyIsInRvZG9MaXN0IiwibG9hZFRvZG9zIiwiZGl2IiwicHJvamVjdE9iamVjdCIsInNlYXJjaFByb2plY3QiLCJ0b2RvcyIsImNyZWF0ZVRvZG9zIiwibGlUb2RvcyIsInRvZG8iLCJjcmVhdGVUb2RvIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImZvb3RlciIsImxvYWRQcm9qZWN0IiwiZm9ybURhdGEiLCJyZXBsYWNlUHJvamVjdENvbnRhaW5lciIsInJlbW92ZVByb2plY3RDb250YWluZXIiLCJnZXRDdXJyZW50UHJvamVjdENvbnRhaW5lciIsIm5ld1Byb2plY3RDb250YWluZXIiLCJnZXRDdXJyZW50UHJvamVjdE5hbWUiLCJzcGxpdCIsInRvZG9JbmZvIiwiY3JlYXRlUGFyYWdyYXBoIiwicGFyYWdyYXBoIiwibG9hZFRvZG8iLCJvYnRhaW5Ub2RvVGl0bGUiLCJsaUVsZW1lbnQiLCJ0b2RvVGl0bGUiLCJ1cGRhdGVUb2RvIiwidG9kb0VsZW1lbnQiLCJ0b2RvRGF0YSIsInAiLCJnZXRBdHRyaWJ1dGVGcm9tIiwiRXZlbnRMaXN0ZW5lckFncmVnYXRvciIsImFkZE5hdmJhckxpc3RlbmVyIiwiaGFuZGxlRnVuY3Rpb24iLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJhZGRGb3JtTGlzdGVuZXIiLCJ2YWxpZGF0ZUZ1bmN0aW9uIiwiYWRkRWxlbWVudExpc3RlbmVyIiwiUHJvamVjdCIsImFkZFRvZG8iLCJfbmFtZSIsIl90b2RvcyIsInNlYXJjaFRvZG8iLCJmaW5kIiwicmVtb3ZlVG9kbyIsIlByb2plY3RNYW5hZ2VyIiwicHJvamVjdExpc3QiLCJhZGRQcm9qZWN0IiwicHJvamVjdCIsInZhbGlkYXRlUHJvamVjdEZvcm0iLCJkY28iLCJnYXRoZXJQcm9qZWN0Rm9ybURhdGEiLCJjb25zb2xlIiwibG9nIiwiZm9ybURhdGFMb3dlcmNhc2UiLCJ0b0xvd2VyQ2FzZSIsInByZXZlbnREZWZhdWx0IiwicHJvamVjdE5hbWVDb2luY2lkZXMiLCJfcHJvamVjdExpc3QiLCJUb2RvIiwiZHVlRGF0ZSIsInByaW9yaXR5IiwiVG9kb01hbmFnZXIiLCJ2YWxpZGF0ZVRvZG9Gb3JtIiwiZ2F0aGVyVG9kb0Zvcm1EYXRhIiwidmFsaWRhdGVGb3JtRGF0YSIsImFkZFRvZG9Ub1Byb2plY3QiLCJPYmplY3QiLCJzb21lIiwicG0iLCJuZXdUb2RvIiwibXlEQ08iLCJteUVMQSIsIm15UE0iLCJteVRNIiwiY3JlYXRlRkMiLCJoYW5kbGVOYXZiYXJCdXR0b25zIiwiZ2V0TmF2QmFyQXJndW1lbnRzIiwiaGFuZGxlUHJvamVjdEJ1dHRvbnMiLCJoYW5kbGVUb2Rvc0xpIiwidmFsaWRhdGVGdW5jdGlvbnMiLCJnZXRWYWxpZGF0ZUZ1bmN0aW9ucyIsImhhbmRsZUZvcm1CdXR0b25zIiwiZm9ybU5hbWUiLCJ0YXJnZXQiLCJmb3JtRnVuY3Rpb25zIiwic2VsZWN0Rm9ybUZ1bmN0aW9ucyIsIm15RkMiLCJmdW5jdGlvbnMiLCJmb3JtRnVuY3Rpb24iLCJidXR0b25UeXBlIiwidG9kb0NoaWxkcmVuIiwiY2hpbGRyZW4iLCJleHBhbmRUb2RvIiwiY29sbGFwc2VUb2RvIiwidG9kb09iamVjdCIsInRvZG9SZW1haW5pbmdEYXRhIiwibGFzdFBhcmFncmFwaCIsImxhc3RDaGlsZCJdLCJzb3VyY2VSb290IjoiIn0=